{"version":3,"file":"_internal-FJxr3Ezw.js","sources":["../../src/_internal/cli/commands/backup/backupGroup.ts","../../src/_internal/cli/debug.ts","../../src/_internal/cli/actions/dataset/validateDatasetName.ts","../../src/_internal/cli/actions/dataset/datasetNamePrompt.ts","../../src/_internal/cli/actions/dataset/chooseDatasetPrompt.ts","../../src/_internal/cli/actions/backup/resolveApiClient.ts","../../src/_internal/cli/commands/backup/disableBackupCommand.ts","../../src/_internal/cli/actions/backup/debug.ts","../../src/_internal/cli/actions/backup/archiveDir.ts","../../src/_internal/cli/actions/backup/chooseBackupIdPrompt.ts","../../src/_internal/cli/actions/backup/cleanupTmpDir.ts","../../src/_internal/cli/actions/backup/withRetry.ts","../../src/_internal/cli/actions/backup/downloadAsset.ts","../../src/_internal/cli/actions/backup/downloadDocument.ts","../../src/_internal/cli/actions/backup/fetchNextBackupPage.ts","../../src/_internal/cli/actions/backup/parseApiErr.ts","../../src/_internal/cli/actions/backup/progressSpinner.ts","../../src/_internal/cli/util/humanFileSize.ts","../../src/_internal/cli/util/isPathDirName.ts","../../src/_internal/cli/commands/backup/downloadBackupCommand.ts","../../src/_internal/cli/commands/backup/enableBackupCommand.ts","../../src/_internal/cli/commands/backup/listBackupCommand.ts","../../src/_internal/cli/commands/build/buildCommand.ts","../../src/_internal/cli/commands/check/checkCommand.ts","../../src/_internal/cli/commands/config/configCheckCommand.ts","../../src/_internal/cli/actions/cors/addCorsOrigin.ts","../../src/_internal/cli/commands/cors/addCorsOriginCommand.ts","../../src/_internal/cli/commands/cors/corsGroup.ts","../../src/_internal/cli/commands/cors/deleteCorsOriginCommand.ts","../../src/_internal/cli/commands/cors/listCorsOriginsCommand.ts","../../src/_internal/cli/actions/dataset/alias/validateDatasetAliasName.ts","../../src/_internal/cli/actions/dataset/alias/promptForDatasetAliasName.ts","../../src/_internal/cli/commands/dataset/alias/datasetAliasesClient.ts","../../src/_internal/cli/commands/dataset/alias/createAliasHandler.ts","../../src/_internal/cli/commands/dataset/alias/deleteAliasHandler.ts","../../src/_internal/cli/commands/dataset/alias/linkAliasHandler.ts","../../src/_internal/cli/commands/dataset/alias/unlinkAliasHandler.ts","../../src/_internal/cli/commands/dataset/alias/aliasCommands.ts","../../src/_internal/cli/actions/dataset/listDatasetCopyJobs.ts","../../src/_internal/cli/util/getClientUrl.ts","../../src/_internal/cli/commands/dataset/copyDatasetCommand.ts","../../src/_internal/cli/commands/dataset/createDatasetCommand.ts","../../src/_internal/cli/commands/dataset/datasetGroup.ts","../../src/_internal/cli/commands/dataset/datasetVisibilityCommand.ts","../../src/_internal/cli/commands/dataset/deleteDatasetCommand.ts","../../src/_internal/cli/commands/dataset/exportDatasetCommand.ts","../../src/_internal/cli/commands/dataset/importDatasetCommand.ts","../../src/_internal/cli/commands/dataset/alias/listAliasesHandler.ts","../../src/_internal/cli/commands/dataset/listDatasetsCommand.ts","../../src/_internal/cli/commands/deploy/deployCommand.ts","../../src/_internal/cli/commands/deploy/undeployCommand.ts","../../src/_internal/cli/commands/dev/devCommand.ts","../../src/_internal/cli/commands/documents/createDocumentsCommand.ts","../../src/_internal/cli/commands/documents/deleteDocumentsCommand.ts","../../src/_internal/cli/commands/documents/documentsGroup.ts","../../src/_internal/cli/util/colorizeJson.ts","../../src/_internal/cli/commands/documents/getDocumentsCommand.ts","../../src/_internal/cli/commands/documents/queryDocumentsCommand.ts","../../src/_internal/cli/commands/documents/validateDocumentsCommand.ts","../../src/_internal/cli/commands/exec/execCommand.ts","../../src/_internal/cli/commands/graphql/deleteGraphQLAPICommand.ts","../../src/_internal/cli/commands/graphql/deployGraphQLAPICommand.ts","../../src/_internal/cli/commands/graphql/graphqlGroup.ts","../../src/_internal/cli/commands/graphql/listGraphQLAPIsCommand.ts","../../src/_internal/cli/commands/hook/createHookCommand.ts","../../src/_internal/cli/commands/hook/deleteHookCommand.ts","../../src/_internal/cli/commands/hook/hookGroup.ts","../../src/_internal/cli/commands/hook/printHookAttemptCommand.ts","../../src/_internal/cli/commands/hook/listHookLogsCommand.ts","../../src/_internal/cli/commands/hook/listHooksCommand.ts","../../src/_internal/cli/commands/migration/constants.ts","../../src/_internal/cli/commands/migration/templates/minimalAdvanced.ts","../../src/_internal/cli/commands/migration/templates/minimalSimple.ts","../../src/_internal/cli/commands/migration/templates/renameField.ts","../../src/_internal/cli/commands/migration/templates/renameType.ts","../../src/_internal/cli/commands/migration/templates/stringToPTE.ts","../../src/_internal/cli/commands/migration/createMigrationCommand.ts","../../src/_internal/cli/commands/migration/utils/resolveMigrationScript.ts","../../src/_internal/cli/commands/migration/listMigrationsCommand.ts","../../src/_internal/cli/commands/migration/migrationGroup.ts","../../src/_internal/cli/util/tree.ts","../../src/_internal/cli/commands/migration/prettyMutationFormatter.ts","../../src/_internal/cli/commands/migration/runMigrationCommand.ts","../../src/_internal/cli/commands/preview/previewCommand.ts","../../src/_internal/cli/commands/schema/schemaGroup.ts","../../src/_internal/cli/commands/schema/validateSchemaCommand.ts","../../src/_internal/cli/util/isInteractive.ts","../../src/_internal/cli/commands/start/startCommand.ts","../../src/_internal/cli/commands/uninstall/uninstallCommand.ts","../../src/_internal/cli/util/prettifyQuotaError.ts","../../src/_internal/cli/commands/users/inviteUserCommand.ts","../../src/_internal/cli/commands/users/listUsersCommand.ts","../../src/_internal/cli/commands/users/usersGroup.ts","../../src/_internal/cli/commands/index.ts"],"sourcesContent":["import {type CliCommandGroupDefinition} from '@sanity/cli'\n\n// defaultApiVersion is the backend API version used for dataset backup.\n// First version of the backup API is vX since this feature is not yet released\n// and formal API documentation is pending.\nexport const defaultApiVersion = 'vX'\n\nconst datasetBackupGroup: CliCommandGroupDefinition = {\n  name: 'backup',\n  signature: '[COMMAND]',\n  description: 'Manage dataset backups.',\n  isGroupRoot: true,\n  hideFromHelp: true,\n}\n\nexport default datasetBackupGroup\n","import debugIt from 'debug'\n\nexport const debug = debugIt('sanity:core')\n","const MAX_DATASET_NAME_LENGTH = 64\n\nexport function validateDatasetName(datasetName: string): false | string {\n  if (!datasetName) {\n    return 'Dataset name is missing'\n  }\n\n  const name = `${datasetName}`\n\n  if (name.toLowerCase() !== name) {\n    return 'Dataset name must be all lowercase characters'\n  }\n\n  if (name.length < 2) {\n    return 'Dataset name must be at least two characters long'\n  }\n\n  if (name.length > MAX_DATASET_NAME_LENGTH) {\n    return `Dataset name must be at most ${MAX_DATASET_NAME_LENGTH} characters`\n  }\n\n  if (!/^[a-z0-9]/.test(name)) {\n    return 'Dataset name must start with a letter or a number'\n  }\n\n  if (!/^[a-z0-9][-_a-z0-9]+$/.test(name)) {\n    return 'Dataset name must only contain letters, numbers, dashes and underscores'\n  }\n\n  if (/[-_]$/.test(name)) {\n    return 'Dataset name must not end with a dash or an underscore'\n  }\n\n  return false\n}\n","import {type CliPrompter} from '@sanity/cli'\n\nimport {validateDatasetName} from './validateDatasetName'\n\nexport function promptForDatasetName(\n  prompt: CliPrompter,\n  options: {message?: string; default?: string} = {},\n): Promise<string> {\n  return prompt.single({\n    type: 'input',\n    message: 'Dataset name:',\n    validate: (name) => {\n      const err = validateDatasetName(name)\n      if (err) {\n        return err\n      }\n\n      return true\n    },\n    ...options,\n  })\n}\n","import {type CliCommandContext} from '@sanity/cli'\n\nimport {debug} from '../../debug'\nimport {promptForDatasetName} from './datasetNamePrompt'\n\nexport async function chooseDatasetPrompt(\n  context: CliCommandContext,\n  options: {message?: string; allowCreation?: boolean} = {},\n): Promise<string> {\n  const {apiClient, prompt} = context\n  const {message, allowCreation} = options\n  const client = apiClient()\n\n  const datasets = await client.datasets.list()\n  const hasProduction = datasets.find((dataset) => dataset.name === 'production')\n  const datasetChoices = datasets.map((dataset) => ({value: dataset.name}))\n  const selected = await prompt.single({\n    message: message || 'Select dataset to use',\n    type: 'list',\n    choices: allowCreation\n      ? [{value: 'new', name: 'Create new dataset'}, new prompt.Separator(), ...datasetChoices]\n      : datasetChoices,\n  })\n\n  if (selected === 'new') {\n    debug('User wants to create a new dataset, prompting for name')\n    const newDatasetName = await promptForDatasetName(prompt, {\n      message: 'Name your dataset:',\n      default: hasProduction ? undefined : 'production',\n    })\n    await client.datasets.create(newDatasetName)\n    return newDatasetName\n  }\n\n  return selected\n}\n","import {type CliCommandContext} from '@sanity/cli'\nimport {type SanityClient} from '@sanity/client'\n\nimport {chooseDatasetPrompt} from '../dataset/chooseDatasetPrompt'\n\ntype ResolvedApiClient = {\n  projectId: string\n  datasetName: string\n  token?: string\n  client: SanityClient\n}\n\nasync function resolveApiClient(\n  context: CliCommandContext,\n  datasetName: string,\n  apiVersion: string,\n): Promise<ResolvedApiClient> {\n  const {apiClient} = context\n\n  let client = apiClient()\n  const {projectId, token} = client.config()\n\n  if (!projectId) {\n    throw new Error('Project ID not defined')\n  }\n\n  // If no dataset provided, explicitly ask for dataset instead of using dataset\n  // configured in Sanity config. Aligns with `sanity dataset export` behavior.\n  let selectedDataset: string = datasetName\n  if (!selectedDataset) {\n    selectedDataset = await chooseDatasetPrompt(context, {\n      message: 'Select the dataset name:',\n    })\n  }\n\n  client = client.withConfig({dataset: datasetName, apiVersion})\n\n  return {\n    projectId,\n    datasetName: selectedDataset,\n    token,\n    client,\n  }\n}\n\nexport default resolveApiClient\n","import {type CliCommandDefinition} from '@sanity/cli'\n\nimport resolveApiClient from '../../actions/backup/resolveApiClient'\nimport {defaultApiVersion} from './backupGroup'\n\nconst helpText = `\nExamples\n  sanity backup disable DATASET_NAME\n`\n\nconst disableDatasetBackupCommand: CliCommandDefinition = {\n  name: 'disable',\n  group: 'backup',\n  signature: '[DATASET_NAME]',\n  description: 'Disable backup for a dataset.',\n  helpText,\n  action: async (args, context) => {\n    const {output, chalk} = context\n    const [dataset] = args.argsWithoutOptions\n    const {projectId, datasetName, token, client} = await resolveApiClient(\n      context,\n      dataset,\n      defaultApiVersion,\n    )\n\n    try {\n      await client.request({\n        method: 'PUT',\n        headers: {Authorization: `Bearer ${token}`},\n        uri: `/projects/${projectId}/datasets/${datasetName}/settings/backups`,\n        body: {\n          enabled: false,\n        },\n      })\n      output.print(`${chalk.green(`Disabled daily backups for dataset ${datasetName}\\n`)}`)\n    } catch (error) {\n      const msg = error.statusCode\n        ? error.response.body.message\n        : error.message || error.statusMessage\n      output.print(`${chalk.red(`Disabling dataset backup failed: ${msg}`)}\\n`)\n    }\n  },\n}\n\nexport default disableDatasetBackupCommand\n","export default require('debug')('sanity:backup')\n","import {createWriteStream} from 'node:fs'\nimport zlib from 'node:zlib'\n\nimport {type ProgressData} from 'archiver'\n\nimport debug from './debug'\n\nconst archiver = require('archiver')\n\n// ProgressCb is a callback that is called with the number of bytes processed so far.\ntype ProgressCb = (processedBytes: number) => void\n\n// archiveDir creates a tarball of the given directory and writes it to the given file path.\nfunction archiveDir(tmpOutDir: string, outFilePath: string, progressCb: ProgressCb): Promise<void> {\n  return new Promise((resolve, reject) => {\n    const archiveDestination = createWriteStream(outFilePath)\n    archiveDestination.on('error', (err: Error) => {\n      reject(err)\n    })\n\n    archiveDestination.on('close', () => {\n      resolve()\n    })\n\n    const archive = archiver('tar', {\n      gzip: true,\n      gzipOptions: {level: zlib.constants.Z_DEFAULT_COMPRESSION},\n    })\n\n    archive.on('error', (err: Error) => {\n      debug('Archiving errored!\\n%s', err.stack)\n      reject(err)\n    })\n\n    // Catch warnings for non-blocking errors (stat failures and others)\n    archive.on('warning', (err: Error) => {\n      debug('Archive warning: %s', err.message)\n    })\n\n    archive.on('progress', (progress: ProgressData) => {\n      progressCb(progress.fs.processedBytes)\n    })\n\n    // Pipe archive data to the file\n    archive.pipe(archiveDestination)\n    archive.directory(tmpOutDir, false)\n    archive.finalize()\n  })\n}\n\nexport default archiveDir\n","import {type CliCommandContext} from '@sanity/cli'\n\nimport {defaultApiVersion} from '../../commands/backup/backupGroup'\nimport resolveApiClient from './resolveApiClient'\n\n// maxBackupIdsShown is the maximum number of backup IDs to show in the prompt.\n// Higher numbers will cause the prompt to be slow.\nconst maxBackupIdsShown = 100\n\nasync function chooseBackupIdPrompt(\n  context: CliCommandContext,\n  datasetName: string,\n): Promise<string> {\n  const {prompt} = context\n\n  const {projectId, token, client} = await resolveApiClient(context, datasetName, defaultApiVersion)\n\n  try {\n    // Fetch last $maxBackupIdsShown backups for this dataset.\n    // We expect here that API returns backups sorted by creation date in descending order.\n    const response = await client.request({\n      headers: {Authorization: `Bearer ${token}`},\n      uri: `/projects/${projectId}/datasets/${datasetName}/backups`,\n      query: {limit: maxBackupIdsShown.toString()},\n    })\n\n    if (response?.backups?.length > 0) {\n      const backupIdChoices = response.backups.map((backup: {id: string}) => ({\n        value: backup.id,\n      }))\n      const selected = await prompt.single({\n        message: `Select backup ID to use (only last ${maxBackupIdsShown} shown)`,\n        type: 'list',\n        choices: backupIdChoices,\n      })\n\n      return selected\n    }\n  } catch (err) {\n    throw new Error(`Failed to fetch backups for dataset ${datasetName}: ${err.message}`)\n  }\n\n  throw new Error('No backups found')\n}\n\nexport default chooseBackupIdPrompt\n","import rimraf from 'rimraf'\n\nimport debug from './debug'\n\nfunction cleanupTmpDir(tmpDir: string): void {\n  rimraf(tmpDir, (err) => {\n    if (err) {\n      debug(`Error cleaning up temporary files: ${err.message}`)\n    }\n  })\n}\n\nexport default cleanupTmpDir\n","import debug from './debug'\n\nconst MAX_RETRIES = 5\nconst BACKOFF_DELAY_BASE = 200\n\nconst exponentialBackoff = (retryCount: number) => Math.pow(2, retryCount) * BACKOFF_DELAY_BASE\n\nasync function withRetry<T>(\n  operation: () => Promise<T>,\n  maxRetries: number = MAX_RETRIES,\n): Promise<T> {\n  for (let retryCount = 0; retryCount < maxRetries; retryCount++) {\n    try {\n      return await operation()\n    } catch (err) {\n      // Immediately rethrow if the error is not server-related.\n      if (err.response && err.response.statusCode && err.response.statusCode < 500) {\n        throw err\n      }\n\n      const retryDelay = exponentialBackoff(retryCount)\n      debug(`Error encountered, retrying after ${retryDelay}ms: %s`, err.message)\n      await new Promise((resolve) => setTimeout(resolve, retryDelay))\n    }\n  }\n\n  throw new Error('Operation failed after all retries')\n}\n\nexport default withRetry\n","import {createWriteStream} from 'node:fs'\nimport path from 'node:path'\n\nimport {getIt} from 'get-it'\nimport {keepAlive, promise} from 'get-it/middleware'\n\nimport debug from './debug'\nimport withRetry from './withRetry'\n\nconst CONNECTION_TIMEOUT = 15 * 1000 // 15 seconds\nconst READ_TIMEOUT = 3 * 60 * 1000 // 3 minutes\n\nconst request = getIt([keepAlive(), promise()])\n\nasync function downloadAsset(\n  url: string,\n  fileName: string,\n  fileType: string,\n  outDir: string,\n): Promise<void> {\n  // File names that contain a path to file (e.g. sanity-storage/assets/file-name.tar.gz) fail when archive is\n  // created due to missing parent dir (e.g. sanity-storage/assets), so we want to handle them by taking\n  // the base name as file name.\n  const normalizedFileName = path.basename(fileName)\n\n  const assetFilePath = getAssetFilePath(normalizedFileName, fileType, outDir)\n  await withRetry(async () => {\n    const response = await request({\n      url: url,\n      maxRedirects: 5,\n      timeout: {connect: CONNECTION_TIMEOUT, socket: READ_TIMEOUT},\n      stream: true,\n    })\n\n    debug('Received asset %s with status code %d', normalizedFileName, response?.statusCode)\n\n    response.body.pipe(createWriteStream(assetFilePath))\n  })\n}\n\nfunction getAssetFilePath(fileName: string, fileType: string, outDir: string): string {\n  // Set assetFilePath if we are downloading an asset file.\n  // If it's a JSON document, assetFilePath will be an empty string.\n  let assetFilePath = ''\n  if (fileType === 'image') {\n    assetFilePath = path.join(outDir, 'images', fileName)\n  } else if (fileType === 'file') {\n    assetFilePath = path.join(outDir, 'files', fileName)\n  }\n\n  return assetFilePath\n}\n\nexport default downloadAsset\n","import {getIt, type MiddlewareResponse} from 'get-it'\nimport {keepAlive, promise} from 'get-it/middleware'\n\nimport debug from './debug'\nimport withRetry from './withRetry'\n\nconst CONNECTION_TIMEOUT = 15 * 1000 // 15 seconds\nconst READ_TIMEOUT = 3 * 60 * 1000 // 3 minutes\n\nconst request = getIt([keepAlive(), promise()])\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nasync function downloadDocument(url: string): Promise<any> {\n  const response = await withRetry<MiddlewareResponse>(() =>\n    request({\n      url,\n      maxRedirects: 5,\n      timeout: {connect: CONNECTION_TIMEOUT, socket: READ_TIMEOUT},\n    }),\n  )\n\n  debug('Received document from %s with status code %d', url, response?.statusCode)\n\n  return response.body\n}\n\nexport default downloadDocument\n","import {Readable} from 'node:stream'\n\nimport {type QueryParams, type SanityClient} from '@sanity/client'\n\ntype File = {\n  name: string\n  url: string\n  type: string\n}\n\ntype GetBackupResponse = {\n  createdAt: string\n  totalFiles: number\n  files: File[]\n  nextCursor?: string\n}\n\nclass PaginatedGetBackupStream extends Readable {\n  private cursor = ''\n  private readonly client: SanityClient\n  private readonly projectId: string\n  private readonly datasetName: string\n  private readonly backupId: string\n  private readonly token: string\n  public totalFiles = 0\n\n  constructor(\n    client: SanityClient,\n    projectId: string,\n    datasetName: string,\n    backupId: string,\n    token: string,\n  ) {\n    super({objectMode: true})\n    this.client = client\n    this.projectId = projectId\n    this.datasetName = datasetName\n    this.backupId = backupId\n    this.token = token\n  }\n\n  async _read(): Promise<void> {\n    try {\n      const data = await this.fetchNextBackupPage()\n\n      // Set totalFiles when it's fetched for the first time\n      if (this.totalFiles === 0) {\n        this.totalFiles = data.totalFiles\n      }\n\n      data.files.forEach((file: File) => this.push(file))\n\n      if (typeof data.nextCursor === 'string' && data.nextCursor !== '') {\n        this.cursor = data.nextCursor\n      } else {\n        // No more pages left to fetch.\n        this.push(null)\n      }\n    } catch (err) {\n      this.destroy(err as Error)\n    }\n  }\n\n  // fetchNextBackupPage fetches the next page of backed up files from the backup API.\n  async fetchNextBackupPage(): Promise<GetBackupResponse> {\n    const query: QueryParams = this.cursor === '' ? {} : {nextCursor: this.cursor}\n\n    try {\n      return await this.client.request({\n        headers: {Authorization: `Bearer ${this.token}`},\n        uri: `/projects/${this.projectId}/datasets/${this.datasetName}/backups/${this.backupId}`,\n        query,\n      })\n    } catch (error) {\n      // It can be clearer to pull this logic out in a  common error handling function for re-usability.\n      let msg = error.statusCode ? error.response.body.message : error.message\n\n      // If no message can be extracted, print the whole error.\n      if (msg === undefined) {\n        msg = String(error)\n      }\n      throw new Error(`Downloading dataset backup failed: ${msg}`)\n    }\n  }\n}\n\nexport {PaginatedGetBackupStream}\nexport type {File, GetBackupResponse}\n","// apiErr is a type that represents an error returned by the API\ninterface ApiErr {\n  statusCode: number\n  message: string\n}\n\n// parseApiErr is a function that attempts with the best effort to parse\n// an error returned by the API since different API endpoint may end up\n// returning different error structures.\n// eslint-disable-next-line @typescript-eslint/no-explicit-any,@typescript-eslint/explicit-module-boundary-types\nfunction parseApiErr(err: any): ApiErr {\n  const apiErr = {} as ApiErr\n  if (err.code) {\n    apiErr.statusCode = err.code\n  } else if (err.statusCode) {\n    apiErr.statusCode = err.statusCode\n  }\n\n  if (err.message) {\n    apiErr.message = err.message\n  } else if (err.statusMessage) {\n    apiErr.message = err.statusMessage\n  } else if (err?.response?.body?.message) {\n    apiErr.message = err.response.body.message\n  } else if (err?.response?.data?.message) {\n    apiErr.message = err.response.data.message\n  } else {\n    // If no message can be extracted, print the whole error.\n    apiErr.message = JSON.stringify(err)\n  }\n\n  return apiErr\n}\n\nexport default parseApiErr\n","import {type CliOutputter} from '@sanity/cli'\nimport prettyMs from 'pretty-ms'\n\ntype ProgressEvent = {\n  step: string\n  update?: boolean\n  current?: number\n  total?: number\n}\n\ninterface ProgressSpinner {\n  set: (progress: ProgressEvent) => void\n  update: (progress: ProgressEvent) => void\n  succeed: () => void\n  fail: () => void\n}\n\nconst newProgress = (output: CliOutputter, startStep: string): ProgressSpinner => {\n  let spinner = output.spinner(startStep).start()\n  let lastProgress: ProgressEvent = {step: startStep}\n  let start = Date.now()\n\n  const print = (progress: ProgressEvent) => {\n    const elapsed = prettyMs(Date.now() - start)\n    if (progress.current && progress.current > 0 && progress.total && progress.total > 0) {\n      spinner.text = `${progress.step} (${progress.current}/${progress.total}) [${elapsed}]`\n    } else {\n      spinner.text = `${progress.step} [${elapsed}]`\n    }\n  }\n\n  return {\n    set: (progress: ProgressEvent) => {\n      if (progress.step !== lastProgress.step) {\n        print(lastProgress) // Print the last progress before moving on\n        spinner.succeed()\n        spinner = output.spinner(progress.step).start()\n        start = Date.now()\n      } else if (progress.step === lastProgress.step && progress.update) {\n        print(progress)\n      }\n      lastProgress = progress\n    },\n    update: (progress: ProgressEvent) => {\n      print(progress)\n      lastProgress = progress\n    },\n    succeed: () => {\n      spinner.succeed()\n      start = Date.now()\n    },\n    fail: () => {\n      spinner.fail()\n      start = Date.now()\n    },\n  }\n}\n\nexport default newProgress\n","function humanFileSize(size: number): string {\n  const i = size == 0 ? 0 : Math.floor(Math.log(size) / Math.log(1024))\n  return `${(size / Math.pow(1024, i)).toFixed(2)} ${['B', 'kB', 'MB', 'GB', 'TB'][i]}`\n}\n\nexport default humanFileSize\n","function isPathDirName(filepath: string): boolean {\n  // Check if the path has an extension, commonly indicating a file\n  return !/\\.\\w+$/.test(filepath)\n}\n\nexport default isPathDirName\n","import {createWriteStream, existsSync, mkdirSync} from 'node:fs'\nimport {mkdtemp} from 'node:fs/promises'\nimport {tmpdir} from 'node:os'\nimport path from 'node:path'\n\nimport {\n  type CliCommandArguments,\n  type CliCommandContext,\n  type CliCommandDefinition,\n  type SanityClient,\n} from '@sanity/cli'\nimport {absolutify} from '@sanity/util/fs'\nimport {Mutex} from 'async-mutex'\nimport createDebug from 'debug'\nimport {isString} from 'lodash'\nimport prettyMs from 'pretty-ms'\nimport {hideBin} from 'yargs/helpers'\nimport yargs from 'yargs/yargs'\n\nimport archiveDir from '../../actions/backup/archiveDir'\nimport chooseBackupIdPrompt from '../../actions/backup/chooseBackupIdPrompt'\nimport cleanupTmpDir from '../../actions/backup/cleanupTmpDir'\nimport downloadAsset from '../../actions/backup/downloadAsset'\nimport downloadDocument from '../../actions/backup/downloadDocument'\nimport {type File, PaginatedGetBackupStream} from '../../actions/backup/fetchNextBackupPage'\nimport parseApiErr from '../../actions/backup/parseApiErr'\nimport newProgress from '../../actions/backup/progressSpinner'\nimport resolveApiClient from '../../actions/backup/resolveApiClient'\nimport humanFileSize from '../../util/humanFileSize'\nimport isPathDirName from '../../util/isPathDirName'\nimport {defaultApiVersion} from './backupGroup'\n\nconst debug = createDebug('sanity:backup')\n\nconst DEFAULT_DOWNLOAD_CONCURRENCY = 10\nconst MAX_DOWNLOAD_CONCURRENCY = 24\n\ninterface DownloadBackupOptions {\n  projectId: string\n  datasetName: string\n  token: string\n  backupId: string\n  outDir: string\n  outFileName: string\n  overwrite: boolean\n  concurrency: number\n}\n\nconst helpText = `\nOptions\n  --backup-id <string> The backup ID to download. (required)\n  --out <string>       The file or directory path the backup should download to.\n  --overwrite          Allows overwriting of existing backup file.\n  --concurrency <num>  Concurrent number of backup item downloads. (max: 24)\n\nExamples\n  sanity backup download DATASET_NAME --backup-id 2024-01-01-backup-1\n  sanity backup download DATASET_NAME --backup-id 2024-01-01-backup-2 --out /path/to/file\n  sanity backup download DATASET_NAME --backup-id 2024-01-01-backup-3 --out /path/to/file --overwrite\n`\n\nfunction parseCliFlags(args: {argv?: string[]}) {\n  return yargs(hideBin(args.argv || process.argv).slice(2))\n    .options('backup-id', {type: 'string'})\n    .options('out', {type: 'string'})\n    .options('concurrency', {type: 'number', default: DEFAULT_DOWNLOAD_CONCURRENCY})\n    .options('overwrite', {type: 'boolean', default: false}).argv\n}\n\nconst downloadBackupCommand: CliCommandDefinition = {\n  name: 'download',\n  group: 'backup',\n  signature: '[DATASET_NAME]',\n  description: 'Download a dataset backup to a local file.',\n  helpText,\n  // eslint-disable-next-line max-statements\n  action: async (args, context) => {\n    const {output, chalk} = context\n    const [client, opts] = await prepareBackupOptions(context, args)\n    const {projectId, datasetName, backupId, outDir, outFileName} = opts\n\n    // If any of the output path or file name is empty, cancel the operation.\n    if (outDir === '' || outFileName === '') {\n      output.print('Operation cancelled.')\n      return\n    }\n    const outFilePath = path.join(outDir, outFileName)\n\n    output.print('╭───────────────────────────────────────────────────────────╮')\n    output.print('│                                                           │')\n    output.print('│ Downloading backup for:                                   │')\n    output.print(`│ ${chalk.bold('projectId')}: ${chalk.cyan(projectId).padEnd(56)} │`)\n    output.print(`│ ${chalk.bold('dataset')}: ${chalk.cyan(datasetName).padEnd(58)} │`)\n    output.print(`│ ${chalk.bold('backupId')}: ${chalk.cyan(backupId).padEnd(56)} │`)\n    output.print('│                                                           │')\n    output.print('╰───────────────────────────────────────────────────────────╯')\n    output.print('')\n    output.print(`Downloading backup to \"${chalk.cyan(outFilePath)}\"`)\n\n    const start = Date.now()\n    const progressSpinner = newProgress(output, 'Setting up backup environment...')\n\n    // Create a unique temporary directory to store files before bundling them into the archive at outputPath.\n    // Temporary directories are normally deleted at the end of backup process, any unexpected exit may leave them\n    // behind, hence it is important to create a unique directory for each attempt.\n    const tmpOutDir = await mkdtemp(path.join(tmpdir(), `sanity-backup-`))\n\n    // Create required directories if they don't exist.\n    for (const dir of [outDir, path.join(tmpOutDir, 'images'), path.join(tmpOutDir, 'files')]) {\n      mkdirSync(dir, {recursive: true})\n    }\n\n    debug('Writing to temporary directory %s', tmpOutDir)\n    const tmpOutDocumentsFile = path.join(tmpOutDir, 'data.ndjson')\n\n    // Handle concurrent writes to the same file using mutex.\n    const docOutStream = createWriteStream(tmpOutDocumentsFile)\n    const docWriteMutex = new Mutex()\n\n    try {\n      const backupFileStream = new PaginatedGetBackupStream(\n        client,\n        opts.projectId,\n        opts.datasetName,\n        opts.backupId,\n        opts.token,\n      )\n\n      const files: File[] = []\n      let i = 0\n      for await (const file of backupFileStream) {\n        files.push(file)\n        i++\n        progressSpinner.set({\n          step: `Reading backup files...`,\n          update: true,\n          current: i,\n          total: backupFileStream.totalFiles,\n        })\n      }\n\n      let totalItemsDownloaded = 0\n      // This is dynamically imported because this module is ESM only and this file gets compiled to CJS at this time.\n      const {default: pMap} = await import('p-map')\n      await pMap(\n        files,\n        async (file: File) => {\n          if (file.type === 'file' || file.type === 'image') {\n            await downloadAsset(file.url, file.name, file.type, tmpOutDir)\n          } else {\n            const doc = await downloadDocument(file.url)\n            await docWriteMutex.runExclusive(() => {\n              docOutStream.write(`${doc}\\n`)\n            })\n          }\n\n          totalItemsDownloaded += 1\n          progressSpinner.set({\n            step: `Downloading documents and assets...`,\n            update: true,\n            current: totalItemsDownloaded,\n            total: backupFileStream.totalFiles,\n          })\n        },\n        {concurrency: opts.concurrency},\n      )\n    } catch (error) {\n      progressSpinner.fail()\n      const {message} = parseApiErr(error)\n      throw new Error(`Downloading dataset backup failed: ${message}`)\n    }\n\n    progressSpinner.set({step: `Archiving files into a tarball...`, update: true})\n    try {\n      await archiveDir(tmpOutDir, outFilePath, (processedBytes: number) => {\n        progressSpinner.update({\n          step: `Archiving files into a tarball, ${humanFileSize(processedBytes)} bytes written...`,\n        })\n      })\n    } catch (err) {\n      progressSpinner.fail()\n      throw new Error(`Archiving backup failed: ${err.message}`)\n    }\n\n    progressSpinner.set({\n      step: `Cleaning up temporary files at ${chalk.cyan(`${tmpOutDir}`)}`,\n    })\n    cleanupTmpDir(tmpOutDir)\n\n    progressSpinner.set({\n      step: `Backup download complete [${prettyMs(Date.now() - start)}]`,\n    })\n    progressSpinner.succeed()\n  },\n}\n\n// prepareBackupOptions validates backup options from CLI and prepares Client and DownloadBackupOptions.\nasync function prepareBackupOptions(\n  context: CliCommandContext,\n  args: CliCommandArguments,\n): Promise<[SanityClient, DownloadBackupOptions]> {\n  const flags = await parseCliFlags(args)\n  const [dataset] = args.argsWithoutOptions\n  const {prompt, workDir} = context\n  const {projectId, datasetName, client} = await resolveApiClient(\n    context,\n    dataset,\n    defaultApiVersion,\n  )\n\n  const {token} = client.config()\n  if (!isString(token) || token.length < 1) {\n    throw new Error(`token is missing`)\n  }\n\n  if (!isString(datasetName) || datasetName.length < 1) {\n    throw new Error(`dataset ${datasetName} must be a valid dataset name`)\n  }\n\n  const backupId = String(flags['backup-id'] || (await chooseBackupIdPrompt(context, datasetName)))\n  if (backupId.length < 1) {\n    throw new Error(`backup-id ${flags['backup-id']} should be a valid string`)\n  }\n\n  if ('concurrency' in flags) {\n    if (flags.concurrency < 1 || flags.concurrency > MAX_DOWNLOAD_CONCURRENCY) {\n      throw new Error(`concurrency should be in 1 to ${MAX_DOWNLOAD_CONCURRENCY} range`)\n    }\n  }\n\n  const defaultOutFileName = `${datasetName}-backup-${backupId}.tar.gz`\n  let out = await (async (): Promise<string> => {\n    if (flags.out !== undefined) {\n      // Rewrite the output path to an absolute path, if it is not already.\n      return absolutify(flags.out)\n    }\n\n    const input = await prompt.single({\n      type: 'input',\n      message: 'Output path:',\n      default: path.join(workDir, defaultOutFileName),\n      filter: absolutify,\n    })\n    return input\n  })()\n\n  // If path is a directory name, then add a default file name to the path.\n  if (isPathDirName(out)) {\n    out = path.join(out, defaultOutFileName)\n  }\n\n  // If the file already exists, ask for confirmation if it should be overwritten.\n  if (!flags.overwrite && existsSync(out)) {\n    const shouldOverwrite = await prompt.single({\n      type: 'confirm',\n      message: `File \"${out}\" already exists, would you like to overwrite it?`,\n      default: false,\n    })\n\n    // If the user does not want to overwrite the file, set the output path to an empty string.\n    // This should be handled by the caller of this function as cancel operation.\n    if (!shouldOverwrite) {\n      out = ''\n    }\n  }\n\n  return [\n    client,\n    {\n      projectId,\n      datasetName,\n      backupId,\n      token,\n      outDir: path.dirname(out),\n      outFileName: path.basename(out),\n      overwrite: flags.overwrite,\n      concurrency: flags.concurrency || DEFAULT_DOWNLOAD_CONCURRENCY,\n    },\n  ]\n}\n\nexport default downloadBackupCommand\n","import {type CliCommandDefinition} from '@sanity/cli'\n\nimport resolveApiClient from '../../actions/backup/resolveApiClient'\nimport {defaultApiVersion} from './backupGroup'\n\nconst helpText = `\nExamples\n  sanity backup enable DATASET_NAME\n`\n\nconst enableDatasetBackupCommand: CliCommandDefinition = {\n  name: 'enable',\n  group: 'backup',\n  signature: '[DATASET_NAME]',\n  description: 'Enable backup for a dataset.',\n  helpText,\n  action: async (args, context) => {\n    const {output, chalk} = context\n    const [dataset] = args.argsWithoutOptions\n    const {projectId, datasetName, token, client} = await resolveApiClient(\n      context,\n      dataset,\n      defaultApiVersion,\n    )\n\n    try {\n      await client.request({\n        method: 'PUT',\n        headers: {Authorization: `Bearer ${token}`},\n        uri: `/projects/${projectId}/datasets/${datasetName}/settings/backups`,\n        body: {\n          enabled: true,\n        },\n      })\n\n      output.print(`${chalk.green(`Enabled backups for dataset ${datasetName}.\\n`)}`)\n\n      output.print(\n        `${chalk.bold(`Retention policies may apply depending on your plan and agreement.\\n`)}`,\n      )\n    } catch (error) {\n      const msg = error.statusCode\n        ? error.response.body.message\n        : error.message || error.statusMessage\n      output.print(`${chalk.red(`Enabling dataset backup failed: ${msg}`)}\\n`)\n    }\n  },\n}\nexport default enableDatasetBackupCommand\n","import {type CliCommandDefinition} from '@sanity/cli'\nimport {Table} from 'console-table-printer'\nimport {isAfter, isValid, lightFormat, parse} from 'date-fns'\nimport {hideBin} from 'yargs/helpers'\nimport yargs from 'yargs/yargs'\n\nimport parseApiErr from '../../actions/backup/parseApiErr'\nimport resolveApiClient from '../../actions/backup/resolveApiClient'\nimport {defaultApiVersion} from './backupGroup'\n\nconst DEFAULT_LIST_BACKUP_LIMIT = 30\n\ninterface ListDatasetBackupFlags {\n  before?: string\n  after?: string\n  limit?: string\n}\n\ntype ListBackupRequestQueryParams = {\n  before?: string\n  after?: string\n  limit: string\n}\n\ntype ListBackupResponse = {\n  backups: ListBackupResponseItem[]\n}\n\ntype ListBackupResponseItem = {\n  id: string\n  createdAt: string\n}\n\nconst helpText = `\nOptions\n  --limit <int>     Maximum number of backups returned. Default 30.\n  --after <string>  Only return backups after this date (inclusive)\n  --before <string> Only return backups before this date (exclusive). Cannot be younger than <after> if specified.\n\nExamples\n  sanity backup list DATASET_NAME\n  sanity backup list DATASET_NAME --limit 50\n  sanity backup list DATASET_NAME --after 2024-01-31 --limit 10\n  sanity backup list DATASET_NAME --after 2024-01-31 --before 2024-01-10\n`\n\nfunction parseCliFlags(args: {argv?: string[]}) {\n  return yargs(hideBin(args.argv || process.argv).slice(2))\n    .options('after', {type: 'string'})\n    .options('before', {type: 'string'})\n    .options('limit', {type: 'number', default: DEFAULT_LIST_BACKUP_LIMIT, alias: 'l'}).argv\n}\n\nconst listDatasetBackupCommand: CliCommandDefinition<ListDatasetBackupFlags> = {\n  name: 'list',\n  group: 'backup',\n  signature: '[DATASET_NAME]',\n  description: 'List available backups for a dataset.',\n  helpText,\n  action: async (args, context) => {\n    const {output, chalk} = context\n    const flags = await parseCliFlags(args)\n    const [dataset] = args.argsWithoutOptions\n\n    const {projectId, datasetName, token, client} = await resolveApiClient(\n      context,\n      dataset,\n      defaultApiVersion,\n    )\n\n    const query: ListBackupRequestQueryParams = {limit: DEFAULT_LIST_BACKUP_LIMIT.toString()}\n    if (flags.limit) {\n      // We allow limit up to Number.MAX_SAFE_INTEGER to leave it for server-side validation,\n      //  while still sending sensible value in limit string.\n      if (flags.limit < 1 || flags.limit > Number.MAX_SAFE_INTEGER) {\n        throw new Error(\n          `Parsing --limit: must be an integer between 1 and ${Number.MAX_SAFE_INTEGER}`,\n        )\n      }\n      query.limit = flags.limit.toString()\n    }\n\n    if (flags.before || flags.after) {\n      try {\n        const parsedBefore = processDateFlags(flags.before)\n        const parsedAfter = processDateFlags(flags.after)\n\n        if (parsedAfter && parsedBefore && isAfter(parsedAfter, parsedBefore)) {\n          throw new Error('--after date must be before --before')\n        }\n\n        query.before = flags.before\n        query.after = flags.after\n      } catch (err) {\n        throw new Error(`Parsing date flags: ${err}`)\n      }\n    }\n\n    let response\n    try {\n      response = await client.request<ListBackupResponse>({\n        headers: {Authorization: `Bearer ${token}`},\n        uri: `/projects/${projectId}/datasets/${datasetName}/backups`,\n        query: {...query},\n      })\n    } catch (error) {\n      const {message} = parseApiErr(error)\n      output.error(`${chalk.red(`List dataset backup failed: ${message}`)}\\n`)\n    }\n\n    if (response && response.backups) {\n      if (response.backups.length === 0) {\n        output.print('No backups found.')\n        return\n      }\n\n      const table = new Table({\n        columns: [\n          {name: 'resource', title: 'RESOURCE', alignment: 'left'},\n          {name: 'createdAt', title: 'CREATED AT', alignment: 'left'},\n          {name: 'backupId', title: 'BACKUP ID', alignment: 'left'},\n        ],\n      })\n\n      response.backups.forEach((backup: ListBackupResponseItem) => {\n        const {id, createdAt} = backup\n        table.addRow({\n          resource: 'Dataset',\n          createdAt: lightFormat(Date.parse(createdAt), 'yyyy-MM-dd HH:mm:ss'),\n          backupId: id,\n        })\n      })\n\n      table.printTable()\n    }\n  },\n}\n\nfunction processDateFlags(date: string | undefined): Date | undefined {\n  if (!date) return undefined\n  const parsedDate = parse(date, 'yyyy-MM-dd', new Date())\n  if (isValid(parsedDate)) {\n    return parsedDate\n  }\n\n  throw new Error(`Invalid ${date} date format. Use YYYY-MM-DD`)\n}\n\nexport default listDatasetBackupCommand\n","import type {CliCommandArguments, CliCommandContext, CliCommandDefinition} from '@sanity/cli'\nimport {BuildSanityStudioCommandFlags} from '../../actions/build/buildAction'\n\nconst helpText = `\nOptions\n  --source-maps Enable source maps for built bundles (increases size of bundle)\n  --no-minify Skip minifying built JavaScript (speeds up build, increases size of bundle)\n  -y, --yes Use unattended mode, accepting defaults and using only flags for choices\n\nExamples\n  sanity build\n  sanity build --no-minify --source-maps\n`\n\nconst buildCommand: CliCommandDefinition = {\n  name: 'build',\n  signature: '[OUTPUT_DIR]',\n  description: 'Builds the Sanity Studio configuration into a static bundle',\n  action: async (\n    args: CliCommandArguments<BuildSanityStudioCommandFlags>,\n    context: CliCommandContext,\n    overrides?: {basePath?: string},\n  ) => {\n    const buildAction = await getBuildAction()\n\n    return buildAction(args, context, overrides)\n  },\n  helpText,\n}\n\nasync function getBuildAction() {\n  // NOTE: in dev-mode we want to include from `src` so we need to use `.ts` extension\n  // NOTE: this `if` statement is not included in the output bundle\n  if (__DEV__) {\n    // eslint-disable-next-line import/extensions\n    const mod: typeof import('../../actions/build/buildAction') = require('../../actions/build/buildAction.ts')\n\n    return mod.default\n  }\n\n  const mod = await import('../../actions/build/buildAction')\n\n  return mod.default\n}\n\nexport default buildCommand\n","import {type CliCommandDefinition} from '@sanity/cli'\n\nconst checkCommand: CliCommandDefinition = {\n  name: 'check',\n  signature: '',\n  description: '[deprecated]',\n  helpText: '',\n  hideFromHelp: true,\n  action: (_args, context) => {\n    const {output} = context\n    output.print('`sanity check` is deprecated and no longer has any effect')\n    return Promise.resolve()\n  },\n}\n\nexport default checkCommand\n","import {type CliCommandDefinition} from '@sanity/cli'\n\nconst configCheckCommand: CliCommandDefinition = {\n  name: 'configcheck',\n  signature: '',\n  description: 'Checks if the required configuration files for plugins exists and are up to date',\n  helpText: '',\n  hideFromHelp: true,\n  action: async (args, context) => {\n    context.output.error('`sanity configcheck` is no longer required/used')\n    return Promise.resolve()\n  },\n}\n\nexport default configCheckCommand\n","import {type CliCommandContext, type CliPrompter} from '@sanity/cli'\nimport logSymbols from 'log-symbols'\nimport oneline from 'oneline'\nimport url from 'url'\n\nconst wildcardReplacement = 'a-wild-card-r3pl4c3m3n7-a'\nconst portReplacement = ':7777777'\n\ninterface AddCorsOriginFlags {\n  credentials?: boolean\n}\n\nexport async function addCorsOrigin(\n  givenOrigin: string,\n  flags: AddCorsOriginFlags,\n  context: CliCommandContext,\n): Promise<boolean> {\n  const {apiClient, prompt, output} = context\n  const origin = await (givenOrigin\n    ? filterAndValidateOrigin(givenOrigin)\n    : promptForOrigin(prompt))\n\n  const hasWildcard = origin.includes('*')\n  if (hasWildcard && !(await promptForWildcardConfirmation(origin, context))) {\n    return false\n  }\n  const allowCredentials =\n    typeof flags.credentials === 'undefined'\n      ? await promptForCredentials(hasWildcard, context)\n      : Boolean(flags.credentials)\n\n  if (givenOrigin !== origin) {\n    output.print(`Normalized origin to ${origin}`)\n  }\n\n  const client = apiClient({\n    requireUser: true,\n    requireProject: true,\n  })\n\n  await client.request({\n    method: 'POST',\n    url: '/cors',\n    body: {origin, allowCredentials},\n    maxRedirects: 0,\n  })\n\n  return true\n}\n\nfunction promptForCredentials(hasWildcard: boolean, context: CliCommandContext): Promise<string> {\n  const {prompt, output, chalk} = context\n\n  output.print('')\n  if (hasWildcard) {\n    output.print(oneline`\n      ${chalk.yellow(`${logSymbols.warning} Warning:`)}\n      We ${chalk.red(chalk.underline('HIGHLY'))} recommend NOT allowing credentials\n      on origins containing wildcards. If you are logged in to a studio, people will\n      be able to send requests ${chalk.underline('on your behalf')} to read and modify\n      data, from any matching origin. Please tread carefully!\n    `)\n  } else {\n    output.print(oneline`\n      ${chalk.yellow(`${logSymbols.warning} Warning:`)}\n      Should this origin be allowed to send requests using authentication tokens or\n      session cookies? Be aware that any script on this origin will be able to send\n      requests ${chalk.underline('on your behalf')} to read and modify data if you\n      are logged in to a Sanity studio. If this origin hosts a studio, you will need\n      this, otherwise you should probably answer \"No\" (n).\n    `)\n  }\n\n  output.print('')\n\n  return prompt.single({\n    type: 'confirm',\n    message: oneline`\n      Allow credentials to be sent from this origin? Please read the warning above.\n    `,\n    default: false,\n  })\n}\n\nfunction promptForWildcardConfirmation(\n  origin: string,\n  context: CliCommandContext,\n): Promise<boolean> {\n  const {prompt, output, chalk} = context\n\n  output.print('')\n  output.print(chalk.yellow(`${logSymbols.warning} Warning: Examples of allowed origins:`))\n\n  if (origin === '*') {\n    output.print('- http://www.some-malicious.site')\n    output.print('- https://not.what-you-were-expecting.com')\n    output.print('- https://high-traffic-site.com')\n    output.print('- http://192.168.1.1:8080')\n  } else {\n    output.print(`- ${origin.replace(/:\\*/, ':1234').replace(/\\*/g, 'foo')}`)\n    output.print(`- ${origin.replace(/:\\*/, ':3030').replace(/\\*/g, 'foo.bar')}`)\n  }\n\n  output.print('')\n\n  return prompt.single({\n    type: 'confirm',\n    message: oneline`\n      Using wildcards can be ${chalk.red('risky')}.\n      Are you ${chalk.underline('absolutely sure')} you want to allow this origin?`,\n    default: false,\n  })\n}\n\nfunction promptForOrigin(prompt: CliPrompter): Promise<string> {\n  return prompt.single({\n    type: 'input',\n    message: 'Origin (including protocol):',\n    filter: filterOrigin,\n    validate: (origin) => validateOrigin(origin, origin),\n  })\n}\n\nfunction filterOrigin(origin: string): string | null {\n  if (origin === '*' || origin === 'file:///*' || origin === 'null') {\n    return origin\n  }\n\n  try {\n    const example = origin\n      .replace(/([^:])\\*/g, `$1${wildcardReplacement}`)\n      .replace(/:\\*/, portReplacement)\n\n    const parsed = url.parse(example)\n    let host = parsed.host || ''\n    if (/^https?:$/.test(parsed.protocol || '')) {\n      host = host.replace(/:(80|443)$/, '')\n    }\n\n    host = host.replace(portReplacement, ':*').replace(new RegExp(wildcardReplacement, 'g'), '*')\n\n    return `${parsed.protocol}//${host}`\n  } catch (err) {\n    return null\n  }\n}\n\nfunction validateOrigin(origin: string | null, givenOrigin: string): true | string {\n  if (origin === '*' || origin === 'file:///*' || origin === 'null') {\n    return true\n  }\n\n  try {\n    url.parse(origin || (0 as any as string)) // Use 0 to trigger error for unset values\n    return true\n  } catch (err) {\n    // Fall-through to error\n  }\n\n  if (/^file:\\/\\//.test(givenOrigin)) {\n    return `Only a local file wildcard is currently allowed: file:///*`\n  }\n\n  return `Invalid origin \"${givenOrigin}\", must include protocol (https://some.host)`\n}\n\nfunction filterAndValidateOrigin(givenOrigin: string): string {\n  const origin = filterOrigin(givenOrigin)\n  const result = validateOrigin(origin, givenOrigin)\n  if (result !== true) {\n    throw new Error(result)\n  }\n\n  if (!origin) {\n    throw new Error('Invalid origin')\n  }\n\n  return origin\n}\n","import {type CliCommandDefinition} from '@sanity/cli'\nimport fs from 'fs'\nimport path from 'path'\n\nimport {addCorsOrigin} from '../../actions/cors/addCorsOrigin'\n\nconst helpText = `\nOptions\n  --credentials Allow credentials (token/cookie) to be sent from this origin\n  --no-credentials Disallow credentials (token/cookie) to be sent from this origin\n\nExamples\n  sanity cors add\n  sanity cors add http://localhost:3000 --no-credentials\n`\n\nconst addCorsOriginCommand: CliCommandDefinition = {\n  name: 'add',\n  group: 'cors',\n  signature: '[ORIGIN]',\n  helpText,\n  description: 'Allow a new origin to use your project API through CORS',\n  action: async (args, context) => {\n    const {output} = context\n    const [origin] = args.argsWithoutOptions\n\n    if (!origin) {\n      throw new Error('No origin specified, use `sanity cors add <origin-url>`')\n    }\n\n    const flags = args.extOptions\n\n    // eslint-disable-next-line no-sync\n    const isFile = fs.existsSync(path.join(process.cwd(), origin))\n    if (isFile) {\n      output.warn(`Origin \"${origin}?\" Remember to quote values (sanity cors add \"*\")`)\n    }\n\n    const success = await addCorsOrigin(origin, flags, context)\n    if (success) {\n      output.print('CORS origin added successfully')\n    }\n  },\n}\n\nexport default addCorsOriginCommand\n","import {type CliCommandGroupDefinition} from '@sanity/cli'\n\nconst corsGroup: CliCommandGroupDefinition = {\n  name: 'cors',\n  signature: '[COMMAND]',\n  isGroupRoot: true,\n  description: 'Configures CORS settings for Sanity projects',\n}\n\nexport default corsGroup\n","import {type CliCommandContext, type CliCommandDefinition} from '@sanity/cli'\n\nimport {type CorsOrigin} from './types'\n\nconst helpText = `\nExamples\n  sanity cors delete\n  sanity cors delete http://localhost:3000\n`\n\nconst deleteCorsOriginCommand: CliCommandDefinition = {\n  name: 'delete',\n  group: 'cors',\n  signature: '[ORIGIN]',\n  helpText,\n  description: 'Delete an existing CORS-origin from your project',\n  action: async (args, context) => {\n    const {output, apiClient} = context\n    const [origin] = args.argsWithoutOptions\n    const client = apiClient({requireUser: true, requireProject: true})\n    const originId = await promptForOrigin(origin, context)\n    try {\n      await client.request({method: 'DELETE', uri: `/cors/${originId}`})\n      output.print('Origin deleted')\n    } catch (err) {\n      throw new Error(`Origin deletion failed:\\n${err.message}`)\n    }\n  },\n}\n\nexport default deleteCorsOriginCommand\n\nasync function promptForOrigin(specified: string | undefined, context: CliCommandContext) {\n  const specifiedOrigin = specified && specified.toLowerCase()\n  const {prompt, apiClient} = context\n  const client = apiClient({requireUser: true, requireProject: true})\n\n  const origins = await client.request<CorsOrigin[]>({url: '/cors'})\n  if (specifiedOrigin) {\n    const selected = origins.filter((origin) => origin.origin.toLowerCase() === specifiedOrigin)[0]\n    if (!selected) {\n      throw new Error(`Origin \"${specified} not found\"`)\n    }\n\n    return selected.id\n  }\n\n  const choices = origins.map((origin) => ({value: origin.id, name: origin.origin}))\n  return prompt.single({\n    message: 'Select origin to delete',\n    type: 'list',\n    choices,\n  })\n}\n","import {type CliCommandDefinition} from '@sanity/cli'\n\nimport {type CorsOrigin} from './types'\n\nconst helpText = `\nExamples\n  sanity cors list\n`\n\nconst listCorsOriginsCommand: CliCommandDefinition = {\n  name: 'list',\n  group: 'cors',\n  signature: '',\n  helpText,\n  description: 'List all origins allowed to access the API for this project',\n  action: async (args, context) => {\n    const {output} = context\n    const {apiClient} = context\n    const client = apiClient({requireUser: true, requireProject: true})\n    const origins = await client.request<CorsOrigin[]>({url: '/cors'})\n    output.print(origins.map((origin) => origin.origin).join('\\n'))\n  },\n}\n\nexport default listCorsOriginsCommand\n","const MAX_DATASET_NAME_LENGTH = 64\n\nexport function validateDatasetAliasName(datasetName: string): false | string {\n  if (!datasetName) {\n    return 'Alias name is missing'\n  }\n\n  const name = `${datasetName}`\n\n  if (name.toLowerCase() !== name) {\n    return 'Alias name must be all lowercase characters'\n  }\n\n  if (name.length < 2) {\n    return 'Alias name must be at least two characters long'\n  }\n\n  if (name.length > MAX_DATASET_NAME_LENGTH) {\n    return `Alias name must be at most ${MAX_DATASET_NAME_LENGTH} characters`\n  }\n\n  if (!/^[a-z0-9~]/.test(name)) {\n    return 'Alias name must start with a letter or a number'\n  }\n\n  if (!/^[a-z0-9~][-_a-z0-9]+$/.test(name)) {\n    return 'Alias name must only contain letters, numbers, dashes and underscores'\n  }\n\n  if (/[-_]$/.test(name)) {\n    return 'Alias name must not end with a dash or an underscore'\n  }\n\n  return false\n}\n","import {type CliPrompter} from '@sanity/cli'\n\nimport {validateDatasetAliasName} from './validateDatasetAliasName'\n\nexport function promptForDatasetAliasName(\n  prompt: CliPrompter,\n  options: {message?: string; default?: string} = {},\n): Promise<string> {\n  return prompt.single({\n    type: 'input',\n    message: 'Alias name:',\n    validate: (name) => {\n      const err = validateDatasetAliasName(name)\n      if (err) {\n        return err\n      }\n\n      return true\n    },\n    ...options,\n  })\n}\n","import {type SanityClient} from '@sanity/client'\n\nimport {validateDatasetAliasName} from '../../../actions/dataset/alias/validateDatasetAliasName'\nimport {type DatasetAliasDefinition, type DatasetModificationResponse} from './types'\n\nexport const ALIAS_PREFIX = '~'\n\nexport function listAliases(client: SanityClient): Promise<DatasetAliasDefinition[]> {\n  return client.request<DatasetAliasDefinition[]>({uri: '/aliases'})\n}\n\nexport function createAlias(\n  client: SanityClient,\n  aliasName: string,\n  datasetName: string | null,\n): Promise<DatasetModificationResponse> {\n  return modify(client, 'PUT', aliasName, datasetName ? {datasetName} : undefined)\n}\n\nexport function updateAlias(\n  client: SanityClient,\n  aliasName: string,\n  datasetName: string | null,\n): Promise<DatasetModificationResponse> {\n  return modify(client, 'PATCH', aliasName, datasetName ? {datasetName} : undefined)\n}\n\nexport function unlinkAlias(\n  client: SanityClient,\n  aliasName: string,\n): Promise<DatasetModificationResponse> {\n  validateDatasetAliasName(aliasName)\n  return modify(client, 'PATCH', `${aliasName}/unlink`, {})\n}\n\nexport function removeAlias(client: SanityClient, aliasName: string): Promise<{deleted: boolean}> {\n  return modify(client, 'DELETE', aliasName)\n}\n\nfunction modify(\n  client: SanityClient,\n  method: string,\n  aliasName: string,\n  body?: {datasetName?: string},\n) {\n  return client.request({method, uri: `/aliases/${aliasName}`, body})\n}\n","import {type CliCommandAction} from '@sanity/cli'\n\nimport {promptForDatasetAliasName} from '../../../actions/dataset/alias/promptForDatasetAliasName'\nimport {validateDatasetAliasName} from '../../../actions/dataset/alias/validateDatasetAliasName'\nimport {promptForDatasetName} from '../../../actions/dataset/datasetNamePrompt'\nimport {validateDatasetName} from '../../../actions/dataset/validateDatasetName'\nimport * as aliasClient from './datasetAliasesClient'\nimport {ALIAS_PREFIX} from './datasetAliasesClient'\n\nexport const createAliasHandler: CliCommandAction = async (args, context) => {\n  const {apiClient, output, prompt} = context\n  const [, alias, targetDataset] = args.argsWithoutOptions\n  const client = apiClient()\n\n  const nameError = alias && validateDatasetAliasName(alias)\n  if (nameError) {\n    throw new Error(nameError)\n  }\n\n  const [datasets, aliases, projectFeatures] = await Promise.all([\n    client.datasets.list().then((sets) => sets.map((ds) => ds.name)),\n    aliasClient.listAliases(client).then((sets) => sets.map((ds) => ds.name)),\n    client.request({uri: '/features'}),\n  ])\n\n  let aliasName = await (alias || promptForDatasetAliasName(prompt))\n  let aliasOutputName = aliasName\n\n  if (aliasName.startsWith(ALIAS_PREFIX)) {\n    aliasName = aliasName.substring(1)\n  } else {\n    aliasOutputName = `${ALIAS_PREFIX}${aliasName}`\n  }\n\n  if (aliases.includes(aliasName)) {\n    throw new Error(`Dataset alias \"${aliasOutputName}\" already exists`)\n  }\n\n  if (targetDataset) {\n    const datasetErr = validateDatasetName(targetDataset)\n    if (datasetErr) {\n      throw new Error(datasetErr)\n    }\n  }\n\n  const datasetName = await (targetDataset || promptForDatasetName(prompt))\n  if (datasetName && !datasets.includes(datasetName)) {\n    throw new Error(`Dataset \"${datasetName}\" does not exist `)\n  }\n\n  const canCreateAlias = projectFeatures.includes('advancedDatasetManagement')\n  if (!canCreateAlias) {\n    throw new Error(`This project cannot create a dataset alias`)\n  }\n\n  try {\n    await aliasClient.createAlias(client, aliasName, datasetName)\n    output.print(\n      `Dataset alias ${aliasOutputName} created ${\n        datasetName && `and linked to ${datasetName}`\n      } successfully`,\n    )\n  } catch (err) {\n    throw new Error(`Dataset alias creation failed:\\n${err.message}`)\n  }\n}\n","import {type CliCommandAction} from '@sanity/cli'\nimport {hideBin} from 'yargs/helpers'\nimport yargs from 'yargs/yargs'\n\nimport {validateDatasetAliasName} from '../../../actions/dataset/alias/validateDatasetAliasName'\nimport * as aliasClient from './datasetAliasesClient'\nimport {ALIAS_PREFIX} from './datasetAliasesClient'\n\nfunction parseCliFlags(args: {argv?: string[]}) {\n  return yargs(hideBin(args.argv || process.argv).slice(2)).option('force', {type: 'boolean'}).argv\n}\n\ninterface DeleteAliasFlags {\n  force?: boolean\n}\n\nexport const deleteAliasHandler: CliCommandAction<DeleteAliasFlags> = async (args, context) => {\n  const {apiClient, prompt, output} = context\n  const [, ds] = args.argsWithoutOptions\n  const {force} = await parseCliFlags(args)\n  const client = apiClient()\n  if (!ds) {\n    throw new Error('Dataset alias name must be provided')\n  }\n\n  let aliasName = `${ds}`\n  const dsError = validateDatasetAliasName(aliasName)\n  if (dsError) {\n    throw dsError\n  }\n  aliasName = aliasName.startsWith(ALIAS_PREFIX) ? aliasName.substring(1) : aliasName\n\n  const [fetchedAliases] = await Promise.all([aliasClient.listAliases(client)])\n  const linkedAlias = fetchedAliases.find((elem) => elem.name === aliasName)\n  const message =\n    linkedAlias && linkedAlias.datasetName\n      ? `This dataset alias is linked to ${linkedAlias.datasetName}. `\n      : ''\n\n  if (force) {\n    output.warn(`'--force' used: skipping confirmation, deleting alias \"${aliasName}\"`)\n  } else {\n    await prompt.single({\n      type: 'input',\n      message: `${message}Are you ABSOLUTELY sure you want to delete this dataset alias?\\n  Type the name of the dataset alias to confirm delete: `,\n      filter: (input) => `${input}`.trim(),\n      validate: (input) => {\n        return input === aliasName || 'Incorrect dataset alias name. Ctrl + C to cancel delete.'\n      },\n    })\n  }\n\n  return aliasClient.removeAlias(client, aliasName).then(() => {\n    output.print('Dataset alias deleted successfully')\n  })\n}\n","import {type CliCommandAction} from '@sanity/cli'\n\nimport {promptForDatasetAliasName} from '../../../actions/dataset/alias/promptForDatasetAliasName'\nimport {validateDatasetAliasName} from '../../../actions/dataset/alias/validateDatasetAliasName'\nimport {promptForDatasetName} from '../../../actions/dataset/datasetNamePrompt'\nimport {validateDatasetName} from '../../../actions/dataset/validateDatasetName'\nimport * as aliasClient from './datasetAliasesClient'\nimport {ALIAS_PREFIX} from './datasetAliasesClient'\n\nexport const linkAliasHandler: CliCommandAction = async (args, context) => {\n  const {apiClient, output, prompt} = context\n  const [, alias, targetDataset] = args.argsWithoutOptions\n  const flags = args.extOptions\n  const client = apiClient()\n\n  const nameError = alias && validateDatasetAliasName(alias)\n  if (nameError) {\n    throw new Error(nameError)\n  }\n\n  const [datasets, fetchedAliases] = await Promise.all([\n    client.datasets.list().then((sets) => sets.map((ds) => ds.name)),\n    aliasClient.listAliases(client),\n  ])\n  const aliases = fetchedAliases.map((da) => da.name)\n\n  let aliasName = await (alias || promptForDatasetAliasName(prompt))\n  let aliasOutputName = aliasName\n\n  if (aliasName.startsWith(ALIAS_PREFIX)) {\n    aliasName = aliasName.substring(1)\n  } else {\n    aliasOutputName = `${ALIAS_PREFIX}${aliasName}`\n  }\n\n  if (!aliases.includes(aliasName)) {\n    throw new Error(`Dataset alias \"${aliasOutputName}\" does not exist `)\n  }\n\n  const datasetName = await (targetDataset || promptForDatasetName(prompt))\n  const datasetErr = validateDatasetName(datasetName)\n  if (datasetErr) {\n    throw new Error(datasetErr)\n  }\n\n  if (!datasets.includes(datasetName)) {\n    throw new Error(`Dataset \"${datasetName}\" does not exist `)\n  }\n\n  const linkedAlias = fetchedAliases.find((elem) => elem.name === aliasName)\n\n  if (linkedAlias && linkedAlias.datasetName) {\n    if (linkedAlias.datasetName === datasetName) {\n      throw new Error(`Dataset alias ${aliasOutputName} already linked to ${datasetName}`)\n    }\n\n    if (!flags.force) {\n      await prompt.single({\n        type: 'input',\n        message: `This alias is linked to dataset <${linkedAlias.datasetName}>. Are you ABSOLUTELY sure you want to link this dataset alias to this dataset?\n        \\n  Type YES/NO: `,\n        filter: (input) => `${input}`.toLowerCase(),\n        validate: (input) => {\n          return input === 'yes' || 'Ctrl + C to cancel dataset alias link.'\n        },\n      })\n    }\n  }\n\n  try {\n    await aliasClient.updateAlias(client, aliasName, datasetName)\n    output.print(`Dataset alias ${aliasOutputName} linked to ${datasetName} successfully`)\n  } catch (err) {\n    throw new Error(`Dataset alias link failed:\\n${err.message}`)\n  }\n}\n","import {type CliCommandAction} from '@sanity/cli'\nimport {hideBin} from 'yargs/helpers'\nimport yargs from 'yargs/yargs'\n\nimport {promptForDatasetAliasName} from '../../../actions/dataset/alias/promptForDatasetAliasName'\nimport {validateDatasetAliasName} from '../../../actions/dataset/alias/validateDatasetAliasName'\nimport * as aliasClient from './datasetAliasesClient'\nimport {ALIAS_PREFIX} from './datasetAliasesClient'\n\ninterface UnlinkFlags {\n  force?: boolean\n}\n\nfunction parseCliFlags(args: {argv?: string[]}) {\n  return yargs(hideBin(args.argv || process.argv).slice(2)).option('force', {type: 'boolean'}).argv\n}\n\nexport const unlinkAliasHandler: CliCommandAction<UnlinkFlags> = async (args, context) => {\n  const {apiClient, output, prompt} = context\n  const [, alias] = args.argsWithoutOptions\n  const {force} = await parseCliFlags(args)\n  const client = apiClient()\n\n  const nameError = alias && validateDatasetAliasName(alias)\n  if (nameError) {\n    throw new Error(nameError)\n  }\n\n  const fetchedAliases = await aliasClient.listAliases(client)\n\n  let aliasName = await (alias || promptForDatasetAliasName(prompt))\n  let aliasOutputName = aliasName\n\n  if (aliasName.startsWith(ALIAS_PREFIX)) {\n    aliasName = aliasName.substring(1)\n  } else {\n    aliasOutputName = `${ALIAS_PREFIX}${aliasName}`\n  }\n\n  // get the current alias from the remote alias list\n  const linkedAlias = fetchedAliases.find((elem) => elem.name === aliasName)\n  if (!linkedAlias) {\n    throw new Error(`Dataset alias \"${aliasOutputName}\" does not exist`)\n  }\n\n  if (!linkedAlias.datasetName) {\n    throw new Error(`Dataset alias \"${aliasOutputName}\" is not linked to a dataset`)\n  }\n\n  if (force) {\n    output.warn(`'--force' used: skipping confirmation, unlinking alias \"${aliasOutputName}\"`)\n  } else {\n    await prompt.single({\n      type: 'input',\n      message: `Are you ABSOLUTELY sure you want to unlink this alias from the \"${linkedAlias.datasetName}\" dataset?\n        \\n  Type YES/NO: `,\n      filter: (input) => `${input}`.toLowerCase(),\n      validate: (input) => {\n        return input === 'yes' || 'Ctrl + C to cancel dataset alias unlink.'\n      },\n    })\n  }\n\n  try {\n    const result = await aliasClient.unlinkAlias(client, aliasName)\n    output.print(\n      `Dataset alias ${aliasOutputName} unlinked from ${result.datasetName} successfully`,\n    )\n  } catch (err) {\n    throw new Error(`Dataset alias unlink failed:\\n${err.message}`)\n  }\n}\n","import {type CliCommandDefinition} from '@sanity/cli'\nimport oneline from 'oneline'\n\nimport {createAliasHandler} from './createAliasHandler'\nimport {deleteAliasHandler} from './deleteAliasHandler'\nimport {linkAliasHandler} from './linkAliasHandler'\nimport {unlinkAliasHandler} from './unlinkAliasHandler'\n\nconst helpText = `\nBelow are examples of the alias subcommand\n\nCreate Alias\n  sanity dataset alias create\n  sanity dataset alias create <alias-name>\n  sanity dataset alias create <alias-name> <target-dataset>\n\nDelete Alias\n  Options\n    --force Skips security prompt and forces link command\n\n  Usage\n    sanity dataset alias delete <alias-name>\n    sanity dataset alias delete <alias-name> --force\n\nLink Alias\n  Options\n    --force Skips security prompt and forces link command\n\n  Usage\n    sanity dataset alias link\n    sanity dataset alias link <alias-name>\n    sanity dataset alias link <alias-name> <target-dataset>\n    sanity dataset alias link <alias-name> <target-dataset> --force\n\nUn-link Alias\n  Options\n    --force Skips security prompt and forces link command\n\n  Usage\n    sanity dataset alias unlink\n    sanity dataset alias unlink <alias-name>\n    sanity dataset alias unlink <alias-name> --force\n`\n\nconst aliasCommand: CliCommandDefinition = {\n  name: 'alias',\n  group: 'dataset',\n  signature: 'SUBCOMMAND [ALIAS_NAME, TARGET_DATASET]',\n  helpText,\n  description: 'You can manage your dataset alias using this command.',\n  action: async (args, context) => {\n    const [verb] = args.argsWithoutOptions\n    switch (verb) {\n      case 'create':\n        await createAliasHandler(args, context)\n        break\n      case 'delete':\n        await deleteAliasHandler(args, context)\n        break\n      case 'unlink':\n        await unlinkAliasHandler(args, context)\n        break\n      case 'link':\n        await linkAliasHandler(args, context)\n        break\n      default:\n        throw new Error(oneline`\n          Invalid command provided. Available commands are: create, delete, link and unlink.\n          For more guide run the help command 'sanity dataset alias --help'\n        `)\n    }\n  },\n}\n\nexport default aliasCommand\n","import {type CliCommandContext} from '@sanity/cli'\nimport {Table} from 'console-table-printer'\nimport {formatDistance, formatDistanceToNow, parseISO} from 'date-fns'\n\ninterface ListFlags {\n  offset?: number\n  limit?: number\n}\n\ntype CopyDatasetListResponse = {\n  id: string\n  state: string\n  createdAt: string\n  updatedAt: string\n  sourceDataset: string\n  targetDataset: string\n  withHistory: boolean\n}[]\n\nexport async function listDatasetCopyJobs(\n  flags: ListFlags,\n  context: CliCommandContext,\n): Promise<void> {\n  const {apiClient, output, chalk} = context\n  const client = apiClient()\n  const projectId = client.config().projectId\n  const query: {offset?: string; limit?: string} = {}\n  let response\n\n  if (flags.offset && flags.offset >= 0) {\n    query.offset = `${flags.offset}`\n  }\n  if (flags.limit && flags.limit > 0) {\n    query.limit = `${flags.limit}`\n  }\n\n  try {\n    response = await client.request<CopyDatasetListResponse>({\n      method: 'GET',\n      uri: `/projects/${projectId}/datasets/copy`,\n      query,\n    })\n  } catch (error) {\n    if (error.statusCode) {\n      output.error(`${chalk.red(`Dataset copy list failed:\\n${error.response.body.message}`)}\\n`)\n    } else {\n      output.error(`${chalk.red(`Dataset copy list failed:\\n${error.message}`)}\\n`)\n    }\n  }\n\n  if (response && response.length > 0) {\n    const table = new Table({\n      title: 'Dataset copy jobs for this project in descending order',\n      columns: [\n        {name: 'id', title: 'Job ID', alignment: 'left'},\n        {name: 'sourceDataset', title: 'Source Dataset', alignment: 'left'},\n        {name: 'targetDataset', title: 'Target Dataset', alignment: 'left'},\n        {name: 'state', title: 'State', alignment: 'left'},\n        {name: 'withHistory', title: 'With history', alignment: 'left'},\n        {name: 'timeStarted', title: 'Time started', alignment: 'left'},\n        {name: 'timeTaken', title: 'Time taken', alignment: 'left'},\n      ],\n    })\n\n    response.forEach((job) => {\n      const {id, state, createdAt, updatedAt, sourceDataset, targetDataset, withHistory} = job\n\n      let timeStarted = ''\n      if (createdAt !== '') {\n        timeStarted = formatDistanceToNow(parseISO(createdAt))\n      }\n\n      let timeTaken = ''\n      if (updatedAt !== '') {\n        timeTaken = formatDistance(parseISO(updatedAt), parseISO(createdAt))\n      }\n\n      let color\n      switch (state) {\n        case 'completed':\n          color = 'green'\n          break\n        case 'failed':\n          color = 'red'\n          break\n        case 'pending':\n          color = 'yellow'\n          break\n        default:\n          color = ''\n      }\n\n      table.addRow(\n        {\n          id,\n          state,\n          withHistory,\n          timeStarted: `${timeStarted} ago`,\n          timeTaken,\n          sourceDataset,\n          targetDataset,\n        },\n        {color},\n      )\n    })\n\n    table.printTable()\n  } else {\n    output.print(\"This project doesn't have any dataset copy jobs\")\n  }\n}\n","import {type SanityClient} from '@sanity/client'\n\nexport const getClientUrl = (client: SanityClient, uri: string, useCdn = false): string => {\n  const config = client.config()\n  const base = useCdn ? config.cdnUrl : config.url\n  return `${base}/${uri.replace(/^\\//, '')}`\n}\n","import {type CliCommandDefinition, type CliOutputter} from '@sanity/cli'\nimport {type SanityClient} from '@sanity/client'\nimport EventSource from '@sanity/eventsource'\nimport {Observable} from 'rxjs'\nimport {hideBin} from 'yargs/helpers'\nimport yargs from 'yargs/yargs'\n\nimport {promptForDatasetName} from '../../actions/dataset/datasetNamePrompt'\nimport {listDatasetCopyJobs} from '../../actions/dataset/listDatasetCopyJobs'\nimport {validateDatasetName} from '../../actions/dataset/validateDatasetName'\nimport {debug} from '../../debug'\nimport {getClientUrl} from '../../util/getClientUrl'\n\nconst helpText = `\nOptions\n  --detach Start the copy without waiting for it to finish\n  --attach <job-id> Attach to the running copy process to show progress\n  --skip-history Don't preserve document history on copy\n  --list Lists all dataset copy jobs corresponding to a certain criteria.\n  --offset Start position in the list of jobs. Default 0. With --list.\n  --limit Maximum number of jobs returned. Default 10. Maximum 1000. With --list.\n\nExamples\n  sanity dataset copy\n  sanity dataset copy <source-dataset>\n  sanity dataset copy <source-dataset> <target-dataset>\n  sanity dataset copy --skip-history <source-dataset> <target-dataset>\n  sanity dataset copy --detach <source-dataset> <target-dataset>\n  sanity dataset copy --attach <job-id>\n  sanity dataset copy --list\n  sanity dataset copy --list --offset=2\n  sanity dataset copy --list --offset=2 --limit=10\n`\n\ninterface CopyProgressStreamEvent {\n  type: 'reconnect' | string\n  progress?: number\n}\n\ninterface CopyDatasetFlags {\n  list?: boolean\n  attach?: string\n  detach?: boolean\n  offset?: number\n  limit?: number\n  'skip-history'?: boolean\n}\n\ninterface CopyDatasetResponse {\n  jobId: string\n}\n\nfunction parseCliFlags(args: {argv?: string[]}) {\n  return yargs(hideBin(args.argv || process.argv).slice(2))\n    .option('attach', {type: 'string'})\n    .option('list', {type: 'boolean'})\n    .option('limit', {type: 'number'})\n    .option('offset', {type: 'number'})\n    .option('skip-history', {type: 'boolean'})\n    .option('detach', {type: 'boolean'}).argv\n}\n\nconst progress = (url: string) => {\n  return new Observable<CopyProgressStreamEvent>((observer) => {\n    let progressSource = new EventSource(url)\n    let stopped = false\n\n    function onError(error: unknown) {\n      if (progressSource) {\n        progressSource.close()\n      }\n\n      debug(`Error received: ${error}`)\n      if (stopped) {\n        return\n      }\n      observer.next({type: 'reconnect'})\n      progressSource = new EventSource(url)\n    }\n\n    function onChannelError(error: MessageEvent) {\n      stopped = true\n      progressSource.close()\n      observer.error(error)\n    }\n\n    function onMessage(event: MessageEvent) {\n      const data = JSON.parse(event.data)\n      if (data.state === 'failed') {\n        debug('Job failed. Data: %o', event)\n        observer.error(event)\n      } else if (data.state === 'completed') {\n        debug('Job succeeded. Data: %o', event)\n        onComplete()\n      } else {\n        debug(`Job progressed. Data: %o`, event)\n        observer.next(data)\n      }\n    }\n\n    function onComplete() {\n      progressSource.removeEventListener('error', onError)\n      progressSource.removeEventListener('channel_error', onChannelError)\n      progressSource.removeEventListener('job', onMessage)\n      progressSource.removeEventListener('done', onComplete)\n      progressSource.close()\n      observer.complete()\n    }\n\n    progressSource.addEventListener('error', onError)\n    progressSource.addEventListener('channel_error', onChannelError)\n    progressSource.addEventListener('job', onMessage)\n    progressSource.addEventListener('done', onComplete)\n  })\n}\n\nconst followProgress = (\n  jobId: string,\n  client: SanityClient,\n  output: CliOutputter,\n): Promise<void> => {\n  let currentProgress = 0\n\n  const spinner = output.spinner({}).start()\n  const listenUrl = getClientUrl(client, `jobs/${jobId}/listen`)\n\n  debug(`Listening to ${listenUrl}`)\n\n  return new Promise((resolve, reject) => {\n    progress(listenUrl).subscribe({\n      next: (event) => {\n        if (typeof event.progress === 'number') {\n          currentProgress = event.progress\n        }\n\n        spinner.text = `Copy in progress: ${currentProgress}%`\n      },\n      error: (err) => {\n        spinner.fail()\n        reject(new Error(`${err.data}`))\n      },\n      complete: () => {\n        spinner.succeed('Copy finished.')\n        resolve()\n      },\n    })\n  })\n}\n\nconst copyDatasetCommand: CliCommandDefinition<CopyDatasetFlags> = {\n  name: 'copy',\n  group: 'dataset',\n  signature: '[SOURCE_DATASET] [TARGET_DATASET]',\n  helpText,\n  description:\n    'Manages dataset copying, including starting a new copy job, listing copy jobs and following the progress of a running copy job',\n  action: async (args, context) => {\n    const {apiClient, output, prompt, chalk} = context\n    // Reparsing CLI flags for better control of binary flags\n    const flags: CopyDatasetFlags = await parseCliFlags(args)\n    const client = apiClient()\n\n    if (flags.list) {\n      await listDatasetCopyJobs(flags, context)\n      return\n    }\n\n    if (flags.attach) {\n      const jobId = flags.attach\n\n      if (!jobId) {\n        throw new Error('Please supply a jobId')\n      }\n\n      await followProgress(jobId, client, output)\n      return\n    }\n\n    const [sourceDataset, targetDataset] = args.argsWithoutOptions\n    const shouldSkipHistory = Boolean(flags['skip-history'])\n\n    const nameError = sourceDataset && validateDatasetName(sourceDataset)\n    if (nameError) {\n      throw new Error(nameError)\n    }\n\n    const existingDatasets = await client.datasets\n      .list()\n      .then((datasets) => datasets.map((ds) => ds.name))\n\n    const sourceDatasetName = await (sourceDataset ||\n      promptForDatasetName(prompt, {message: 'Source dataset name:'}))\n    if (!existingDatasets.includes(sourceDatasetName)) {\n      throw new Error(`Source dataset \"${sourceDatasetName}\" doesn't exist`)\n    }\n\n    const targetDatasetName = await (targetDataset ||\n      promptForDatasetName(prompt, {message: 'Target dataset name:'}))\n    if (existingDatasets.includes(targetDatasetName)) {\n      throw new Error(`Target dataset \"${targetDatasetName}\" already exists`)\n    }\n\n    const err = validateDatasetName(targetDatasetName)\n    if (err) {\n      throw new Error(err)\n    }\n\n    try {\n      const response = await client.request<CopyDatasetResponse>({\n        method: 'PUT',\n        uri: `/datasets/${sourceDatasetName}/copy`,\n        body: {\n          targetDataset: targetDatasetName,\n          skipHistory: shouldSkipHistory,\n        },\n      })\n\n      output.print(\n        `Copying dataset ${chalk.green(sourceDatasetName)} to ${chalk.green(targetDatasetName)}...`,\n      )\n\n      if (!shouldSkipHistory) {\n        output.print(\n          `Note: You can run this command with flag '--skip-history'. The flag will reduce copy time in larger datasets.`,\n        )\n      }\n\n      output.print(`Job ${chalk.green(response.jobId)} started`)\n\n      if (flags.detach) {\n        return\n      }\n\n      await followProgress(response.jobId, client, output)\n      output.print(`Job ${chalk.green(response.jobId)} completed`)\n    } catch (error) {\n      if (error.statusCode) {\n        output.print(`${chalk.red(`Dataset copying failed:\\n${error.response.body.message}`)}\\n`)\n      } else {\n        output.print(`${chalk.red(`Dataset copying failed:\\n${error.message}`)}\\n`)\n      }\n    }\n  },\n}\n\nexport default copyDatasetCommand\n","import {type CliCommandDefinition, type CliOutputter, type CliPrompter} from '@sanity/cli'\n\nimport {promptForDatasetName} from '../../actions/dataset/datasetNamePrompt'\nimport {validateDatasetName} from '../../actions/dataset/validateDatasetName'\nimport {debug} from '../../debug'\n\nconst helpText = `\nOptions\n  --visibility <mode> Set visibility for this dataset (public/private)\n\nExamples\n  sanity dataset create\n  sanity dataset create <name>\n  sanity dataset create <name> --visibility private\n`\n\nconst allowedModes = ['private', 'public', 'custom']\n\ninterface CreateFlags {\n  visibility?: 'private' | 'public' | 'custom'\n}\n\nconst createDatasetCommand: CliCommandDefinition<CreateFlags> = {\n  name: 'create',\n  group: 'dataset',\n  signature: '[NAME]',\n  helpText,\n  description: 'Create a new dataset within your project',\n  action: async (args, context) => {\n    const {apiClient, output, prompt} = context\n    const flags = args.extOptions\n    const [dataset] = args.argsWithoutOptions\n    const client = apiClient()\n\n    const nameError = dataset && validateDatasetName(dataset)\n    if (nameError) {\n      throw new Error(nameError)\n    }\n\n    const [datasets, projectFeatures] = await Promise.all([\n      client.datasets.list().then((sets) => sets.map((ds) => ds.name)),\n      client.request({uri: '/features'}),\n    ])\n\n    if (flags.visibility && !allowedModes.includes(flags.visibility)) {\n      throw new Error(`Visibility mode \"${flags.visibility}\" not allowed`)\n    }\n\n    const datasetName = await (dataset || promptForDatasetName(prompt))\n    if (datasets.includes(datasetName)) {\n      throw new Error(`Dataset \"${datasetName}\" already exists`)\n    }\n\n    const canCreatePrivate = projectFeatures.includes('privateDataset')\n    debug('%s create private datasets', canCreatePrivate ? 'Can' : 'Cannot')\n\n    const defaultAclMode = canCreatePrivate ? flags.visibility : 'public'\n    const aclMode = await (defaultAclMode || promptForDatasetVisibility(prompt, output))\n\n    try {\n      await client.datasets.create(datasetName, {aclMode})\n      output.print('Dataset created successfully')\n    } catch (err) {\n      throw new Error(`Dataset creation failed:\\n${err.message}`)\n    }\n  },\n}\n\nasync function promptForDatasetVisibility(prompt: CliPrompter, output: CliOutputter) {\n  const mode = await prompt.single<'public' | 'private'>({\n    type: 'list',\n    message: 'Dataset visibility',\n    choices: [\n      {\n        value: 'public',\n        name: 'Public (world readable)',\n      },\n      {\n        value: 'private',\n        name: 'Private (Authenticated user or token needed)',\n      },\n    ],\n  })\n\n  if (mode === 'private') {\n    output.print(\n      'Please note that while documents are private, assets (files and images) are still public\\n',\n    )\n  }\n\n  return mode\n}\n\nexport default createDatasetCommand\n","export default {\n  name: 'dataset',\n  signature: '[COMMAND]',\n  isGroupRoot: true,\n  description: 'Manages datasets, like create or delete, within projects',\n}\n","import {type CliCommandDefinition} from '@sanity/cli'\n\nimport {validateDatasetName} from '../../actions/dataset/validateDatasetName'\n\nconst datasetVisibilityCommand: CliCommandDefinition = {\n  name: 'visibility',\n  group: 'dataset',\n  helpText: '',\n  signature: 'get/set [dataset] [mode]',\n  description: 'Set visibility of a dataset',\n  action: async (args, context) => {\n    const {apiClient, output} = context\n    const [action, ds, aclMode] = args.argsWithoutOptions\n    const client = apiClient()\n\n    if (!client.datasets.edit) {\n      throw new Error('@sanity/cli must be upgraded first:\\n  npm install -g @sanity/cli')\n    }\n\n    if (!action) {\n      throw new Error('Action must be provided (get/set)')\n    }\n\n    if (!['set', 'get'].includes(action)) {\n      throw new Error('Invalid action (only get/set allowed)')\n    }\n\n    if (!ds) {\n      throw new Error('Dataset name must be provided')\n    }\n\n    if (action === 'set' && !aclMode) {\n      throw new Error('Please provide a visibility mode (public/private)')\n    }\n\n    const dataset = `${ds}`\n    const dsError = validateDatasetName(dataset)\n    if (dsError) {\n      throw new Error(dsError)\n    }\n\n    const current = (await client.datasets.list()).find((curr) => curr.name === dataset)\n\n    if (!current) {\n      throw new Error('Dataset not found')\n    }\n\n    if (action === 'get') {\n      output.print(current.aclMode)\n      return\n    }\n\n    if (current.aclMode === aclMode) {\n      output.print(`Dataset already in \"${aclMode}\"-mode`)\n      return\n    }\n\n    if (aclMode === 'private') {\n      output.print(\n        'Please note that while documents are private, assets (files and images) are still public\\n',\n      )\n    }\n\n    await client.datasets.edit(dataset, {aclMode: aclMode as 'public' | 'private'})\n    output.print('Dataset visibility changed')\n  },\n}\n\nexport default datasetVisibilityCommand\n","import {type CliCommandDefinition} from '@sanity/cli'\nimport {hideBin} from 'yargs/helpers'\nimport yargs from 'yargs/yargs'\n\nimport {validateDatasetName} from '../../actions/dataset/validateDatasetName'\n\nconst helpText = `\nOptions\n  --force Do not prompt for delete confirmation - forcefully delete\n\nExamples\n  sanity dataset delete\n  sanity dataset delete my-dataset\n  sanity dataset delete my-dataset --force\n`\n\nfunction parseCliFlags(args: {argv?: string[]}) {\n  return yargs(hideBin(args.argv || process.argv).slice(2)).option('force', {type: 'boolean'}).argv\n}\n\ninterface DeleteDatasetFlags {\n  force?: boolean\n}\n\nconst deleteDatasetCommand: CliCommandDefinition<DeleteDatasetFlags> = {\n  name: 'delete',\n  group: 'dataset',\n  helpText,\n  signature: '[datasetName]',\n  description: 'Delete a dataset within your project',\n  action: async (args, context) => {\n    const {apiClient, prompt, output} = context\n    const {force} = await parseCliFlags(args)\n    const [ds] = args.argsWithoutOptions\n    if (!ds) {\n      throw new Error('Dataset name must be provided')\n    }\n\n    const dataset = `${ds}`\n    const dsError = validateDatasetName(dataset)\n    if (dsError) {\n      throw dsError\n    }\n\n    if (force) {\n      output.warn(`'--force' used: skipping confirmation, deleting dataset \"${dataset}\"`)\n    } else {\n      await prompt.single({\n        type: 'input',\n        message:\n          'Are you ABSOLUTELY sure you want to delete this dataset?\\n  Type the name of the dataset to confirm delete:',\n        filter: (input) => `${input}`.trim(),\n        validate: (input) => {\n          return input === dataset || 'Incorrect dataset name. Ctrl + C to cancel delete.'\n        },\n      })\n    }\n\n    await apiClient().datasets.delete(dataset)\n    output.print('Dataset deleted successfully')\n  },\n}\n\nexport default deleteDatasetCommand\n","import {type CliCommandDefinition, type CliPrompter} from '@sanity/cli'\nimport exportDataset from '@sanity/export'\nimport {absolutify} from '@sanity/util/fs'\nimport fs from 'fs/promises'\nimport path from 'path'\nimport prettyMs from 'pretty-ms'\n\nimport {chooseDatasetPrompt} from '../../actions/dataset/chooseDatasetPrompt'\nimport {validateDatasetName} from '../../actions/dataset/validateDatasetName'\n\nconst noop = () => null\n\nconst helpText = `\nOptions\n  --raw                     Extract only documents, without rewriting asset references\n  --no-assets               Export only non-asset documents and remove references to image assets\n  --no-drafts               Export only published versions of documents\n  --no-compress             Skips compressing tarball entries (still generates a gzip file)\n  --types                   Defines which document types to export\n  --overwrite               Overwrite any file with the same name\n  --asset-concurrency <num> Concurrent number of asset downloads\n\nExamples\n  sanity dataset export moviedb localPath.tar.gz\n  sanity dataset export moviedb assetless.tar.gz --no-assets\n  sanity dataset export staging staging.tar.gz --raw\n  sanity dataset export staging staging.tar.gz --types products,shops\n`\n\ninterface ExportFlags {\n  raw?: boolean\n  assets?: boolean\n  drafts?: boolean\n  compress?: boolean\n  overwrite?: boolean\n  types?: string\n  'asset-concurrency'?: string\n}\n\ninterface ParsedExportFlags {\n  raw?: boolean\n  assets?: boolean\n  drafts?: boolean\n  compress?: boolean\n  overwrite?: boolean\n  types?: string[]\n  assetConcurrency?: number\n}\n\nfunction parseFlags(rawFlags: ExportFlags): ParsedExportFlags {\n  const flags: ParsedExportFlags = {}\n  if (rawFlags.types) {\n    flags.types = `${rawFlags.types}`.split(',')\n  }\n\n  if (rawFlags['asset-concurrency']) {\n    flags.assetConcurrency = parseInt(rawFlags['asset-concurrency'], 10)\n  }\n\n  if (typeof rawFlags.raw !== 'undefined') {\n    flags.raw = Boolean(rawFlags.raw)\n  }\n\n  if (typeof rawFlags.assets !== 'undefined') {\n    flags.assets = Boolean(rawFlags.assets)\n  }\n\n  if (typeof rawFlags.drafts !== 'undefined') {\n    flags.drafts = Boolean(rawFlags.drafts)\n  }\n\n  if (typeof rawFlags.compress !== 'undefined') {\n    flags.compress = Boolean(rawFlags.compress)\n  }\n\n  if (typeof rawFlags.overwrite !== 'undefined') {\n    flags.overwrite = Boolean(rawFlags.overwrite)\n  }\n\n  return flags\n}\n\ninterface ProgressEvent {\n  step: string\n  update?: boolean\n  current: number\n  total: number\n}\n\nconst exportDatasetCommand: CliCommandDefinition<ExportFlags> = {\n  name: 'export',\n  group: 'dataset',\n  signature: '[NAME] [DESTINATION]',\n  description: 'Export dataset to local filesystem as a gzipped tarball',\n  helpText,\n  action: async (args, context) => {\n    const {apiClient, output, chalk, workDir, prompt} = context\n    const client = apiClient()\n    const [targetDataset, targetDestination] = args.argsWithoutOptions\n    const flags = parseFlags(args.extOptions)\n\n    let dataset = targetDataset ? `${targetDataset}` : null\n    if (!dataset) {\n      dataset = await chooseDatasetPrompt(context, {message: 'Select dataset to export'})\n    }\n\n    const dsError = validateDatasetName(dataset)\n    if (dsError) {\n      throw dsError\n    }\n\n    // Verify existence of dataset before trying to export from it\n    const datasets = await client.datasets.list()\n    if (!datasets.find((set) => set.name === dataset)) {\n      throw new Error(`Dataset with name \"${dataset}\" not found`)\n    }\n\n    // Print information about what projectId and dataset it is being exported from\n    const {projectId} = client.config()\n\n    output.print('╭───────────────────────────────────────────────╮')\n    output.print('│                                               │')\n    output.print('│ Exporting from:                               │')\n    output.print(`│ ${chalk.bold('projectId')}: ${chalk.cyan(projectId).padEnd(44)} │`)\n    output.print(`│ ${chalk.bold('dataset')}: ${chalk.cyan(dataset).padEnd(46)} │`)\n    output.print('│                                               │')\n    output.print('╰───────────────────────────────────────────────╯')\n    output.print('')\n\n    let destinationPath = targetDestination\n    if (!destinationPath) {\n      destinationPath = await prompt.single({\n        type: 'input',\n        message: 'Output path:',\n        default: path.join(workDir, `${dataset}.tar.gz`),\n        filter: absolutify,\n      })\n    }\n\n    const outputPath = await getOutputPath(destinationPath, dataset, prompt, flags)\n    if (!outputPath) {\n      output.print('Cancelled')\n      return\n    }\n\n    // If we are dumping to a file, let the user know where it's at\n    if (outputPath !== '-') {\n      output.print(`Exporting dataset \"${chalk.cyan(dataset)}\" to \"${chalk.cyan(outputPath)}\"`)\n    }\n\n    let currentStep = 'Exporting documents...'\n    let spinner = output.spinner(currentStep).start()\n    const onProgress = (progress: ProgressEvent) => {\n      if (progress.step !== currentStep) {\n        spinner.succeed()\n        spinner = output.spinner(progress.step).start()\n      } else if (progress.step === currentStep && progress.update) {\n        spinner.text = `${progress.step} (${progress.current}/${progress.total})`\n      }\n\n      currentStep = progress.step\n    }\n\n    const start = Date.now()\n    try {\n      await exportDataset({\n        client,\n        dataset,\n        outputPath,\n        onProgress,\n        ...flags,\n      })\n      spinner.succeed()\n    } catch (err) {\n      spinner.fail()\n      throw err\n    }\n\n    output.print(`Export finished (${prettyMs(Date.now() - start)})`)\n  },\n}\n\n// eslint-disable-next-line complexity\nasync function getOutputPath(\n  destination: string,\n  dataset: string,\n  prompt: CliPrompter,\n  flags: ParsedExportFlags,\n) {\n  if (destination === '-') {\n    return '-'\n  }\n\n  const dstPath = path.isAbsolute(destination)\n    ? destination\n    : path.resolve(process.cwd(), destination)\n\n  let dstStats = await fs.stat(dstPath).catch(noop)\n  const looksLikeFile = dstStats ? dstStats.isFile() : path.basename(dstPath).indexOf('.') !== -1\n\n  if (!dstStats) {\n    const createPath = looksLikeFile ? path.dirname(dstPath) : dstPath\n\n    await fs.mkdir(createPath, {recursive: true})\n  }\n\n  const finalPath = looksLikeFile ? dstPath : path.join(dstPath, `${dataset}.tar.gz`)\n  dstStats = await fs.stat(finalPath).catch(noop)\n\n  if (!flags.overwrite && dstStats && dstStats.isFile()) {\n    const shouldOverwrite = await prompt.single({\n      type: 'confirm',\n      message: `File \"${finalPath}\" already exists, would you like to overwrite it?`,\n      default: false,\n    })\n\n    if (!shouldOverwrite) {\n      return false\n    }\n  }\n\n  return finalPath\n}\n\nexport default exportDatasetCommand\n","import {type CliCommandContext, type CliCommandDefinition, type CliOutputter} from '@sanity/cli'\nimport sanityImport from '@sanity/import'\nimport {createReadStream} from 'fs'\nimport fs from 'fs/promises'\nimport {getIt} from 'get-it'\nimport {promise} from 'get-it/middleware'\nimport padStart from 'lodash/padStart'\nimport path from 'path'\nimport prettyMs from 'pretty-ms'\n\nimport {chooseDatasetPrompt} from '../../actions/dataset/chooseDatasetPrompt'\nimport {validateDatasetName} from '../../actions/dataset/validateDatasetName'\nimport {debug} from '../../debug'\n\nconst yellow = (str: string) => `\\u001b[33m${str}\\u001b[39m`\n\nconst helpText = `\nOptions\n  --missing On duplicate document IDs, skip importing document in question\n  --replace On duplicate document IDs, replace existing document with imported document\n  --allow-failing-assets Skip assets that cannot be fetched/uploaded\n  --replace-assets Skip reuse of existing assets\n  --skip-cross-dataset-references Skips references to other datasets\n\nRarely used options (should generally not be used)\n  --allow-assets-in-different-dataset Allow asset documents to reference different project/dataset\n  --allow-system-documents Allow system documents like dataset permissions and custom retention to be imported\n\nExamples\n  # Import \"moviedb.ndjson\" from the current directory to the dataset called \"moviedb\"\n  sanity dataset import moviedb.ndjson moviedb\n\n  # Import \"moviedb.tar.gz\" from the current directory to the dataset called \"moviedb\",\n  # replacing any documents encountered that have the same document IDs\n  sanity dataset import moviedb.tar.gz moviedb --replace\n\n  # Import from a folder containing an ndjson file, such as an extracted tarball\n  # retrieved through \"sanity dataset export\".\n  sanity dataset import ~/some/folder moviedb\n\n  # Import from a remote URL. Will download and extract the tarball to a temporary\n  # location before importing it.\n  sanity dataset import https://some.url/moviedb.tar.gz moviedb --replace\n`\n\ninterface ImportFlags {\n  'allow-assets-in-different-dataset'?: boolean\n  'allow-failing-assets'?: boolean\n  'asset-concurrency'?: boolean\n  'replace-assets'?: boolean\n  'skip-cross-dataset-references'?: boolean\n  'allow-system-documents'?: boolean\n  replace?: boolean\n  missing?: boolean\n}\n\ninterface ParsedImportFlags {\n  allowAssetsInDifferentDataset?: boolean\n  allowFailingAssets?: boolean\n  assetConcurrency?: boolean\n  skipCrossDatasetReferences?: boolean\n  allowSystemDocuments?: boolean\n  replaceAssets?: boolean\n  replace?: boolean\n  missing?: boolean\n}\n\ninterface ProgressEvent {\n  step: string\n  total?: number\n  current?: number\n}\n\ninterface ImportWarning {\n  type?: string\n  url?: string\n}\n\nfunction toBoolIfSet(flag: unknown): boolean | undefined {\n  return typeof flag === 'undefined' ? undefined : Boolean(flag)\n}\n\nfunction parseFlags(rawFlags: ImportFlags): ParsedImportFlags {\n  const allowAssetsInDifferentDataset = toBoolIfSet(rawFlags['allow-assets-in-different-dataset'])\n  const allowFailingAssets = toBoolIfSet(rawFlags['allow-failing-assets'])\n  const assetConcurrency = toBoolIfSet(rawFlags['asset-concurrency'])\n  const replaceAssets = toBoolIfSet(rawFlags['replace-assets'])\n  const skipCrossDatasetReferences = toBoolIfSet(rawFlags['skip-cross-dataset-references'])\n  const allowSystemDocuments = toBoolIfSet(rawFlags['allow-system-documents'])\n  const replace = toBoolIfSet(rawFlags.replace)\n  const missing = toBoolIfSet(rawFlags.missing)\n  return {\n    allowAssetsInDifferentDataset,\n    allowFailingAssets,\n    assetConcurrency,\n    skipCrossDatasetReferences,\n    allowSystemDocuments,\n    replaceAssets,\n    replace,\n    missing,\n  }\n}\n\nconst importDatasetCommand: CliCommandDefinition = {\n  name: 'import',\n  group: 'dataset',\n  signature: '[FILE | FOLDER | URL] [TARGET_DATASET]',\n  description: 'Import documents to given dataset from either an ndjson file or a gzipped tarball',\n  helpText,\n  // eslint-disable-next-line max-statements\n  action: async (args, context) => {\n    const {apiClient, output, chalk, fromInitCommand} = context\n    const flags = parseFlags(args.extOptions)\n    const {\n      allowAssetsInDifferentDataset,\n      allowFailingAssets,\n      assetConcurrency,\n      skipCrossDatasetReferences,\n      allowSystemDocuments,\n      replaceAssets,\n    } = flags\n\n    const operation = getMutationOperation(args.extOptions)\n    const client = apiClient()\n\n    const [file, target] = args.argsWithoutOptions\n    if (!file) {\n      throw new Error(\n        `Source file name and target dataset must be specified (\"sanity dataset import ${chalk.bold(\n          '[file]',\n        )} [dataset]\")`,\n      )\n    }\n\n    const targetDataset = await determineTargetDataset(target, context)\n    debug(`Target dataset has been set to \"${targetDataset}\"`)\n\n    const isUrl = /^https?:\\/\\//i.test(file)\n    let inputStream\n    let assetsBase\n    let sourceIsFolder = false\n\n    if (isUrl) {\n      debug('Input is a URL, streaming from source URL')\n      inputStream = await getUrlStream(file)\n    } else {\n      const sourceFile = path.resolve(process.cwd(), file)\n      const fileStats = await fs.stat(sourceFile).catch(() => null)\n      if (!fileStats) {\n        throw new Error(`${sourceFile} does not exist or is not readable`)\n      }\n\n      sourceIsFolder = fileStats.isDirectory()\n      if (sourceIsFolder) {\n        inputStream = sourceFile\n      } else {\n        assetsBase = path.dirname(sourceFile)\n        inputStream = await createReadStream(sourceFile)\n      }\n    }\n\n    const importClient = client.clone().config({dataset: targetDataset})\n\n    // Print information about what projectId and dataset it is being imported to\n    const {projectId, dataset} = importClient.config()\n\n    output.print('╭───────────────────────────────────────────────╮')\n    output.print('│                                               │')\n    output.print('│ Importing to:                                 │')\n    output.print(`│ ${chalk.bold('projectId')}: ${chalk.cyan(projectId).padEnd(44)} │`)\n    output.print(`│ ${chalk.bold('dataset')}: ${chalk.cyan(dataset).padEnd(46)} │`)\n    output.print('│                                               │')\n    output.print('╰───────────────────────────────────────────────╯')\n    output.print('')\n\n    let currentStep: string | undefined\n    let currentProgress: ReturnType<CliOutputter['spinner']> | undefined\n    let stepStart: number | undefined\n    let spinInterval: ReturnType<typeof setInterval> | null = null\n    let percent: string | undefined\n\n    function onProgress(opts: ProgressEvent) {\n      const lengthComputable = opts.total\n      const sameStep = opts.step == currentStep\n      percent = getPercentage(opts)\n\n      if (lengthComputable && opts.total === opts.current) {\n        if (spinInterval) {\n          clearInterval(spinInterval)\n        }\n        spinInterval = null\n      }\n\n      if (sameStep) {\n        return\n      }\n\n      // Moved to a new step\n      const prevStep = currentStep\n      const prevStepStart = stepStart || Date.now()\n      stepStart = Date.now()\n      currentStep = opts.step\n\n      if (currentProgress && currentProgress.succeed) {\n        const timeSpent = prettyMs(Date.now() - prevStepStart, {\n          secondsDecimalDigits: 2,\n        })\n        currentProgress.text = `[100%] ${prevStep} (${timeSpent})`\n        currentProgress.succeed()\n      }\n\n      currentProgress = output.spinner(`[0%] ${opts.step} (0.00s)`).start()\n\n      if (spinInterval) {\n        clearInterval(spinInterval)\n        spinInterval = null\n      }\n\n      spinInterval = setInterval(() => {\n        const timeSpent = prettyMs(Date.now() - prevStepStart, {\n          secondsDecimalDigits: 2,\n        })\n\n        if (currentProgress) {\n          currentProgress.text = `${percent}${opts.step} (${timeSpent})`\n        }\n      }, 60)\n    }\n\n    function endTask({success}: {success: boolean}) {\n      if (spinInterval) {\n        clearInterval(spinInterval)\n      }\n\n      spinInterval = null\n\n      if (success && stepStart && currentProgress) {\n        const timeSpent = prettyMs(Date.now() - stepStart, {\n          secondsDecimalDigits: 2,\n        })\n        currentProgress.text = `[100%] ${currentStep} (${timeSpent})`\n        currentProgress.succeed()\n      } else if (currentProgress) {\n        currentProgress.fail()\n      }\n    }\n\n    // Start the import!\n    try {\n      const {numDocs, warnings} = await sanityImport(inputStream, {\n        client: importClient,\n        assetsBase,\n        operation,\n        onProgress,\n        allowFailingAssets,\n        allowAssetsInDifferentDataset,\n        skipCrossDatasetReferences,\n        allowSystemDocuments,\n        assetConcurrency,\n        replaceAssets,\n      })\n\n      endTask({success: true})\n\n      output.print('Done! Imported %d documents to dataset \"%s\"\\n', numDocs, targetDataset)\n      printWarnings(warnings, output)\n    } catch (err) {\n      endTask({success: false})\n\n      const isNonRefConflict =\n        !fromInitCommand &&\n        err.response &&\n        err.response.statusCode === 409 &&\n        err.step !== 'strengthen-references'\n\n      if (!isNonRefConflict) {\n        throw err\n      }\n\n      const message = [\n        err.message,\n        '',\n        'You probably want either:',\n        ' --replace (replace existing documents with same IDs)',\n        ' --missing (only import documents that do not already exist)',\n        '',\n      ].join('\\n')\n\n      // @todo SUBCLASS ERROR?\n      const error = new Error(message) as any\n      error.details = err.details\n      error.response = err.response\n      error.responseBody = err.responseBody\n\n      throw error\n    }\n  },\n}\n\nasync function determineTargetDataset(target: string, context: CliCommandContext) {\n  const {apiClient, output, prompt} = context\n  const client = apiClient()\n\n  if (target) {\n    const dsError = validateDatasetName(target)\n    if (dsError) {\n      throw new Error(dsError)\n    }\n  }\n\n  debug('Fetching available datasets')\n  const spinner = output.spinner('Fetching available datasets').start()\n  const datasets = await client.datasets.list()\n  spinner.succeed('[100%] Fetching available datasets')\n\n  let targetDataset = target ? `${target}` : null\n  if (!targetDataset) {\n    targetDataset = await chooseDatasetPrompt(context, {\n      message: 'Select target dataset',\n      allowCreation: true,\n    })\n  } else if (!datasets.find((dataset) => dataset.name === targetDataset)) {\n    debug('Target dataset does not exist, prompting for creation')\n    const shouldCreate = await prompt.single({\n      type: 'confirm',\n      message: `Dataset \"${targetDataset}\" does not exist, would you like to create it?`,\n      default: true,\n    })\n\n    if (!shouldCreate) {\n      throw new Error(`Dataset \"${targetDataset}\" does not exist`)\n    }\n\n    await client.datasets.create(targetDataset)\n  }\n\n  return targetDataset\n}\n\nfunction getMutationOperation(flags: ParsedImportFlags) {\n  const {replace, missing} = flags\n  if (replace && missing) {\n    throw new Error('Cannot use both --replace and --missing')\n  }\n\n  if (flags.replace) {\n    return 'createOrReplace'\n  }\n\n  if (flags.missing) {\n    return 'createIfNotExists'\n  }\n\n  return 'create'\n}\n\nfunction getPercentage(opts: ProgressEvent) {\n  if (!opts.total || typeof opts.current === 'undefined') {\n    return ''\n  }\n\n  const percent = Math.floor((opts.current / opts.total) * 100)\n  return `[${padStart(`${percent}`, 3, ' ')}%] `\n}\n\nfunction getUrlStream(url: string) {\n  const request = getIt([promise({onlyBody: true})])\n  return request({url, stream: true})\n}\n\nfunction printWarnings(warnings: ImportWarning[], output: CliOutputter) {\n  const assetFails = warnings.filter((warn) => warn.type === 'asset')\n\n  if (!assetFails.length) {\n    return\n  }\n\n  const warn = (output.warn || output.print).bind(output)\n\n  warn(yellow('⚠ Failed to import the following %s:'), assetFails.length > 1 ? 'assets' : 'asset')\n\n  warnings.forEach((warning) => {\n    warn(`  ${warning.url}`)\n  })\n}\n\nexport default importDatasetCommand\n","import {type CliCommandAction} from '@sanity/cli'\n\nimport * as aliasClient from './datasetAliasesClient'\nimport {ALIAS_PREFIX} from './datasetAliasesClient'\n\nexport const listAliasesHandler: CliCommandAction = async (args, context) => {\n  const {apiClient, output} = context\n  const client = apiClient()\n\n  const aliases = await aliasClient.listAliases(client)\n  output.print(\n    aliases\n      .map((set) => `${ALIAS_PREFIX}${set.name} -> ${set.datasetName || '<unlinked>'}`)\n      .join('\\n'),\n  )\n}\n","import {type CliCommandDefinition} from '@sanity/cli'\n\nimport {listAliasesHandler} from './alias/listAliasesHandler'\n\nconst listDatasetsCommand: CliCommandDefinition = {\n  name: 'list',\n  group: 'dataset',\n  helpText: '',\n  signature: '',\n  description: 'List datasets of your project',\n  action: async (args, context) => {\n    const {apiClient, output} = context\n    const client = apiClient()\n    const datasets = await client.datasets.list()\n    output.print(datasets.map((set) => set.name).join('\\n'))\n\n    // Print alias list\n    await listAliasesHandler(args, context)\n  },\n}\n\nexport default listDatasetsCommand\n","import {\n  type CliCommandArguments,\n  type CliCommandContext,\n  type CliCommandDefinition,\n} from '@sanity/cli'\n\nimport {type DeployStudioActionFlags} from '../../actions/deploy/deployAction'\n\nconst helpText = `\nOptions\n  --source-maps Enable source maps for built bundles (increases size of bundle)\n  --no-minify Skip minifying built JavaScript (speeds up build, increases size of bundle)\n  --no-build Don't build the studio prior to deploy, instead deploying the version currently in \\`dist/\\`\n\nExamples\n  sanity deploy\n  sanity deploy --no-minify --source-maps\n`\n\nconst deployCommand: CliCommandDefinition = {\n  name: 'deploy',\n  signature: '[SOURCE_DIR] [--no-build]  [--source-maps] [--no-minify]',\n  description: 'Builds and deploys Sanity Studio to Sanity hosting',\n  action: async (\n    args: CliCommandArguments<DeployStudioActionFlags>,\n    context: CliCommandContext,\n  ) => {\n    const mod = await import('../../actions/deploy/deployAction')\n\n    return mod.default(args, context)\n  },\n  helpText,\n}\n\nexport default deployCommand\n","import {\n  type CliCommandArguments,\n  type CliCommandContext,\n  type CliCommandDefinition,\n} from '@sanity/cli'\n\nconst helpText = `\nExamples\n  sanity undeploy\n`\n\nconst undeployCommand: CliCommandDefinition = {\n  name: 'undeploy',\n  signature: '',\n  description: 'Removes the deployed Sanity Studio from Sanity hosting',\n  action: async (\n    args: CliCommandArguments<Record<string, unknown>>,\n    context: CliCommandContext,\n  ) => {\n    const mod = await import('../../actions/deploy/undeployAction')\n\n    return mod.default(args, context)\n  },\n  helpText,\n}\n\nexport default undeployCommand\n","import {\n  type CliCommandArguments,\n  type CliCommandContext,\n  type CliCommandDefinition,\n} from '@sanity/cli'\n\nimport {type StartDevServerCommandFlags} from '../../actions/dev/devAction'\n\nconst helpText = `\nNotes\n  Changing the hostname or port number might require a new entry to the CORS-origins allow list.\n\nOptions\n  --port <port> TCP port to start server on. [default: 3333]\n  --host <host> The local network interface at which to listen. [default: \"127.0.0.1\"]\n\nExamples\n  sanity dev --host=0.0.0.0\n  sanity dev --port=1942\n`\n\nconst devCommand: CliCommandDefinition = {\n  name: 'dev',\n  signature: '[--port <port>] [--host <host>]',\n  description: 'Starts a local dev server for Sanity Studio with live reloading',\n  action: async (\n    args: CliCommandArguments<StartDevServerCommandFlags>,\n    context: CliCommandContext,\n  ) => {\n    const devAction = await getDevAction()\n\n    return devAction(args, context)\n  },\n  helpText,\n}\n\nexport async function getDevAction(): Promise<\n  (\n    args: CliCommandArguments<StartDevServerCommandFlags>,\n    context: CliCommandContext,\n  ) => Promise<void>\n> {\n  // NOTE: in dev-mode we want to include from `src` so we need to use `.ts` extension\n  // NOTE: this `if` statement is not included in the output bundle\n  if (__DEV__) {\n    // eslint-disable-next-line import/extensions,@typescript-eslint/consistent-type-imports\n    const mod: typeof import('../../actions/dev/devAction') = require('../../actions/dev/devAction.ts')\n\n    return mod.default\n  }\n\n  const mod = await import('../../actions/dev/devAction')\n\n  return mod.default\n}\n\nexport default devCommand\n","import {type CliCommandDefinition} from '@sanity/cli'\nimport {\n  type IdentifiedSanityDocumentStub,\n  type MultipleMutationResult,\n  type Mutation,\n  type SanityClient,\n} from '@sanity/client'\nimport {uuid} from '@sanity/uuid'\nimport chokidar from 'chokidar'\nimport execa from 'execa'\nimport fs from 'fs/promises'\nimport json5 from 'json5'\nimport {isEqual, isPlainObject, noop} from 'lodash'\nimport os from 'os'\nimport path from 'path'\n\ntype MutationOperationName = 'create' | 'createOrReplace' | 'createIfNotExists'\n\ninterface CreateFlags {\n  dataset?: string\n  replace?: boolean\n  missing?: boolean\n  watch?: boolean\n  json5?: boolean\n  id?: string\n}\n\nconst helpText = `\nOptions\n  --replace On duplicate document IDs, replace existing document with specified document(s)\n  --missing On duplicate document IDs, don't modify the target document(s)\n  --watch   Write the documents whenever the target file or buffer changes\n  --json5   Use JSON5 file type to allow a \"simplified\" version of JSON\n  --id <id> Specify a document ID to use. Will fetch remote document ID and populate editor.\n  --dataset NAME to override dataset\n\nExamples\n  # Create the document specified in \"myDocument.json\".\n  sanity documents create myDocument.json\n\n  # Open configured $EDITOR and create the specified document(s)\n  sanity documents create\n\n  # Fetch document with the ID \"myDocId\" and open configured $EDITOR with the\n  # current document content (if any). Replace document with the edited version\n  # when the editor closes\n  sanity documents create --id myDocId --replace\n\n  # Open configured $EDITOR and replace the document with the given content\n  # on each save. Use JSON5 file extension and parser for simplified syntax.\n  sanity documents create --id myDocId --watch --replace --json5\n`\n\nconst createDocumentsCommand: CliCommandDefinition<CreateFlags> = {\n  name: 'create',\n  group: 'documents',\n  signature: '[FILE]',\n  helpText,\n  description: 'Create one or more documents',\n  // eslint-disable-next-line complexity\n  action: async (args, context) => {\n    const {apiClient, output} = context\n    const {replace, missing, watch, id, dataset} = args.extOptions\n    const [file] = args.argsWithoutOptions\n    const useJson5 = args.extOptions.json5\n    const client = dataset ? apiClient().clone().config({dataset}) : apiClient()\n\n    if (replace && missing) {\n      throw new Error('Cannot use both --replace and --missing')\n    }\n\n    if (id && file) {\n      throw new Error('Cannot use --id when specifying a file path')\n    }\n\n    let operation: MutationOperationName = 'create'\n    if (replace || missing) {\n      operation = replace ? 'createOrReplace' : 'createIfNotExists'\n    }\n\n    if (file) {\n      const contentPath = path.resolve(process.cwd(), file)\n      const content = json5.parse(await fs.readFile(contentPath, 'utf8'))\n      const result = await writeDocuments(content, operation, client)\n      output.print(getResultMessage(result, operation))\n      return\n    }\n\n    // Create a temporary file and use that as source, opening an editor on it\n    const docId = id || uuid()\n    const ext = useJson5 ? 'json5' : 'json'\n    const tmpFile = path.join(os.tmpdir(), 'sanity-cli', `${docId}.${ext}`)\n    const stringify = useJson5 ? json5.stringify : JSON.stringify\n    const defaultValue = (id && (await client.getDocument(id))) || {_id: docId, _type: 'specify-me'}\n    await fs.mkdir(path.join(os.tmpdir(), 'sanity-cli'), {recursive: true})\n    await fs.writeFile(tmpFile, stringify(defaultValue, null, 2), 'utf8')\n\n    const editor = getEditor()\n    if (watch) {\n      // If we're in watch mode, we want to run the creation on each change (if it validates)\n      registerUnlinkOnSigInt(tmpFile)\n      output.print(`Watch mode: ${tmpFile}`)\n      output.print('Watch mode: Will write documents on each save.')\n      output.print('Watch mode: Press Ctrl + C to cancel watch mode.')\n      chokidar.watch(tmpFile).on('change', () => {\n        output.print('')\n        return readAndPerformCreatesFromFile(tmpFile)\n      })\n      execa(editor.bin, editor.args.concat(tmpFile), {stdio: 'inherit'})\n    } else {\n      // While in normal mode, we just want to wait for the editor to close and run the thing once\n      execa.sync(editor.bin, editor.args.concat(tmpFile), {stdio: 'inherit'})\n      await readAndPerformCreatesFromFile(tmpFile)\n      await fs.unlink(tmpFile).catch(noop)\n    }\n\n    async function readAndPerformCreatesFromFile(filePath: string) {\n      let content\n      try {\n        content = json5.parse(await fs.readFile(filePath, 'utf8'))\n      } catch (err) {\n        output.error(`Failed to read input: ${err.message}`)\n        return\n      }\n\n      if (isEqual(content, defaultValue)) {\n        output.print('Value not modified, doing nothing.')\n        output.print('Modify document to trigger creation.')\n        return\n      }\n\n      try {\n        const writeResult = await writeDocuments(content, operation, client)\n        output.print(getResultMessage(writeResult, operation))\n      } catch (err) {\n        output.error(`Failed to write documents: ${err.message}`)\n        if (err.message.includes('already exists')) {\n          output.error('Perhaps you want to use `--replace` or `--missing`?')\n        }\n      }\n    }\n  },\n}\n\nfunction registerUnlinkOnSigInt(tmpFile: string) {\n  process.on('SIGINT', async () => {\n    await fs.unlink(tmpFile).catch(noop)\n    // eslint-disable-next-line no-process-exit\n    process.exit(130)\n  })\n}\n\nfunction writeDocuments(\n  documents: {_id?: string; _type: string} | {_id?: string; _type: string}[],\n  operation: MutationOperationName,\n  client: SanityClient,\n) {\n  const docs = Array.isArray(documents) ? documents : [documents]\n  if (docs.length === 0) {\n    throw new Error('No documents provided')\n  }\n\n  const mutations = docs.map((doc, index): Mutation => {\n    validateDocument(doc, index, docs)\n    if (operation === 'create') {\n      return {create: doc}\n    }\n\n    if (operation === 'createIfNotExists') {\n      if (isIdentifiedSanityDocument(doc)) {\n        return {createIfNotExists: doc}\n      }\n\n      throw new Error(`Missing required _id attribute for ${operation}`)\n    }\n\n    if (operation === 'createOrReplace') {\n      if (isIdentifiedSanityDocument(doc)) {\n        return {createOrReplace: doc}\n      }\n\n      throw new Error(`Missing required _id attribute for ${operation}`)\n    }\n\n    throw new Error(`Unsupported operation ${operation}`)\n  })\n\n  return client.transaction(mutations).commit()\n}\n\nfunction validateDocument(doc: unknown, index: number, arr: unknown[]) {\n  const isSingle = arr.length === 1\n\n  if (!isPlainObject(doc)) {\n    throw new Error(getErrorMessage('must be an object', index, isSingle))\n  }\n\n  if (!isSanityDocumentish(doc)) {\n    throw new Error(getErrorMessage('must have a `_type` property of type string', index, isSingle))\n  }\n}\n\nfunction isSanityDocumentish(doc: unknown): doc is {_type: string} {\n  return (\n    doc !== null &&\n    typeof doc === 'object' &&\n    '_type' in doc &&\n    typeof (doc as any)._type === 'string'\n  )\n}\n\nfunction isIdentifiedSanityDocument(doc: unknown): doc is IdentifiedSanityDocumentStub {\n  return isSanityDocumentish(doc) && '_id' in doc\n}\n\nfunction getErrorMessage(message: string, index: number, isSingle: boolean): string {\n  return isSingle ? `Document ${message}` : `Document at index ${index} ${message}`\n}\n\nfunction getResultMessage(\n  result: MultipleMutationResult,\n  operation: MutationOperationName,\n): string {\n  const joiner = '\\n  - '\n  if (operation === 'createOrReplace') {\n    return `Upserted:\\n  - ${result.results.map((res) => res.id).join(joiner)}`\n  }\n\n  if (operation === 'create') {\n    return `Created:\\n  - ${result.results.map((res) => res.id).join(joiner)}`\n  }\n\n  // \"Missing\" (createIfNotExists)\n  const created: string[] = []\n  const skipped: string[] = []\n  for (const res of result.results) {\n    if (res.operation === 'update') {\n      skipped.push(res.id)\n    } else {\n      created.push(res.id)\n    }\n  }\n\n  if (created.length > 0 && skipped.length > 0) {\n    return [\n      `Created:\\n  - ${created.join(joiner)}`,\n      `Skipped (already exists):${joiner}${skipped.join(joiner)}`,\n    ].join('\\n\\n')\n  } else if (created.length > 0) {\n    return `Created:\\n  - ${created.join(joiner)}`\n  }\n\n  return `Skipped (already exists):\\n  - ${skipped.join(joiner)}`\n}\n\nfunction getEditor() {\n  const defaultEditor = /^win/.test(process.platform) ? 'notepad' : 'vim'\n  // eslint-disable-next-line no-process-env\n  const editor = process.env.VISUAL || process.env.EDITOR || defaultEditor\n  const args = editor.split(/\\s+/)\n  const bin = args.shift() || ''\n  return {bin, args}\n}\n\nexport default createDocumentsCommand\n","import {type CliCommandDefinition} from '@sanity/cli'\nimport pluralize from 'pluralize-esm'\n\nconst helpText = `\nDelete a document from the projects configured dataset\n\nOptions\n  --dataset NAME to override dataset\n\nExample\n  # Delete the document with the ID \"myDocId\"\n  sanity documents delete myDocId\n\n  # ID wrapped in double or single quote works equally well\n  sanity documents delete 'myDocId'\n\n  # Delete document with ID \"someDocId\" from dataset \"blog\"\n  sanity documents delete --dataset=blog someDocId\n\n  # Delete the document with ID \"doc1\" and \"doc2\"\n  sanity documents delete doc1 doc2\n`\n\ninterface DeleteFlags {\n  dataset?: string\n}\n\nconst deleteDocumentsCommand: CliCommandDefinition<DeleteFlags> = {\n  name: 'delete',\n  group: 'documents',\n  signature: '[ID] [...IDS]',\n  helpText,\n  description: 'Delete a document by ID',\n  action: async (args, context) => {\n    const {apiClient, output, chalk} = context\n    const {dataset} = args.extOptions\n    const ids = args.argsWithoutOptions.map((str) => `${str}`)\n\n    if (!ids.length) {\n      throw new Error('Document ID must be specified')\n    }\n\n    const client = dataset ? apiClient().clone().config({dataset}) : apiClient()\n\n    const transaction = ids.reduce((trx, id) => trx.delete(id), client.transaction())\n    try {\n      const {results} = await transaction.commit()\n      const deleted = results.filter((res) => res.operation === 'delete').map((res) => res.id)\n      const notFound = ids.filter((id) => !deleted.includes(id))\n      if (deleted.length > 0) {\n        output.print(`Deleted ${deleted.length} ${pluralize('document', deleted.length)}`)\n      }\n\n      if (notFound.length > 0) {\n        output.error(\n          chalk.red(`${pluralize('Document', notFound.length)} not found: ${notFound.join(', ')}`),\n        )\n      }\n    } catch (err) {\n      throw new Error(`Failed to delete ${pluralize('document', ids.length)}:\\n${err.message}`)\n    }\n  },\n}\n\nexport default deleteDocumentsCommand\n","import {type CliCommandGroupDefinition} from '@sanity/cli'\n\nconst documentsGroup: CliCommandGroupDefinition = {\n  name: 'documents',\n  signature: '[COMMAND]',\n  isGroupRoot: true,\n  description: 'Manages documents in your Sanity Content Lake datasets',\n}\n\nexport default documentsGroup\n","import {type CliCommandContext} from '@sanity/cli'\nimport tokenize, {type LexerToken} from 'json-lexer'\n\ninterface KeyToken {\n  type: 'key'\n  value: string\n  raw: string\n}\n\ntype ExtendedLexerToken = LexerToken | KeyToken\n\nconst identity = (inp: string): string => inp\n\nexport function colorizeJson(input: unknown, chalk: CliCommandContext['chalk']): string {\n  const formatters: Record<ExtendedLexerToken['type'], (str: string) => string> = {\n    punctuator: chalk.white,\n    key: chalk.white,\n    string: chalk.green,\n    number: chalk.yellow,\n    literal: chalk.bold,\n    whitespace: identity,\n  }\n\n  const json = JSON.stringify(input, null, 2)\n\n  return tokenize(json)\n    .map((token, i, arr): ExtendedLexerToken => {\n      // Note how the following only works because we pretty-print the JSON\n      const prevToken = i === 0 ? token : arr[i - 1]\n      if (\n        token.type === 'string' &&\n        prevToken.type === 'whitespace' &&\n        /^\\n\\s+$/.test(prevToken.value)\n      ) {\n        return {...token, type: 'key'}\n      }\n\n      return token\n    })\n    .map((token) => {\n      const formatter = formatters[token.type] || identity\n      return formatter(token.raw)\n    })\n    .join('')\n}\n","import {type CliCommandDefinition} from '@sanity/cli'\n\nimport {colorizeJson} from '../../util/colorizeJson'\n\nconst helpText = `\nGet and print a document from the projects configured dataset\n\nOptions\n  --pretty colorized JSON output\n  --dataset NAME to override dataset\n\nExamples\n  # Get the document with the ID \"myDocId\"\n  sanity documents get myDocId\n\n  # ID wrapped in double or single quote works equally well\n  sanity documents get 'myDocId'\n`\n\ninterface GetDocumentFlags {\n  pretty?: boolean\n  dataset?: string\n}\n\nconst getDocumentsCommand: CliCommandDefinition<GetDocumentFlags> = {\n  name: 'get',\n  group: 'documents',\n  signature: '[DOCUMENT_ID]',\n  helpText,\n  description: 'Get and print a document by ID',\n  action: async (args, context) => {\n    const {apiClient, output, chalk} = context\n    const {pretty, dataset} = args.extOptions\n    const [docId] = args.argsWithoutOptions.map((str) => `${str}`)\n\n    if (!docId) {\n      throw new Error('Document ID must be specified')\n    }\n\n    const client = dataset ? apiClient().clone().config({dataset}) : apiClient()\n\n    try {\n      const doc = await client.getDocument(docId)\n      if (!doc) {\n        throw new Error(`Document ${docId} not found`)\n      }\n\n      output.print(pretty ? colorizeJson(doc, chalk) : JSON.stringify(doc, null, 2))\n    } catch (err) {\n      throw new Error(`Failed to fetch document:\\n${err.message}`)\n    }\n  },\n}\n\nexport default getDocumentsCommand\n","import {type CliCommandArguments, type CliCommandContext} from '@sanity/cli'\nimport {hideBin} from 'yargs/helpers'\nimport yargs from 'yargs/yargs'\n\nimport {colorizeJson} from '../../util/colorizeJson'\n\nconst defaultApiVersion = 'v2022-06-01'\n\nconst helpText = `\nRun a query against the projects configured dataset\n\nOptions\n  --pretty colorized JSON output\n  --dataset NAME to override dataset\n  --project PROJECT to override project ID\n  --anonymous Send the query without any authorization token\n  --api-version API version to use (defaults to \\`${defaultApiVersion}\\`)\n\nEnvironment variables\n  \\`SANITY_CLI_QUERY_API_VERSION\\` - will use the defined API version,\n  unless \\`--api-version\\` is specified.\n\nExamples\n  # Fetch 5 documents of type \"movie\"\n  sanity documents query '*[_type == \"movie\"][0..4]'\n\n  # Fetch title of the oldest movie in the dataset named \"staging\"\n  sanity documents query '*[_type == \"movie\"]|order(releaseDate asc)[0]{title}' --dataset staging\n\n  # Use API version v2021-06-07 and do a query\n  sanity documents query --api-version v2021-06-07 '*[_id == \"header\"] { \"headerText\": pt::text(body) }'\n`\n\ninterface CliQueryCommandFlags {\n  pretty?: boolean\n  anonymous?: boolean\n  dataset?: string\n  project?: string\n  apiVersion?: string\n}\n\nexport default {\n  name: 'query',\n  group: 'documents',\n  signature: '[QUERY]',\n  helpText,\n  description: 'Query for documents',\n  action: async (\n    args: CliCommandArguments<CliQueryCommandFlags>,\n    context: CliCommandContext,\n  ): Promise<void> => {\n    // Reparsing arguments for improved control of flags\n    const {\n      pretty,\n      dataset,\n      project,\n      anonymous,\n      'api-version': apiVersion,\n    } = await parseCliFlags(args)\n    const {apiClient, output, chalk, cliConfig} = context\n    const [query] = args.argsWithoutOptions\n\n    if (!query) {\n      throw new Error('Query must be specified')\n    }\n\n    if (!apiVersion) {\n      output.warn(chalk.yellow(`--api-version not specified, using \\`${defaultApiVersion}\\``))\n    }\n\n    const requireDataset = !dataset\n    const requireProject = !project\n    const requireUser = !anonymous\n\n    if (requireProject && !cliConfig?.api?.projectId) {\n      throw new Error(\n        'No project configured in CLI config - either configure one, or use `--project` flag',\n      )\n    }\n\n    if (requireDataset && !cliConfig?.api?.dataset) {\n      throw new Error(\n        'No dataset configured in CLI config - either configure one, or use `--dataset` flag',\n      )\n    }\n\n    const baseClient = apiClient({requireProject, requireUser}).clone()\n    const {dataset: originalDataset, projectId: originalProjectId} = baseClient.config()\n\n    const client = baseClient.config({\n      projectId: project || originalProjectId,\n      dataset: dataset || originalDataset,\n      apiVersion: apiVersion || defaultApiVersion,\n    })\n\n    try {\n      const docs = await client.fetch(query)\n      if (!docs) {\n        throw new Error('Query returned no results')\n      }\n\n      output.print(pretty ? colorizeJson(docs, chalk) : JSON.stringify(docs, null, 2))\n    } catch (err) {\n      throw new Error(`Failed to run query:\\n${err.message}`)\n    }\n  },\n}\n\nfunction parseCliFlags(args: CliCommandArguments<CliQueryCommandFlags>) {\n  // eslint-disable-next-line no-process-env\n  const fallbackApiVersion = process.env.SANITY_CLI_QUERY_API_VERSION\n  return yargs(hideBin(args.argv || process.argv).slice(2))\n    .option('pretty', {type: 'boolean', default: false})\n    .option('dataset', {type: 'string'})\n    .option('project', {type: 'string'})\n    .option('anonymous', {type: 'boolean', default: false})\n    .option('api-version', {type: 'string', default: fallbackApiVersion}).argv\n}\n","import {type CliCommandDefinition} from '@sanity/cli'\n\nconst description = `Downloads and validates all document specified in a workspace`\n\nconst helpText = `\nOptions\n  -y, --yes Skips the first confirmation prompt.\n  --workspace <name> The name of the workspace to use when downloading and validating all documents.\n  --dataset <name> Override the dataset used. By default, this is derived from the given workspace.\n  --file <filepath> Provide a path to either an .ndjson file or a tarball containing an .ndjson file.\n  --format <pretty|ndjson|json> The output format used to print the found validation markers and report progress.\n  --level <error|warning|info> The minimum level reported out. Defaults to warning.\n  --max-custom-validation-concurrency <number> Specify how many custom validators can run concurrently. Defaults to 5.\n\nExamples\n  # Validates all documents in a Sanity project with more than one workspace\n  sanity documents validate --workspace default\n\n  # Override the dataset specified in the workspace\n  sanity documents validate --workspace default --dataset staging\n\n  # Save the results of the report into a file\n  sanity documents validate > report.txt\n\n  # Report out info level validation markers too\n  sanity documents validate --level info\n`\n\nconst validateDocumentsCommand: CliCommandDefinition = {\n  name: 'validate',\n  group: 'documents',\n  signature: '',\n  description,\n  helpText,\n  action: async (args, context) => {\n    const mod = await import('../../actions/validation/validateAction')\n\n    return mod.default(args, context)\n  },\n} satisfies CliCommandDefinition\n\nexport default validateDocumentsCommand\n","import {type CliCommandDefinition} from '@sanity/cli'\n\nconst helpText = `\nOptions\n  --with-user-token Prime access token from CLI config into getCliClient()\n  --mock-browser-env Mocks a browser-like environment using jsdom\n\nExamples\n  # Run the script at some/script.js in Sanity context\n  sanity exec some/script.js\n\n  # Run the script at migrations/fullname.ts and configure \\`getCliClient()\\`\n  # from \\`sanity/cli\\`to include the current user's token\n  sanity exec migrations/fullname.ts --with-user-token\n\n  # Run the script at scripts/browserScript.js in a mock browser environment\n  sanity exec scripts/browserScript.js --mock-browser-env\n\n  # Pass arbitrary arguments to scripts by separating them with a \\`--\\`.\n  # Arguments are available in \\`process.argv\\` as they would in regular node scripts\n  # eg the following command would yield a \\`process.argv\\` of:\n  # ['/path/to/node', '/path/to/myscript.js', '--dry-run', 'positional-argument']\n  sanity exec --mock-browser-env myscript.js -- --dry-run positional-argument\n`\n\nexport const execCommand: CliCommandDefinition = {\n  name: 'exec',\n  signature: 'SCRIPT',\n  description: 'Executes a script within the Sanity Studio context',\n  helpText,\n  action: async (args, context) => {\n    const mod = await import('../../actions/exec/execScript')\n\n    return mod.default(args, context)\n  },\n}\n\nexport default execCommand\n","import {\n  type CliCommandArguments,\n  type CliCommandContext,\n  type CliCommandDefinition,\n} from '@sanity/cli'\n\nimport {type DeleteGraphQLApiFlags} from '../../actions/graphql/deleteApiAction'\n\nconst helpText = `\nOptions\n  --api <api-id> Undeploy API with this ID (project, dataset and tag flags takes preference)\n  --project <projectId> Project ID to delete GraphQL API for\n  --dataset <dataset> Delete GraphQL API for the given dataset\n  --tag <tag> Delete GraphQL API for the given tag (defaults to 'default')\n  --force Skip confirmation prompt, forcefully undeploying the GraphQL API\n\nExamples\n  sanity graphql undeploy\n  sanity graphql undeploy --api ios\n  sanity graphql undeploy --dataset staging\n  sanity graphql undeploy --dataset staging --tag next\n`\n\nconst deleteGraphQLAPICommand: CliCommandDefinition = {\n  name: 'undeploy',\n  group: 'graphql',\n  signature: '',\n  description: 'Remove a deployed GraphQL API',\n  action: async (args: CliCommandArguments<DeleteGraphQLApiFlags>, context: CliCommandContext) => {\n    const mod = await import('../../actions/graphql/deleteApiAction')\n\n    return mod.default(args, context)\n  },\n  helpText,\n}\n\nexport default deleteGraphQLAPICommand\n","import {type CliCommandContext, type CliCommandDefinition} from '@sanity/cli'\n\nconst helpText = `\nOptions\n  --dry-run Validate defined APIs, exiting with an error on breaking changes\n  --force Deploy API without confirming breaking changes\n  --api <api-id> Only deploy API with this ID. Can be specified multiple times.\n\nThe following options will override any setting from the CLI configuration file\n(sanity.cli.js/sanity.cli.ts) - and applies to ALL defined APIs defined in that\nconfiguration file. Tread with caution!\n\n  --tag Deploy API(s) to given tag (defaults to 'default')\n  --dataset <name> Deploy API for the given dataset\n  --generation <gen1|gen2|gen3> API generation to deploy (defaults to 'gen3')\n  --non-null-document-fields Use non-null document fields (_id, _type etc)\n  --playground Enable GraphQL playground for easier debugging\n  --no-playground Disable GraphQL playground\n  --with-union-cache *Experimental:* Enable union cache that optimizes schema generation for schemas with many self referencing types\n\nExamples\n  # Deploy all defined GraphQL APIs\n  sanity graphql deploy\n\n  # Validate defined GraphQL APIs, check for breaking changes, skip deploy\n  sanity graphql deploy --dry-run\n\n  # Deploy only the GraphQL APIs with the IDs \"staging\" and \"ios\"\n  sanity graphql deploy --api staging --api ios\n\n  # Deploy all defined GraphQL APIs, overriding any playground setting\n  sanity graphql deploy --playground\n`\n\nconst deployGraphQLAPICommand: CliCommandDefinition = {\n  name: 'deploy',\n  signature: '',\n  group: 'graphql',\n  description: 'Deploy a GraphQL API from the current Sanity schema',\n  action: async (args: {argv?: string[]}, context: CliCommandContext) => {\n    const mod = await import('../../actions/graphql/deployApiAction')\n\n    return mod.default(args, context)\n  },\n  helpText,\n}\n\nexport default deployGraphQLAPICommand\n","import {type CliCommandGroupDefinition} from '@sanity/cli'\n\nconst graphqlGroup: CliCommandGroupDefinition = {\n  name: 'graphql',\n  signature: '[COMMAND]',\n  isGroupRoot: true,\n  description: \"Deploys changes to your project's GraphQL API(s)\",\n}\n\nexport default graphqlGroup\n","import {\n  type CliCommandArguments,\n  type CliCommandContext,\n  type CliCommandDefinition,\n} from '@sanity/cli'\n\nconst helpText = `\nExamples\n  sanity graphql list\n`\n\nconst listGraphQLAPIsCommand: CliCommandDefinition = {\n  name: 'list',\n  signature: '',\n  group: 'graphql',\n  description: 'Lists all the GraphQL endpoints deployed for this project',\n  action: async (\n    args: CliCommandArguments<Record<string, unknown>>,\n    context: CliCommandContext,\n  ) => {\n    const mod = await import('../../actions/graphql/listApisAction')\n\n    return mod.default(args, context)\n  },\n  helpText,\n}\n\nexport default listGraphQLAPIsCommand\n","import {type CliCommandDefinition} from '@sanity/cli'\nimport open from 'open'\n\nconst createHookCommand: CliCommandDefinition = {\n  name: 'create',\n  group: 'hook',\n  signature: '',\n  helpText: '',\n  description: 'Create a new hook for the given dataset',\n  action: async (args, context) => {\n    const {apiClient, output} = context\n    const client = apiClient()\n\n    const {projectId} = client.config()\n    if (!projectId) {\n      throw new Error('No project ID found')\n    }\n\n    const projectInfo = (await client.projects.getById(projectId)) || {}\n    const organizationId = projectInfo.organizationId || 'personal'\n    const manageUrl = `https://www.sanity.io/organizations/${organizationId}/project/${projectId}/api/webhooks/new`\n\n    output.print(`Opening ${manageUrl}`)\n    open(manageUrl)\n  },\n}\n\nexport default createHookCommand\n","import {type CliCommandContext, type CliCommandDefinition} from '@sanity/cli'\n\nimport {type Hook} from './types'\n\nconst deleteHookCommand: CliCommandDefinition = {\n  name: 'delete',\n  group: 'hook',\n  signature: '[NAME]',\n  helpText: '',\n  description: 'Delete a hook within your project',\n  action: async (args, context) => {\n    const {apiClient} = context\n    const [name] = args.argsWithoutOptions\n    const client = apiClient()\n\n    const hookId = await promptForHook(name, context)\n    try {\n      await client\n        .clone()\n        .config({apiVersion: '2021-10-04'})\n        .request({method: 'DELETE', uri: `/hooks/${hookId}`})\n    } catch (err) {\n      throw new Error(`Hook deletion failed:\\n${err.message}`)\n    }\n  },\n}\n\nasync function promptForHook(specified: string | undefined, context: CliCommandContext) {\n  const specifiedName = specified && specified.toLowerCase()\n  const {prompt, apiClient} = context\n  const client = apiClient()\n\n  const hooks = await client\n    .clone()\n    .config({apiVersion: '2021-10-04'})\n    .request<Hook[]>({uri: '/hooks', json: true})\n\n  if (specifiedName) {\n    const selected = hooks.filter((hook) => hook.name.toLowerCase() === specifiedName)[0]\n    if (!selected) {\n      throw new Error(`Hook with name \"${specified} not found\"`)\n    }\n\n    return selected.id\n  }\n\n  const choices = hooks.map((hook) => ({value: hook.id, name: hook.name}))\n  return prompt.single({\n    message: 'Select hook to delete',\n    type: 'list',\n    choices,\n  })\n}\n\nexport default deleteHookCommand\n","import {type CliCommandGroupDefinition} from '@sanity/cli'\n\nconst hookGroup: CliCommandGroupDefinition = {\n  name: 'hook',\n  signature: '[COMMAND]',\n  isGroupRoot: true,\n  description: 'Sets up and manages webhooks within your Sanity project',\n}\n\nexport default hookGroup\n","import {type CliCommandDefinition} from '@sanity/cli'\n\nimport {type DeliveryAttempt} from './types'\n\nconst printHookAttemptCommand: CliCommandDefinition = {\n  name: 'attempt',\n  group: 'hook',\n  signature: 'ATTEMPT_ID',\n  helpText: '',\n  description: 'Print details of a given webhook delivery attempt',\n  action: async (args, context) => {\n    const {apiClient, output} = context\n    const [attemptId] = args.argsWithoutOptions\n    const client = apiClient()\n\n    let attempt\n    try {\n      attempt = await client.request<DeliveryAttempt>({uri: `/hooks/attempts/${attemptId}`})\n    } catch (err) {\n      throw new Error(`Hook attempt retrieval failed:\\n${err.message}`)\n    }\n\n    const {createdAt, resultCode, resultBody, failureReason, inProgress} = attempt\n\n    output.print(`Date: ${createdAt}`)\n    output.print(`Status: ${getStatus(attempt)}`)\n    output.print(`Status code: ${resultCode}`)\n\n    if (attempt.isFailure) {\n      output.print(`Failure: ${formatFailure(attempt)}`)\n    }\n\n    if (!inProgress && (!failureReason || failureReason === 'http')) {\n      const body = resultBody ? `\\n---\\n${resultBody}\\n---\\n` : '<empty>'\n      output.print(`Response body: ${body}`)\n    }\n  },\n}\n\nexport default printHookAttemptCommand\n\nexport function formatFailure(\n  attempt: DeliveryAttempt,\n  options: {includeHelp?: boolean} = {},\n): string {\n  const {includeHelp} = options\n  const {id, failureReason, resultCode} = attempt\n  const help = includeHelp ? `(run \\`sanity hook attempt ${id}\\` for details)` : ''\n  switch (failureReason) {\n    case 'http':\n      return `HTTP ${resultCode} ${help}`\n    case 'timeout':\n      return 'Request timed out'\n    case 'network':\n      return 'Network error'\n    case 'other':\n    default:\n  }\n\n  return 'Unknown error'\n}\n\nexport function getStatus(attempt: DeliveryAttempt): string {\n  if (attempt.isFailure) {\n    return 'Failed'\n  }\n\n  if (attempt.inProgress) {\n    return 'In progress'\n  }\n\n  return 'Delivered'\n}\n","import {type CliCommandContext, type CliCommandDefinition} from '@sanity/cli'\nimport {groupBy} from 'lodash'\nimport {inspect} from 'util'\n\nimport {formatFailure} from './printHookAttemptCommand'\nimport {type DeliveryAttempt, type Hook, type HookMessage} from './types'\n\ninterface ListHookFlags {\n  detailed?: boolean\n}\n\nconst listHookLogsCommand: CliCommandDefinition<ListHookFlags> = {\n  name: 'logs',\n  group: 'hook',\n  signature: '[NAME]',\n  helpText: '',\n  description: 'List latest log entries for a given hook',\n  action: async (args, context) => {\n    const {apiClient} = context\n    const flags = args.extOptions\n    const [name] = args.argsWithoutOptions\n    const client = apiClient()\n\n    const hookId = await promptForHook(name, context)\n    let messages\n    let attempts\n    try {\n      messages = await client.request<HookMessage[]>({uri: `/hooks/${hookId}/messages`})\n      attempts = await client.request<DeliveryAttempt[]>({uri: `/hooks/${hookId}/attempts`})\n    } catch (err) {\n      throw new Error(`Hook logs retrieval failed:\\n${err.message}`)\n    }\n\n    const groupedAttempts = groupBy(attempts, 'messageId')\n    const populated = messages.map((msg): HookMessage & {attempts: DeliveryAttempt[]} => ({\n      ...msg,\n      attempts: groupedAttempts[msg.id],\n    }))\n\n    const totalMessages = messages.length - 1\n    populated.forEach((message, i) => {\n      printMessage(message, context, {detailed: flags.detailed})\n      printSeparator(context, totalMessages === i)\n    })\n  },\n}\n\nexport default listHookLogsCommand\n\nasync function promptForHook(specified: string | undefined, context: CliCommandContext) {\n  const specifiedName = specified && specified.toLowerCase()\n  const {prompt, apiClient} = context\n  const client = apiClient()\n\n  const hooks = await client\n    .clone()\n    .config({apiVersion: '2021-10-04'})\n    .request<Hook[]>({uri: '/hooks', json: true})\n\n  if (specifiedName) {\n    const selected = hooks.filter((hook) => hook.name.toLowerCase() === specifiedName)[0]\n    if (!selected) {\n      throw new Error(`Hook with name \"${specified} not found\"`)\n    }\n\n    return selected.id\n  }\n\n  if (hooks.length === 0) {\n    throw new Error('No hooks currently registered')\n  }\n\n  if (hooks.length === 1) {\n    return hooks[0].id\n  }\n\n  const choices = hooks.map((hook) => ({value: hook.id, name: hook.name}))\n  return prompt.single({\n    message: 'Select hook to list logs for',\n    type: 'list',\n    choices,\n  })\n}\n\nfunction printSeparator(context: CliCommandContext, skip: boolean) {\n  if (!skip) {\n    context.output.print('---\\n')\n  }\n}\n\nfunction printMessage(\n  message: HookMessage & {attempts: DeliveryAttempt[]},\n  context: CliCommandContext,\n  options: {detailed?: boolean},\n) {\n  const {detailed} = options\n  const {output, chalk} = context\n\n  output.print(`Date: ${message.createdAt}`)\n  output.print(`Status: ${message.status}`)\n  output.print(`Result code: ${message.resultCode}`)\n\n  if (message.failureCount > 0) {\n    output.print(`Failures: ${message.failureCount}`)\n  }\n\n  if (detailed) {\n    output.print('Payload:')\n    output.print(inspect(JSON.parse(message.payload), {colors: true}))\n  }\n\n  if (detailed && message.attempts) {\n    output.print('Attempts:')\n    message.attempts.forEach((attempt) => {\n      const date = attempt.createdAt.replace(/\\.\\d+Z$/, 'Z')\n      const prefix = `  [${date}]`\n\n      if (attempt.inProgress) {\n        output.print(`${prefix} ${chalk.yellow('Pending')}`)\n      } else if (attempt.isFailure) {\n        const failure = formatFailure(attempt, {includeHelp: true})\n        output.print(`${prefix} ${chalk.yellow(`Failure: ${failure}`)}`)\n      } else {\n        output.print(`${prefix} Success: HTTP ${attempt.resultCode} (${attempt.duration}ms)`)\n      }\n    })\n  }\n\n  // Leave some empty space between messages\n  output.print('')\n}\n","import {type CliCommandDefinition} from '@sanity/cli'\n\nimport {type Hook} from './types'\n\nconst listHooksCommand: CliCommandDefinition = {\n  name: 'list',\n  group: 'hook',\n  signature: '',\n  helpText: '',\n  description: 'List hooks for a given project',\n  action: async (args, context) => {\n    const {apiClient, output} = context\n    const client = apiClient()\n\n    let hooks\n    try {\n      hooks = await client\n        .clone()\n        .config({apiVersion: '2021-10-04'})\n        .request<Hook[]>({uri: '/hooks'})\n    } catch (err) {\n      throw new Error(`Hook list retrieval failed:\\n${err.message}`)\n    }\n\n    hooks.forEach((hook) => {\n      output.print(`Name: ${hook.name}`)\n      output.print(`Dataset: ${hook.dataset}`)\n      output.print(`URL: ${hook.url}`)\n\n      if (hook.type === 'document') {\n        output.print(`HTTP method: ${hook.httpMethod}`)\n\n        if (hook.description) {\n          output.print(`Description: ${hook.description}`)\n        }\n      }\n\n      output.print('')\n    })\n  },\n}\n\nexport default listHooksCommand\n","export const MIGRATIONS_DIRECTORY = 'migrations'\nexport const MIGRATION_SCRIPT_EXTENSIONS = ['mjs', 'js', 'ts', 'cjs']\n","export const minimalAdvanced = ({\n  migrationName,\n  documentTypes,\n}: {\n  migrationName: string\n  documentTypes: string[]\n}) => `import {defineMigration, patch, at, setIfMissing} from 'sanity/migrate'\n\n/**\n * this migration will set \\`Default title\\` on all documents that are missing a title\n * and make \\`true\\` the default value for the \\`enabled\\` field\n */\nexport default defineMigration({\n  title: '${migrationName}',\n${\n  documentTypes.length > 0\n    ? `  documentTypes: [${documentTypes.map((t) => JSON.stringify(t)).join(', ')}],\\n`\n    : ''\n}\n  async *migrate(documents, context) {\n    for await (const document of documents()) {\n      yield patch(document._id, [\n        at('title', setIfMissing('Default title')),\n        at('enabled', setIfMissing(true)),\n      ])\n    }\n  }\n})\n`\n","export const minimalSimple = ({\n  migrationName,\n  documentTypes,\n}: {\n  migrationName: string\n  documentTypes: string[]\n}) => `import {at, defineMigration, setIfMissing, unset} from 'sanity/migrate'\n\nexport default defineMigration({\n  title: '${migrationName}',\n${\n  documentTypes.length > 0\n    ? `  documentTypes: [${documentTypes.map((t) => JSON.stringify(t)).join(', ')}],\\n`\n    : ''\n}\n  migrate: {\n    document(doc, context) {\n      // this will be called for every document of the matching type\n      // any patch returned will be applied to the document\n      // you can also return mutations that touches other documents\n\n      return at('title', setIfMissing('Default title'))\n    },\n    node(node, path, context) {\n      // this will be called for every node in every document of the matching type\n      // any patch returned will be applied to the document\n      // you can also return mutations that touches other documents\n\n      if (typeof node === 'string' && node === 'deleteme') {\n        return unset()\n      }\n    },\n    object(node, path, context) {\n      // this will be called for every object node in every document of the matching type\n      // any patch returned will be applied to the document\n      // you can also return mutations that touches other documents\n      if (node._type === 'author') {\n        // make sure all authors objects have a books array\n        return at('books', setIfMissing([]))\n      }\n    },\n    array(node, path, context) {\n      // this will be called for every array node in every document of the matching type\n      // any patch returned will be applied to the document\n      // you can also return mutations that touches other documents\n    },\n    string(node, path, context) {\n      // this will be called for every string node in every document of the matching type\n      // any patch returned will be applied to the document\n      // you can also return mutations that touches other documents\n    },\n    number(node, path, context) {\n      // this will be called for every number node in every document of the matching type\n      // any patch returned will be applied to the document\n      // you can also return mutations that touches other documents\n    },\n    boolean(node, path, context) {\n      // this will be called for every boolean node in every document of the matching type\n      // any patch returned will be applied to the document\n      // you can also return mutations that touches other documents\n    },\n    null(node, path, context) {\n      // this will be called for every null node in every document of the matching type\n      // any patch returned will be applied to the document\n      // you can also return mutations that touches other documents\n    },\n  },\n})\n`\n","export const renameField = ({\n  migrationName,\n  documentTypes,\n}: {\n  migrationName: string\n  documentTypes: string[]\n}) => `import {defineMigration, at, setIfMissing, unset} from 'sanity/migrate'\n\nconst from = 'oldFieldName'\nconst to = 'newFieldName'\n\nexport default defineMigration({\n  title: '${migrationName}',\n${\n  documentTypes.length > 0\n    ? `  documentTypes: [${documentTypes.map((t) => JSON.stringify(t)).join(', ')}],\\n`\n    : ''\n}\n  migrate: {\n    document(doc, context) {\n      return [\n        at(to, setIfMissing(doc[from])),\n        at(from, unset())\n      ]\n    }\n  }\n})\n`\n","export const renameType = ({\n  migrationName,\n  documentTypes,\n}: {\n  migrationName: string\n  documentTypes: string[]\n}) => `import {defineMigration, at, set} from 'sanity/migrate'\n\nconst oldType = 'old'\nconst newType = 'new'\n\nexport default defineMigration({\n  title: '${migrationName}',\n${\n  documentTypes.length > 0\n    ? `  documentTypes: [${documentTypes.map((t) => JSON.stringify(t)).join(', ')}],\\n`\n    : ''\n}\n  migrate: {\n    object(object, path, context) {\n      if (object._type === oldType) {\n        return at('_type', set(newType))\n      }\n    }\n  }\n})\n`\n","export const stringToPTE = ({\n  migrationName,\n  documentTypes,\n}: {\n  migrationName: string\n  documentTypes: string[]\n}) => `import {pathsAreEqual, stringToPath} from 'sanity'\nimport {defineMigration, set} from 'sanity/migrate'\n\nconst targetPath = stringToPath('some.path')\n\nexport default defineMigration({\n  title: '${migrationName}',\n${\n  documentTypes.length > 0\n    ? `  documentTypes: [${documentTypes.map((t) => JSON.stringify(t)).join(', ')}],\\n`\n    : ''\n}\n  migrate: {\n    string(node, path, ctx) {\n      if (pathsAreEqual(path, targetPath)) {\n        return set([\n          {\n            style: 'normal',\n            _type: 'block',\n            children: [\n              {\n                _type: 'span',\n                marks: [],\n                text: node,\n              },\n            ],\n            markDefs: [],\n          },\n        ])\n      }\n    },\n  },\n})\n`\n","import {existsSync, mkdirSync} from 'node:fs'\nimport {writeFile} from 'node:fs/promises'\nimport path from 'node:path'\n\nimport {type CliCommandDefinition} from '@sanity/cli'\nimport deburr from 'lodash/deburr'\n\nimport {MIGRATIONS_DIRECTORY} from './constants'\nimport {minimalAdvanced} from './templates/minimalAdvanced'\nimport {minimalSimple} from './templates/minimalSimple'\nimport {renameField} from './templates/renameField'\nimport {renameType} from './templates/renameType'\nimport {stringToPTE} from './templates/stringToPTE'\n\nconst helpText = `\nExamples:\n  # Create a new migration, prompting for title and options\n  sanity migration create\n\n  # Create a new migration with the provided title, prompting for options\n  sanity migration create \"Rename field from location to address\"\n`\n\n// eslint-disable-next-line @typescript-eslint/no-empty-interface\ninterface CreateMigrationFlags {}\n\nconst TEMPLATES = [\n  {name: 'Minimalistic migration to get you started', template: minimalSimple},\n  {name: 'Rename an object type', template: renameType},\n  {name: 'Rename a field', template: renameField},\n  {name: 'Convert string field to Portable Text', template: stringToPTE},\n  {\n    name: 'Advanced template using async iterators providing more fine grained control',\n    template: minimalAdvanced,\n  },\n]\n\nconst createMigrationCommand: CliCommandDefinition<CreateMigrationFlags> = {\n  name: 'create',\n  group: 'migration',\n  signature: '[TITLE]',\n  helpText,\n  description: 'Create a new migration within your project',\n  action: async (args, context) => {\n    const {output, prompt, workDir, chalk} = context\n\n    let [title] = args.argsWithoutOptions\n\n    while (!title?.trim()) {\n      title = await prompt.single({\n        type: 'input',\n        suffix: ' (e.g. \"Rename field from location to address\")',\n        message: 'Title of migration',\n      })\n      if (!title.trim()) {\n        output.error(chalk.red('Name cannot be empty'))\n      }\n    }\n    const types = await prompt.single({\n      type: 'input',\n      suffix: ' (optional)',\n      message: 'Type of documents to migrate. You can add multiple types separated by comma',\n    })\n\n    const templatesByName = Object.fromEntries(TEMPLATES.map((t) => [t.name, t]))\n    const template = await prompt.single({\n      type: 'list',\n      message: 'Select a template',\n      choices: TEMPLATES.map((definedTemplate) => ({\n        name: definedTemplate.name,\n        value: definedTemplate.name,\n      })),\n    })\n\n    const sluggedName = deburr(title.toLowerCase())\n      .replace(/\\s+/g, '-')\n      .replace(/[^a-z0-9-]/g, '')\n\n    const destDir = path.join(MIGRATIONS_DIRECTORY, sluggedName)\n    if (existsSync(destDir)) {\n      if (\n        !(await prompt.single({\n          type: 'confirm',\n          message: `Migration directory ./${destDir} already exists. Overwrite?`,\n          default: false,\n        }))\n      ) {\n        return\n      }\n    }\n    mkdirSync(destDir, {recursive: true})\n\n    const renderedTemplate = (templatesByName[template].template || minimalSimple)({\n      migrationName: title,\n      documentTypes: types\n        .split(',')\n        .map((t) => t.trim())\n        .filter(Boolean),\n    })\n\n    const definitionFile = path.join(destDir, 'index.ts')\n\n    await writeFile(path.join(workDir, definitionFile), renderedTemplate)\n    // To dry run it, run \\`sanity migration run ${sluggedName}\\``)\n    output.print()\n    output.print(`${chalk.green('✓')} Migration created!`)\n    output.print()\n    output.print('Next steps:')\n    output.print(\n      `Open ./${chalk.bold(\n        definitionFile,\n      )} in your code editor and write the code for your migration.`,\n    )\n    output.print(\n      `Dry run the migration with:\\n\\`${chalk.bold(\n        `sanity migration run ${sluggedName} --project=<projectId> --dataset <dataset> `,\n      )}\\``,\n    )\n    output.print(\n      `Run the migration against a dataset with:\\n \\`${chalk.bold(\n        `sanity migration run ${sluggedName} --project=<projectId> --dataset <dataset> --no-dry-run`,\n      )}\\``,\n    )\n    output.print()\n    output.print(\n      `👉 Learn more about schema and content migrations at ${chalk.bold(\n        'https://www.sanity.io/docs/schema-and-content-migrations',\n      )}`,\n    )\n  },\n}\nexport default createMigrationCommand\n","import path from 'node:path'\n\nimport {type Migration} from '@sanity/migrate'\nimport {isPlainObject} from 'lodash'\n\nimport {MIGRATION_SCRIPT_EXTENSIONS, MIGRATIONS_DIRECTORY} from '../constants'\n\ninterface ResolvedMigrationScript {\n  /**\n   * Relative path from the working directory to the migration script\n   */\n  relativePath: string\n\n  /**\n   * Absolute path to the migration script\n   */\n  absolutePath: string\n\n  /**\n   * The migration module, if it could be resolved - otherwise `undefined`\n   */\n  mod?: {default: Migration; up?: unknown; down?: unknown}\n}\n\n/**\n * Resolves the potential paths to a migration script.\n * Considers the following paths (where `<ext>` is 'mjs', 'js', 'ts' or 'cjs'):\n *\n * - `<migrationsDir>/<migrationName>.<ext>`\n * - `<migrationsDir>/<migrationName>/index.<ext>`\n *\n * Note that all possible paths are returned, even if the files do not exist.\n * Check the `mod` property to see if a module could actually be loaded.\n *\n * @param workDir - Working directory of the studio\n * @param migrationName - The name of the migration directory to resolve\n * @returns An array of potential migration scripts\n * @internal\n */\nexport function resolveMigrationScript(\n  workDir: string,\n  migrationName: string,\n): ResolvedMigrationScript[] {\n  return [migrationName, path.join(migrationName, 'index')].flatMap((location) =>\n    MIGRATION_SCRIPT_EXTENSIONS.map((ext) => {\n      const relativePath = path.join(MIGRATIONS_DIRECTORY, `${location}.${ext}`)\n      const absolutePath = path.resolve(workDir, relativePath)\n      let mod\n      try {\n        // eslint-disable-next-line import/no-dynamic-require\n        mod = require(absolutePath)\n      } catch (err) {\n        if (err.code !== 'MODULE_NOT_FOUND') {\n          throw new Error(`Error: ${err.message}\"`)\n        }\n      }\n      return {relativePath, absolutePath, mod}\n    }),\n  )\n}\n\n/**\n * Checks whether or not the passed resolved migration script is actually loadable (eg has a default export)\n *\n * @param script - The resolved migration script to check\n * @returns `true` if the script is loadable, `false` otherwise\n * @internal\n */\nexport function isLoadableMigrationScript(\n  script: ResolvedMigrationScript,\n): script is Required<ResolvedMigrationScript> {\n  if (typeof script.mod === 'undefined' || !isPlainObject(script.mod.default)) {\n    return false\n  }\n\n  const mod = script.mod.default\n  return typeof mod.title === 'string' && mod.migrate !== undefined\n}\n","import {readdir} from 'node:fs/promises'\nimport path from 'node:path'\n\nimport {type CliCommandDefinition} from '@sanity/cli'\nimport {type Migration} from '@sanity/migrate'\nimport {Table} from 'console-table-printer'\nimport {register} from 'esbuild-register/dist/node'\n\nimport {MIGRATION_SCRIPT_EXTENSIONS, MIGRATIONS_DIRECTORY} from './constants'\nimport {isLoadableMigrationScript, resolveMigrationScript} from './utils/resolveMigrationScript'\n\nconst helpText = ``\n\nconst listMigrationCommand: CliCommandDefinition = {\n  name: 'list',\n  group: 'migration',\n  signature: '',\n  helpText,\n  description: 'List available migrations',\n  action: async (_, context) => {\n    const {workDir, output, chalk} = context\n    try {\n      const migrations = await resolveMigrations(workDir)\n\n      if (migrations.length === 0) {\n        output.print('No migrations found in migrations folder of the project')\n        output.print(\n          `\\nRun ${chalk.green(`\\`sanity migration create <NAME>\\``)} to create a new migration`,\n        )\n        return\n      }\n\n      const table = new Table({\n        title: `Found ${migrations.length} migrations in project`,\n        columns: [\n          {name: 'id', title: 'ID', alignment: 'left'},\n          {name: 'title', title: 'Title', alignment: 'left'},\n        ],\n      })\n\n      migrations.forEach((definedMigration) => {\n        table.addRow({id: definedMigration.id, title: definedMigration.migration.title})\n      })\n      table.printTable()\n      output.print('\\nRun `sanity migration run <ID>` to run a migration')\n    } catch (error) {\n      if (error.code === 'ENOENT') {\n        output.print('No migrations folder found in the project')\n        output.print(\n          `\\nRun ${chalk.green(`\\`sanity migration create <NAME>\\``)} to create a new migration`,\n        )\n        return\n      }\n      throw new Error(`An error occurred while listing migrations: ${error.message}`)\n    }\n  },\n}\n\n/**\n * A resolved migration, where you are guaranteed that the migration file exists\n *\n * @internal\n */\nexport interface ResolvedMigration {\n  id: string\n  migration: Migration\n}\n\n/**\n * Resolves all migrations in the studio working directory\n *\n * @param workDir - The studio working directory\n * @returns Array of migrations and their respective paths\n * @internal\n */\nexport async function resolveMigrations(workDir: string): Promise<ResolvedMigration[]> {\n  let unregister\n  if (!__DEV__) {\n    unregister = register({\n      target: `node${process.version.slice(1)}`,\n    }).unregister\n  }\n\n  const migrationsDir = path.join(workDir, MIGRATIONS_DIRECTORY)\n  const migrationEntries = await readdir(migrationsDir, {withFileTypes: true})\n\n  const migrations: ResolvedMigration[] = []\n  for (const entry of migrationEntries) {\n    const entryName = entry.isDirectory() ? entry.name : removeMigrationScriptExtension(entry.name)\n    const candidates = resolveMigrationScript(workDir, entryName).filter(isLoadableMigrationScript)\n\n    for (const candidate of candidates) {\n      migrations.push({\n        id: entryName,\n        migration: candidate.mod.default,\n      })\n    }\n  }\n\n  if (unregister) {\n    unregister()\n  }\n\n  return migrations\n}\n\nfunction removeMigrationScriptExtension(fileName: string) {\n  // Remove `.ts`, `.js` etc from the end of a filename\n  return MIGRATION_SCRIPT_EXTENSIONS.reduce(\n    (name, ext) => (name.endsWith(`.${ext}`) ? path.basename(name, `.${ext}`) : name),\n    fileName,\n  )\n}\n\nexport default listMigrationCommand\n","export default {\n  name: 'migration',\n  signature: '[COMMAND]',\n  isGroupRoot: true,\n  description: 'Manages content migrations for Content Lake datasets',\n}\n","import {type Path, pathToString} from 'sanity'\n\ninterface BaseNode {\n  path: Path\n}\n\nexport interface Tree<Node extends BaseNode> {\n  nodes?: Node[]\n  children?: Record<string, Tree<Node>>\n}\n\n/**\n * Recursively calculates the max length of all the keys in the given validation\n * tree respecting extra length due to indentation depth. Used to calculate the\n * padding for the rest of the tree.\n */\nexport const maxKeyLength = (children: Record<string, Tree<BaseNode>> = {}, depth = 0): number => {\n  return Object.entries(children)\n    .map(([key, child]) =>\n      Math.max(key.length + depth * 2, maxKeyLength(child.children, depth + 1)),\n    )\n    .reduce((max, next) => (next > max ? next : max), 0)\n}\n\ninterface Options<Node extends BaseNode> {\n  node?: Record<string, Tree<Node>>\n  paddingLength: number\n  indent?: string\n  getNodes?: (node: Tree<Node>) => Node[] | undefined\n  getMessage: (node: Node) => string\n}\n\n/**\n * Recursively formats a given tree into a printed user-friendly tree structure\n */\nexport const formatTree = <Node extends BaseNode>({\n  node = {},\n  paddingLength,\n  indent = '',\n  getNodes: getLeaves = ({nodes}) => nodes,\n  getMessage,\n}: Options<Node>): string => {\n  const entries = Object.entries(node)\n\n  return entries\n    .map(([key, child], index) => {\n      const isLast = index === entries.length - 1\n      const nextIndent = `${indent}${isLast ? '  ' : '│ '}`\n      const leaves = getLeaves(child)\n\n      const nested = formatTree({\n        node: child.children,\n        paddingLength,\n        indent: nextIndent,\n        getNodes: getLeaves,\n        getMessage,\n      })\n\n      if (!leaves?.length) {\n        const current = `${indent}${isLast ? '└' : '├'}─ ${key}`\n        return [current, nested].filter(Boolean).join('\\n')\n      }\n\n      const [first, ...rest] = leaves\n      const firstPadding = '.'.repeat(paddingLength - indent.length - key.length)\n      const elbow = isLast ? '└' : '├'\n      const subsequentPadding = ' '.repeat(paddingLength - indent.length + 2)\n\n      const firstMessage = `${indent}${elbow}─ ${key} ${firstPadding} ${getMessage(first)}`\n      const subsequentMessages = rest\n        .map((marker) => `${nextIndent}${subsequentPadding} ${getMessage(marker)}`)\n        .join('\\n')\n\n      const current = [firstMessage, subsequentMessages].filter(Boolean).join('\\n')\n      return [current, nested].filter(Boolean).join('\\n')\n    })\n    .join('\\n')\n}\n\n/**\n * Converts a set of markers with paths into a tree of markers where the paths\n * are embedded in the tree\n */\nexport function convertToTree<const Node extends BaseNode>(nodes: Node[]): Tree<Node> {\n  const root: Tree<Node> = {}\n\n  // add the markers to the tree\n  function addNode(node: Node, tree: Tree<Node> = root) {\n    // if we've traversed the whole path\n    if (!node.path.length) {\n      if (!tree.nodes) tree.nodes = [] // ensure markers is defined\n\n      // then add the marker to the front\n      tree.nodes.push(node)\n      return\n    }\n\n    const [current, ...rest] = node.path\n    const key = pathToString([current])\n\n    // ensure the current node has children and the next node\n    if (!tree.children) tree.children = {}\n    if (!(key in tree.children)) tree.children[key] = {}\n\n    addNode({...node, path: rest}, tree.children[key])\n  }\n\n  for (const node of nodes) addNode(node)\n  return root\n}\n","import {isatty} from 'node:tty'\n\nimport {type Migration, type Mutation, type NodePatch, type Transaction} from '@sanity/migrate'\nimport {type KeyedSegment} from '@sanity/types'\nimport {type Chalk} from 'chalk'\n\nimport {convertToTree, formatTree, maxKeyLength} from '../../util/tree'\n\ntype ItemRef = string | number\ntype Impact = 'destructive' | 'maybeDestructive' | 'incremental'\ntype Variant = Impact | 'info'\n\nconst isTty = isatty(1)\n\ninterface FormatterOptions<Subject> {\n  chalk: Chalk\n  subject: Subject\n  migration: Migration\n  indentSize?: number\n}\n\nexport function prettyFormat({\n  chalk,\n  subject,\n  migration,\n  indentSize = 0,\n}: FormatterOptions<Mutation | Transaction | (Mutation | Transaction)[]>): string {\n  return (Array.isArray(subject) ? subject : [subject])\n    .map((subjectEntry) => {\n      if (subjectEntry.type === 'transaction') {\n        return [\n          [\n            badge('transaction', 'info', chalk),\n            typeof subjectEntry.id === 'undefined' ? null : chalk.underline(subjectEntry.id),\n          ]\n            .filter(Boolean)\n            .join(' '),\n          indent(\n            prettyFormat({\n              chalk,\n              subject: subjectEntry.mutations,\n              migration,\n              indentSize: indentSize,\n            }),\n          ),\n        ].join('\\n\\n')\n      }\n      return prettyFormatMutation({\n        chalk,\n        subject: subjectEntry,\n        migration,\n        indentSize,\n      })\n    })\n    .join('\\n\\n')\n}\n\nfunction encodeItemRef(ref: number | KeyedSegment): ItemRef {\n  return typeof ref === 'number' ? ref : ref._key\n}\n\nfunction badgeStyle(chalk: Chalk, variant: Variant): Chalk {\n  const styles: Record<Variant, Chalk> = {\n    info: chalk.bgWhite.black,\n    incremental: chalk.bgGreen.black.bold,\n    maybeDestructive: chalk.bgYellow.black.bold,\n    destructive: chalk.bgRed.black.bold,\n  }\n\n  return styles[variant]\n}\n\nfunction badge(label: string, variant: Variant, chalk: Chalk): string {\n  if (!isTty) {\n    return `[${label}]`\n  }\n\n  return badgeStyle(chalk, variant)(` ${label} `)\n}\n\nconst mutationImpact: Record<Mutation['type'], Impact> = {\n  create: 'incremental',\n  createIfNotExists: 'incremental',\n  createOrReplace: 'maybeDestructive',\n  delete: 'destructive',\n  patch: 'maybeDestructive',\n}\n\nfunction documentId(mutation: Mutation): string | undefined {\n  if ('id' in mutation) {\n    return mutation.id\n  }\n\n  if ('document' in mutation) {\n    return mutation.document._id\n  }\n\n  return undefined\n}\n\nconst listFormatter = new Intl.ListFormat('en-US', {\n  type: 'disjunction',\n})\n\nfunction mutationHeader(chalk: Chalk, mutation: Mutation, migration: Migration): string {\n  const mutationType = badge(mutation.type, mutationImpact[mutation.type], chalk)\n\n  const documentType =\n    'document' in mutation || migration.documentTypes\n      ? badge(\n          'document' in mutation\n            ? mutation.document._type\n            : listFormatter.format(migration.documentTypes ?? []),\n          'info',\n          chalk,\n        )\n      : null\n\n  // TODO: Should we list documentType when a mutation can be yielded for any document type?\n  return [mutationType, documentType, chalk.underline(documentId(mutation))]\n    .filter(Boolean)\n    .join(' ')\n}\n\nexport function prettyFormatMutation({\n  chalk,\n  subject,\n  migration,\n  indentSize = 0,\n}: FormatterOptions<Mutation>): string {\n  const lock =\n    'options' in subject ? chalk.cyan(`(if revision==${subject.options?.ifRevision})`) : ''\n  const header = [mutationHeader(chalk, subject, migration), lock].join(' ')\n  const padding = ' '.repeat(indentSize)\n\n  if (\n    subject.type === 'create' ||\n    subject.type === 'createIfNotExists' ||\n    subject.type === 'createOrReplace'\n  ) {\n    return [header, '\\n', indent(JSON.stringify(subject.document, null, 2), indentSize)].join('')\n  }\n\n  if (subject.type === 'patch') {\n    const tree = convertToTree<NodePatch>(subject.patches.flat())\n    const paddingLength = Math.max(maxKeyLength(tree.children) + 2, 30)\n\n    return [\n      header,\n      '\\n',\n      formatTree<NodePatch>({\n        node: tree.children,\n        paddingLength,\n        indent: padding,\n        getMessage: (patch) => formatPatchMutation(chalk, patch),\n      }),\n    ].join('')\n  }\n\n  return header\n}\n\nfunction formatPatchMutation(chalk: Chalk, patch: NodePatch): string {\n  const {op} = patch\n  const formattedType = chalk.bold(op.type)\n  if (op.type === 'unset') {\n    return `${chalk.red(formattedType)}()`\n  }\n  if (op.type === 'diffMatchPatch') {\n    return `${chalk.yellow(formattedType)}(${op.value})`\n  }\n  if (op.type === 'inc' || op.type === 'dec') {\n    return `${chalk.yellow(formattedType)}(${op.amount})`\n  }\n  if (op.type === 'set') {\n    return `${chalk.yellow(formattedType)}(${JSON.stringify(op.value)})`\n  }\n  if (op.type === 'setIfMissing') {\n    return `${chalk.green(formattedType)}(${JSON.stringify(op.value)})`\n  }\n  if (op.type === 'assign') {\n    return `${chalk.yellow(formattedType)}(${JSON.stringify(op.value)})`\n  }\n  if (op.type === 'unassign') {\n    return `${chalk.red(formattedType)}(${JSON.stringify(op.keys)})`\n  }\n  if (op.type === 'insert') {\n    return `${chalk.green(formattedType)}(${op.position}, ${encodeItemRef(\n      op.referenceItem,\n    )}, ${JSON.stringify(op.items)})`\n  }\n  if (op.type === 'upsert') {\n    return `${chalk.yellow(formattedType)}(${op.position}, ${encodeItemRef(\n      op.referenceItem,\n    )}, ${JSON.stringify(op.items)})`\n  }\n  if (op.type === 'replace') {\n    return `${chalk.yellow(formattedType)}(${encodeItemRef(op.referenceItem)}, ${JSON.stringify(\n      op.items,\n    )})`\n  }\n  if (op.type === 'truncate') {\n    return `${chalk.red(formattedType)}(${op.startIndex}, ${op.endIndex})`\n  }\n  // @ts-expect-error all cases are covered\n  throw new Error(`Invalid operation type: ${op.type}`)\n}\n\nfunction indent(subject: string, size = 2): string {\n  const padding = ' '.repeat(size)\n\n  return subject\n    .split('\\n')\n    .map((line) => padding + line)\n    .join('\\n')\n}\n","import {type CliCommandDefinition} from '@sanity/cli'\nimport {\n  DEFAULT_MUTATION_CONCURRENCY,\n  dryRun,\n  MAX_MUTATION_CONCURRENCY,\n  type Migration,\n  type MigrationProgress,\n  run,\n} from '@sanity/migrate'\nimport {Table} from 'console-table-printer'\nimport {register} from 'esbuild-register/dist/node'\nimport {hideBin} from 'yargs/helpers'\nimport yargs from 'yargs/yargs'\n\nimport {debug} from '../../debug'\nimport {resolveMigrations} from './listMigrationsCommand'\nimport {prettyFormat} from './prettyMutationFormatter'\nimport {isLoadableMigrationScript, resolveMigrationScript} from './utils/resolveMigrationScript'\n\nconst helpText = `\nOptions\n  --no-dry-run By default the migration runs in dry mode. Pass this option to migrate dataset.\n  --concurrency <concurrent> How many mutation requests to run in parallel. Must be between 1 and ${MAX_MUTATION_CONCURRENCY}. Default: ${DEFAULT_MUTATION_CONCURRENCY}.\n  --no-progress Don't output progress. Useful if you want debug your migration script and see the output of console.log() statements.\n  --dataset <dataset> Dataset to migrate. Defaults to the dataset configured in your Sanity CLI config.\n  --project <project id> Project ID of the dataset to migrate. Defaults to the projectId configured in your Sanity CLI config.\n  --no-confirm Skip the confirmation prompt before running the migration. Make sure you know what you're doing before using this flag.\n  --from-export <export.tar.gz> Use a local dataset export as source for migration instead of calling the Sanity API. Note: this is only supported for dry runs.\n\n\nExamples\n  # dry run the migration\n  sanity migration run <id>\n\n  # execute the migration against a dataset\n  sanity migration run <id> --no-dry-run --project xyz --dataset staging\n\n  # execute the migration using a dataset export as the source\n  sanity migration run <id>  --from-export=production.tar.gz --no-dry-run --projectId xyz --dataset staging\n`\n\ninterface CreateFlags {\n  ['dry-run']?: boolean\n  concurrency?: number\n  ['from-export']?: string\n  progress?: boolean\n  dataset?: string\n  project?: string\n  confirm?: boolean\n}\n\nfunction parseCliFlags(args: {argv?: string[]}) {\n  return yargs(hideBin(args.argv || process.argv).slice(2))\n    .options('dry-run', {type: 'boolean', default: true})\n    .options('concurrency', {type: 'number', default: DEFAULT_MUTATION_CONCURRENCY})\n    .options('progress', {type: 'boolean', default: true})\n    .options('dataset', {type: 'string'})\n    .options('from-export', {type: 'string'})\n    .options('project', {type: 'string'})\n    .options('confirm', {type: 'boolean', default: true}).argv\n}\n\nconst runMigrationCommand: CliCommandDefinition<CreateFlags> = {\n  name: 'run',\n  group: 'migration',\n  signature: 'ID',\n  helpText,\n  description: 'Run a migration against a dataset',\n  // eslint-disable-next-line max-statements\n  action: async (args, context) => {\n    const {apiClient, output, prompt, chalk, workDir} = context\n    const [id] = args.argsWithoutOptions\n\n    const flags = await parseCliFlags(args)\n\n    const fromExport = flags.fromExport\n    const dry = flags.dryRun\n    const dataset = flags.dataset\n    const project = flags.project\n\n    if ((dataset && !project) || (project && !dataset)) {\n      throw new Error('If either --dataset or --project is provided, both must be provided')\n    }\n\n    if (!id) {\n      output.error(chalk.red('Error: Migration ID must be provided'))\n      const migrations = await resolveMigrations(workDir)\n      const table = new Table({\n        title: `Migrations found in project`,\n        columns: [\n          {name: 'id', title: 'ID', alignment: 'left'},\n          {name: 'title', title: 'Title', alignment: 'left'},\n        ],\n      })\n\n      migrations.forEach((definedMigration) => {\n        table.addRow({id: definedMigration.id, title: definedMigration.migration.title})\n      })\n      table.printTable()\n      output.print('\\nRun `sanity migration run <ID>` to run a migration')\n\n      return\n    }\n\n    if (!__DEV__) {\n      register({\n        target: `node${process.version.slice(1)}`,\n      })\n    }\n\n    const candidates = resolveMigrationScript(workDir, id)\n    const resolvedScripts = candidates.filter(isLoadableMigrationScript)\n\n    if (resolvedScripts.length > 1) {\n      // todo: consider prompt user about which one to run? note: it's likely a mistake if multiple files resolve to the same name\n      throw new Error(\n        `Found multiple migrations for \"${id}\" in current directory ${candidates\n          .map((candidate) => candidate!.relativePath)\n          .join(', ')}`,\n      )\n    }\n\n    const script = resolvedScripts[0]\n    if (!script) {\n      throw new Error(\n        `No migration found for \"${id}\" in current directory. Make sure that the migration file exists and exports a valid migration as its default export.\\n\n Tried the following files:\\n - ${candidates\n   .map((candidate) => candidate.relativePath)\n   .join('\\n - ')}`,\n      )\n    }\n\n    const mod = script.mod\n    if ('up' in mod || 'down' in mod) {\n      // todo: consider adding support for up/down as separate named exports\n      // For now, make sure we reserve the names for future use\n      throw new Error(\n        'Only \"up\" migrations are supported at this time, please use a default export',\n      )\n    }\n\n    const migration: Migration = mod.default\n\n    if (fromExport && !dry) {\n      throw new Error('Can only dry run migrations from a dataset export file')\n    }\n\n    const concurrency = flags.concurrency\n    if (concurrency !== undefined) {\n      if (concurrency > MAX_MUTATION_CONCURRENCY) {\n        throw new Error(\n          `Concurrency exceeds the maximum allowed value of ${MAX_MUTATION_CONCURRENCY}`,\n        )\n      }\n\n      if (concurrency === 0) {\n        throw new Error(`Concurrency must be a positive number, got ${concurrency}`)\n      }\n    }\n\n    const projectConfig = apiClient({\n      requireUser: true,\n      requireProject: true,\n    }).config()\n\n    const apiConfig = {\n      dataset: dataset ?? projectConfig.dataset!,\n      projectId: project ?? projectConfig.projectId!,\n      apiHost: projectConfig.apiHost!,\n      token: projectConfig.token!,\n      apiVersion: 'v2024-01-29',\n    } as const\n    if (dry) {\n      dryRunHandler()\n      return\n    }\n\n    const response =\n      flags.confirm &&\n      (await prompt.single<boolean>({\n        message: `This migration will run on the ${chalk.yellow(\n          chalk.bold(apiConfig.dataset),\n        )} dataset in ${chalk.yellow(chalk.bold(apiConfig.projectId))} project. Are you sure?`,\n        type: 'confirm',\n      }))\n\n    if (response === false) {\n      debug('User aborted migration')\n      return\n    }\n\n    const spinner = output.spinner(`Running migration \"${id}\"`).start()\n    await run({api: apiConfig, concurrency, onProgress: createProgress(spinner)}, migration)\n    spinner.stop()\n\n    function createProgress(progressSpinner: ReturnType<typeof output.spinner>) {\n      return function onProgress(progress: MigrationProgress) {\n        if (!flags.progress) {\n          progressSpinner.stop()\n          return\n        }\n        if (progress.done) {\n          progressSpinner.text = `Migration \"${id}\" completed.\n\n  Project id:  ${chalk.bold(apiConfig.projectId)}\n  Dataset:     ${chalk.bold(apiConfig.dataset)}\n\n  ${progress.documents} documents processed.\n  ${progress.mutations} mutations generated.\n  ${chalk.green(progress.completedTransactions.length)} transactions committed.`\n          progressSpinner.stopAndPersist({symbol: chalk.green('✔')})\n          return\n        }\n\n        ;[null, ...progress.currentTransactions].forEach((transaction) => {\n          progressSpinner.text = `Running migration \"${id}\" ${dry ? 'in dry mode...' : '...'}\n\n  Project id:     ${chalk.bold(apiConfig.projectId)}\n  Dataset:        ${chalk.bold(apiConfig.dataset)}\n  Document type:  ${chalk.bold(migration.documentTypes?.join(','))}\n\n  ${progress.documents} documents processed…\n  ${progress.mutations} mutations generated…\n  ${chalk.blue(progress.pending)} requests pending…\n  ${chalk.green(progress.completedTransactions.length)} transactions committed.\n\n  ${\n    transaction && !progress.done\n      ? `» ${prettyFormat({chalk, subject: transaction, migration, indentSize: 2})}`\n      : ''\n  }`\n        })\n      }\n    }\n\n    async function dryRunHandler() {\n      output.print(`Running migration \"${id}\" in dry mode`)\n\n      if (fromExport) {\n        output.print(`Using export ${chalk.cyan(fromExport)}`)\n      }\n\n      output.print()\n      output.print(`Project id:  ${chalk.bold(apiConfig.projectId)}`)\n      output.print(`Dataset:     ${chalk.bold(apiConfig.dataset)}`)\n\n      for await (const mutation of dryRun({api: apiConfig, exportPath: fromExport}, migration)) {\n        if (!mutation) continue\n        output.print()\n        output.print(\n          prettyFormat({\n            chalk,\n            subject: mutation,\n            migration,\n          }),\n        )\n      }\n    }\n  },\n}\n\nexport default runMigrationCommand\n","import {\n  type CliCommandArguments,\n  type CliCommandContext,\n  type CliCommandDefinition,\n} from '@sanity/cli'\n\nimport {type StartPreviewServerCommandFlags} from '../../actions/preview/previewAction'\n\nconst helpText = `\nNotes\n  Changing the hostname or port number might require a new entry to the CORS-origins allow list.\n\nOptions\n  --port <port> TCP port to start server on. [default: 3333]\n  --host <host> The local network interface at which to listen. [default: \"127.0.0.1\"]\n\nExamples\n  sanity preview --host=0.0.0.0\n  sanity preview --port=1942\n  sanity preview some/build-output-dir\n`\n\nconst previewCommand: CliCommandDefinition = {\n  name: 'preview',\n  signature: '[BUILD_OUTPUT_DIR] [--port <port>] [--host <host>]',\n  description: 'Starts a server to preview a production build of Sanity Studio',\n  action: async (\n    args: CliCommandArguments<StartPreviewServerCommandFlags>,\n    context: CliCommandContext,\n  ) => {\n    const previewAction = await getPreviewAction()\n\n    return previewAction(args, context)\n  },\n  helpText,\n}\n\nasync function getPreviewAction() {\n  // NOTE: in dev-mode we want to include from `src` so we need to use `.ts` extension\n  // NOTE: this `if` statement is not included in the output bundle\n  if (__DEV__) {\n    // eslint-disable-next-line import/extensions,@typescript-eslint/consistent-type-imports\n    const mod: typeof import('../../actions/preview/previewAction') = require('../../actions/preview/previewAction.ts')\n\n    return mod.default\n  }\n\n  const mod = await import('../../actions/preview/previewAction')\n\n  return mod.default\n}\n\nexport default previewCommand\n","export default {\n  name: 'schema',\n  signature: '[COMMAND]',\n  isGroupRoot: true,\n  description: 'Interacts with Sanity Studio schema configurations',\n}\n","import {type CliCommandDefinition} from '@sanity/cli'\n\nconst description = 'Validates all schema types specified in a workspace.'\n\nconst helpText = `\nOptions\n  --workspace <name> The name of the workspace to use when validating all schema types.\n  --format <pretty|ndjson|json> The output format used to print schema errors and warnings.\n  --level <error|warning> The minimum level reported out. Defaults to warning.\n\nExamples\n  # Validates all schema types in a Sanity project with more than one workspace\n  sanity schema validate --workspace default\n\n  # Save the results of the report into a file\n  sanity schema validate > report.txt\n\n  # Report out only errors\n  sanity schema validate --level error\n`\n\nconst validateDocumentsCommand: CliCommandDefinition = {\n  name: 'validate',\n  group: 'schema',\n  signature: '',\n  description,\n  helpText,\n  action: async (args, context) => {\n    const mod = await import('../../actions/schema/validateAction')\n\n    return mod.default(args, context)\n  },\n} satisfies CliCommandDefinition\n\nexport default validateDocumentsCommand\n","/* eslint-disable no-process-env */\nexport const isInteractive =\n  process.stdout.isTTY && process.env.TERM !== 'dumb' && !('CI' in process.env)\n","import {\n  type CliCommandArguments,\n  type CliCommandContext,\n  type CliCommandDefinition,\n} from '@sanity/cli'\n\nimport {type StartPreviewServerCommandFlags} from '../../actions/preview/previewAction'\nimport {isInteractive} from '../../util/isInteractive'\nimport {getDevAction} from '../dev/devCommand'\n\nconst helpText = `\nNotes\n  Changing the hostname or port number might require a new CORS-entry to be added.\n\nOptions\n  --port <port> TCP port to start server on. [default: 3333]\n  --host <host> The local network interface at which to listen. [default: \"127.0.0.1\"]\n\nExamples\n  sanity start --host=0.0.0.0\n  sanity start --port=1942\n  sanity start some/build-output-dir\n`\n\nconst startCommand: CliCommandDefinition = {\n  name: 'start',\n  signature: '[BUILD_OUTPUT_DIR] [--port <port>] [--host <host>]',\n  description: 'Alias for `sanity preview`',\n  action: async (\n    args: CliCommandArguments<StartPreviewServerCommandFlags>,\n    context: CliCommandContext,\n  ) => {\n    const {output, chalk, prompt} = context\n    const previewAction = await getPreviewAction()\n\n    const warn = (msg: string) => output.warn(chalk.yellow.bgBlack(msg))\n    const error = (msg: string) => output.warn(chalk.red.bgBlack(msg))\n    warn('╭───────────────────────────────────────────────────────────╮')\n    warn('│                                                           │')\n    warn(\"│  You're running Sanity Studio v3. In this version the     │\")\n    warn('│  [start] command is used to preview static builds.        |')\n    warn('│                                                           │')\n    warn('│  To run a development server, use the [npm run dev] or    |')\n    warn('│  [npx sanity dev] command instead. For more information,  │')\n    warn('│  see https://www.sanity.io/help/studio-v2-vs-v3           │')\n    warn('│                                                           │')\n    warn('╰───────────────────────────────────────────────────────────╯')\n    warn('') // Newline to separate from other output\n\n    try {\n      await previewAction(args, context)\n    } catch (err) {\n      if (err.name !== 'BUILD_NOT_FOUND') {\n        throw err\n      }\n\n      error(err.message)\n      error('\\n')\n\n      const shouldRunDevServer =\n        isInteractive &&\n        (await prompt.single({\n          message: 'Do you want to start a development server instead?',\n          type: 'confirm',\n        }))\n\n      if (shouldRunDevServer) {\n        const devAction = await getDevAction()\n        await devAction(args, context)\n      } else {\n        // Indicate that this isn't an expected exit\n        // eslint-disable-next-line no-process-exit\n        process.exit(1)\n      }\n    }\n  },\n  helpText,\n}\n\nasync function getPreviewAction() {\n  // NOTE: in dev-mode we want to include from `src` so we need to use `.ts` extension\n  // NOTE: this `if` statement is not included in the output bundle\n  if (__DEV__) {\n    // eslint-disable-next-line import/extensions,@typescript-eslint/consistent-type-imports\n    const mod: typeof import('../../actions/preview/previewAction') = require('../../actions/preview/previewAction.ts')\n\n    return mod.default\n  }\n\n  const mod = await import('../../actions/preview/previewAction')\n\n  return mod.default\n}\n\nexport default startCommand\n","import {type CliCommandDefinition} from '@sanity/cli'\n\nconst uninstallCommand: CliCommandDefinition = {\n  name: 'uninstall',\n  signature: '[plugin]',\n  helpText: '',\n  description: 'Removes a Sanity plugin from the current Sanity configuration',\n  hideFromHelp: true,\n  action: async (args, context) => {\n    await context.output.error('`sanity uninstall` is no longer supported - use npm/yarn')\n  },\n}\n\nexport default uninstallCommand\n","export function prettifyQuotaError(message: string) {\n  return (err: Error & {statusCode?: number}): Error & {statusCode?: number} => {\n    if (err.statusCode === 402) {\n      err.message = message\n      throw err\n    }\n\n    throw err\n  }\n}\n","import {type CliCommandDefinition, type CliPrompter} from '@sanity/cli'\n\nimport {prettifyQuotaError} from '../../util/prettifyQuotaError'\nimport {type Role} from './types'\n\nconst helpText = `\nOptions\n  --role Role to invite the user as\n\nExamples\n  # Invite a new user to the project (prompt for details)\n  sanity users invite\n\n  # Send a new user invite to the email \"pippi@sanity.io\", prompt for role\n  sanity users invite pippi@sanity.io\n\n  # Send a new user invite to the email \"pippi@sanity.io\", as administrator\n  sanity users invite pippi@sanity.io --role administrator\n`\n\ninterface InviteFlags {\n  role?: string\n}\n\nconst inviteUserCommand: CliCommandDefinition<InviteFlags> = {\n  name: 'invite',\n  group: 'users',\n  signature: '[EMAIL]',\n  helpText,\n  description: 'Invite a new user to the project',\n  action: async (args, context) => {\n    const {apiClient, output, prompt} = context\n    const [selectedEmail] = args.argsWithoutOptions\n    const flags = args.extOptions\n\n    const client = apiClient().clone().config({useProjectHostname: false, apiVersion: '2021-06-07'})\n    const {projectId} = client.config()\n    const roles = (await client.request<Role[]>({uri: `/projects/${projectId}/roles`})).filter(\n      (role) => role.appliesToUsers,\n    )\n    const email = selectedEmail || (await promptForEmail(prompt))\n    const selectedRole = flags.role || (await promptForRole(prompt, roles))\n    const role = roles.find(({name}) => name.toLowerCase() === selectedRole.toLowerCase())\n    if (!role) {\n      throw new Error(`Role name \"${selectedRole}\" not found`)\n    }\n\n    await client\n      .clone()\n      .request({\n        method: 'POST',\n        uri: `/invitations/project/${projectId}`,\n        body: {email, role: role.name},\n        useGlobalApi: true,\n        maxRedirects: 0,\n      })\n      .catch(\n        prettifyQuotaError(\n          'Project is already at user quota, add billing details to the project in order to allow overage charges.',\n        ),\n      )\n\n    output.print(`Invitation sent to ${email}`)\n  },\n}\n\nexport default inviteUserCommand\n\nfunction promptForEmail(prompt: CliPrompter): Promise<string> {\n  return prompt.single({\n    type: 'input',\n    message: 'Email to invite:',\n    filter: (val) => val.trim(),\n    validate: (name) => {\n      if (!name || !name.includes('@')) {\n        return 'Invalid email'\n      }\n\n      return true\n    },\n  })\n}\n\nfunction promptForRole(prompt: CliPrompter, roles: Role[]): Promise<string> {\n  return prompt.single({\n    type: 'list',\n    message: 'Which role should the user have?',\n    choices: roles.map((role) => ({\n      value: role.name,\n      name: `${role.title} (${role.description})`,\n    })),\n  })\n}\n","import {type CliCommandDefinition} from '@sanity/cli'\nimport {size, sortBy} from 'lodash'\n\nimport {type Invite, type PartialProjectResponse, type User} from './types'\n\nconst sortFields = ['id', 'name', 'role', 'date']\n\nconst helpText = `\nOptions\n  --no-invitations Don't include pending invitations\n  --no-robots Don't include robots (token users)\n  --sort <field> Sort users by specified column: ${sortFields.join(', ')}\n  --order <asc/desc> Sort output ascending/descending\n\nExamples\n  # List all users of the project\n  sanity users list\n\n  # List all users of the project, but exclude pending invitations and robots\n  sanity users list --no-invitations --no-robots\n\n  # List all users, sorted by role\n  sanity users list --sort role\n`\n\nconst listUsersCommand: CliCommandDefinition = {\n  name: 'list',\n  group: 'users',\n  signature: '',\n  helpText,\n  description: 'List all users of the project',\n  action: async (args, context) => {\n    const {apiClient, output, chalk} = context\n    const {sort, order, robots, invitations} = {\n      sort: 'date',\n      order: 'asc',\n      robots: true,\n      invitations: true,\n      ...args.extOptions,\n    }\n\n    if (!sortFields.includes(sort)) {\n      throw new Error(`Can't sort by field \"${sort}\". Must be one of ${sortFields.join(', ')}`)\n    }\n\n    if (order !== 'asc' && order !== 'desc') {\n      throw new Error(`Unknown sort order \"${order}\", must be either \"asc\" or \"desc\"`)\n    }\n\n    const client = apiClient()\n    const globalClient = client.clone().config({useProjectHostname: false})\n    const {projectId} = client.config()\n\n    const useGlobalApi = true\n    const [pendingInvitations, project] = await Promise.all([\n      invitations\n        ? globalClient\n            .request<Invite[]>({uri: `/invitations/project/${projectId}`, useGlobalApi})\n            .then(getPendingInvitations)\n        : [],\n      globalClient.request<PartialProjectResponse>({uri: `/projects/${projectId}`, useGlobalApi}),\n    ])\n\n    const memberIds = project.members.map((member) => member.id)\n    const users = await globalClient\n      .request<User | User[]>({uri: `/users/${memberIds.join(',')}`, useGlobalApi})\n      .then((user) => (Array.isArray(user) ? user : [user]))\n\n    const projectMembers = project.members\n      .map((member) => ({\n        ...member,\n        ...getUserProps(users.find((candidate) => candidate.id === member.id)),\n      }))\n      .filter((member) => !member.isRobot || robots)\n\n    const members = [...projectMembers, ...pendingInvitations]\n\n    const ordered = sortBy(\n      members.map(({id, name, role, date}) => [id, name, role, date]),\n      [sortFields.indexOf(sort)],\n    )\n\n    const rows = order === 'asc' ? ordered : ordered.reverse()\n\n    const maxWidths = rows.reduce(\n      (max, row) => row.map((current, index) => Math.max(size(current), max[index])),\n      sortFields.map((str) => size(str)),\n    )\n\n    const printRow = (row: string[]) => {\n      const isInvite = row[0] === '<pending>'\n      const textRow = row.map((col, i) => `${col}`.padEnd(maxWidths[i])).join('   ')\n      return isInvite ? chalk.dim(textRow) : textRow\n    }\n\n    output.print(chalk.cyan(printRow(sortFields)))\n    rows.forEach((row) => output.print(printRow(row)))\n  },\n}\n\nfunction getUserProps(user: User | undefined) {\n  const {displayName: name, createdAt: date} = user || {}\n  return {name: name || '', date: date || ''}\n}\n\nfunction getPendingInvitations(invitations: Invite[]) {\n  return invitations\n    .filter((invite) => !invite.isAccepted && !invite.isRevoked && !invite.acceptedByUserId)\n    .map((invite) => ({\n      id: '<pending>',\n      name: invite.email,\n      role: invite.role,\n      date: invite.createdAt,\n    }))\n}\n\nexport default listUsersCommand\n","import {type CliCommandGroupDefinition} from '@sanity/cli'\n\nexport const usersGroup: CliCommandGroupDefinition = {\n  name: 'users',\n  signature: '[COMMAND]',\n  isGroupRoot: true,\n  description: 'Manages users of your Sanity project',\n}\n\nexport default usersGroup\n","import {type CliCommandDefinition, type CliCommandGroupDefinition} from '@sanity/cli'\n\nimport backupGroup from './backup/backupGroup'\nimport disableBackupCommand from './backup/disableBackupCommand'\nimport downloadBackupCommand from './backup/downloadBackupCommand'\nimport enableBackupCommand from './backup/enableBackupCommand'\nimport listBackupCommand from './backup/listBackupCommand'\nimport buildCommand from './build/buildCommand'\nimport checkCommand from './check/checkCommand'\nimport configCheckCommand from './config/configCheckCommand'\nimport addCorsOriginCommand from './cors/addCorsOriginCommand'\nimport corsGroup from './cors/corsGroup'\nimport deleteCorsOriginCommand from './cors/deleteCorsOriginCommand'\nimport listCorsOriginsCommand from './cors/listCorsOriginsCommand'\nimport aliasDatasetCommand from './dataset/alias/aliasCommands'\nimport copyDatasetCommand from './dataset/copyDatasetCommand'\nimport createDatasetCommand from './dataset/createDatasetCommand'\nimport datasetGroup from './dataset/datasetGroup'\nimport datasetVisibilityCommand from './dataset/datasetVisibilityCommand'\nimport deleteDatasetCommand from './dataset/deleteDatasetCommand'\nimport exportDatasetCommand from './dataset/exportDatasetCommand'\nimport importDatasetCommand from './dataset/importDatasetCommand'\nimport listDatasetsCommand from './dataset/listDatasetsCommand'\nimport deployCommand from './deploy/deployCommand'\nimport undeployCommand from './deploy/undeployCommand'\nimport devCommand from './dev/devCommand'\nimport createDocumentsCommand from './documents/createDocumentsCommand'\nimport deleteDocumentsCommand from './documents/deleteDocumentsCommand'\nimport documentsGroup from './documents/documentsGroup'\nimport getDocumentsCommand from './documents/getDocumentsCommand'\nimport queryDocumentsCommand from './documents/queryDocumentsCommand'\nimport validateDocumentsCommand from './documents/validateDocumentsCommand'\nimport execCommand from './exec/execCommand'\nimport deleteGraphQLAPICommand from './graphql/deleteGraphQLAPICommand'\nimport deployGraphQLAPICommand from './graphql/deployGraphQLAPICommand'\nimport graphqlGroup from './graphql/graphqlGroup'\nimport listGraphQLAPIsCommand from './graphql/listGraphQLAPIsCommand'\nimport createHookCommand from './hook/createHookCommand'\nimport deleteHookCommand from './hook/deleteHookCommand'\nimport hookGroup from './hook/hookGroup'\nimport listHookLogsCommand from './hook/listHookLogsCommand'\nimport listHooksCommand from './hook/listHooksCommand'\nimport printHookAttemptCommand from './hook/printHookAttemptCommand'\nimport createMigrationCommand from './migration/createMigrationCommand'\nimport listMigrationsCommand from './migration/listMigrationsCommand'\nimport migrationGroup from './migration/migrationGroup'\nimport runMigrationCommand from './migration/runMigrationCommand'\nimport previewCommand from './preview/previewCommand'\nimport schemaGroup from './schema/schemaGroup'\nimport validateSchemaCommand from './schema/validateSchemaCommand'\nimport startCommand from './start/startCommand'\nimport uninstallCommand from './uninstall/uninstallCommand'\nimport inviteUserCommand from './users/inviteUserCommand'\nimport listUsersCommand from './users/listUsersCommand'\nimport usersGroup from './users/usersGroup'\n\nconst commands: (CliCommandDefinition | CliCommandGroupDefinition)[] = [\n  buildCommand,\n  checkCommand,\n  configCheckCommand,\n  datasetGroup,\n  deployCommand,\n  undeployCommand,\n  listDatasetsCommand,\n  createDatasetCommand,\n  datasetVisibilityCommand,\n  exportDatasetCommand,\n  importDatasetCommand,\n  deleteDatasetCommand,\n  copyDatasetCommand,\n  aliasDatasetCommand,\n  backupGroup,\n  listBackupCommand,\n  downloadBackupCommand,\n  disableBackupCommand,\n  enableBackupCommand,\n  corsGroup,\n  listCorsOriginsCommand,\n  addCorsOriginCommand,\n  deleteCorsOriginCommand,\n  usersGroup,\n  inviteUserCommand,\n  listUsersCommand,\n  hookGroup,\n  listHooksCommand,\n  createHookCommand,\n  migrationGroup,\n  createMigrationCommand,\n  runMigrationCommand,\n  listMigrationsCommand,\n  deleteHookCommand,\n  listHookLogsCommand,\n  printHookAttemptCommand,\n  documentsGroup,\n  getDocumentsCommand,\n  queryDocumentsCommand,\n  deleteDocumentsCommand,\n  createDocumentsCommand,\n  validateDocumentsCommand,\n  graphqlGroup,\n  listGraphQLAPIsCommand,\n  deployGraphQLAPICommand,\n  deleteGraphQLAPICommand,\n  devCommand,\n  startCommand,\n  schemaGroup,\n  validateSchemaCommand,\n  previewCommand,\n  uninstallCommand,\n  execCommand,\n]\n\n/**\n * @deprecated Not actually deprecated, but these are internals and should not be relied upon outside of the Sanity team\n * @internal\n */\nexport const cliProjectCommands = {\n  requiredCliVersionRange: '^3.0.0',\n  commands,\n}\n"],"names":["defaultApiVersion","datasetBackupGroup","name","signature","description","isGroupRoot","hideFromHelp","debug","debugIt","MAX_DATASET_NAME_LENGTH","validateDatasetName","datasetName","concat","toLowerCase","length","test","promptForDatasetName","prompt","options","arguments","undefined","single","type","message","validate","err","chooseDatasetPrompt","context","apiClient","allowCreation","client","datasets","list","hasProduction","find","dataset","datasetChoices","map","value","selected","choices","Separator","newDatasetName","default","create","resolveApiClient","apiVersion","projectId","token","config","Error","selectedDataset","withConfig","helpText","disableDatasetBackupCommand","group","action","args","output","chalk","argsWithoutOptions","request","method","headers","Authorization","uri","body","enabled","print","green","error","msg","statusCode","response","statusMessage","red","debug$1","require","archiver","archiveDir","tmpOutDir","outFilePath","progressCb","Promise","resolve","reject","archiveDestination","createWriteStream","on","archive","gzip","gzipOptions","level","zlib","constants","Z_DEFAULT_COMPRESSION","stack","progress","fs","processedBytes","pipe","directory","finalize","maxBackupIdsShown","chooseBackupIdPrompt","_a","query","limit","toString","backups","backupIdChoices","backup","id","cleanupTmpDir","tmpDir","rimraf","MAX_RETRIES","BACKOFF_DELAY_BASE","exponentialBackoff","retryCount","Math","pow","withRetry","operation","maxRetries","retryDelay","setTimeout","CONNECTION_TIMEOUT","READ_TIMEOUT","getIt","keepAlive","promise","downloadAsset","url","fileName","fileType","outDir","normalizedFileName","path","basename","assetFilePath","getAssetFilePath","maxRedirects","timeout","connect","socket","stream","join","downloadDocument","PaginatedGetBackupStream","Readable","constructor","backupId","objectMode","cursor","totalFiles","_read","data","fetchNextBackupPage","files","forEach","file","push","nextCursor","destroy","String","parseApiErr","_b","_c","_d","apiErr","code","JSON","stringify","newProgress","startStep","spinner","start","lastProgress","step","Date","now","elapsed","prettyMs","current","total","text","set","succeed","update","fail","humanFileSize","size","i","floor","log","toFixed","isPathDirName","filepath","createDebug","DEFAULT_DOWNLOAD_CONCURRENCY","MAX_DOWNLOAD_CONCURRENCY","parseCliFlags","yargs","hideBin","argv","process","slice","downloadBackupCommand","opts","prepareBackupOptions","outFileName","bold","cyan","padEnd","progressSpinner","mkdtemp","tmpdir","dir","mkdirSync","recursive","tmpOutDocumentsFile","docOutStream","docWriteMutex","Mutex","backupFileStream","totalItemsDownloaded","pMap","doc","runExclusive","write","concurrency","flags","workDir","isString","defaultOutFileName","out","absolutify","input","filter","overwrite","existsSync","shouldOverwrite","dirname","enableDatasetBackupCommand","DEFAULT_LIST_BACKUP_LIMIT","alias","listDatasetBackupCommand","Number","MAX_SAFE_INTEGER","before","after","parsedBefore","processDateFlags","parsedAfter","isAfter","table","Table","columns","title","alignment","createdAt","addRow","resource","lightFormat","parse","printTable","date","parsedDate","isValid","buildCommand","overrides","buildAction","getBuildAction","mod","then","checkCommand","_args","configCheckCommand","wildcardReplacement","portReplacement","addCorsOrigin","givenOrigin","origin","filterAndValidateOrigin","promptForOrigin","hasWildcard","includes","promptForWildcardConfirmation","allowCredentials","credentials","promptForCredentials","Boolean","requireUser","requireProject","oneline","__template","yellow","logSymbols","warning","underline","replace","filterOrigin","validateOrigin","example","parsed","host","protocol","RegExp","result","addCorsOriginCommand","extOptions","isFile","cwd","warn","success","corsGroup","deleteCorsOriginCommand","originId","specified","specifiedOrigin","origins","listCorsOriginsCommand","validateDatasetAliasName","promptForDatasetAliasName","ALIAS_PREFIX","listAliases","createAlias","aliasName","modify","updateAlias","unlinkAlias","removeAlias","createAliasHandler","targetDataset","nameError","aliases","projectFeatures","all","sets","ds","aliasClient.listAliases","aliasOutputName","startsWith","substring","datasetErr","canCreateAlias","aliasClient.createAlias","option","deleteAliasHandler","force","dsError","fetchedAliases","linkedAlias","elem","trim","aliasClient.removeAlias","linkAliasHandler","da","aliasClient.updateAlias","unlinkAliasHandler","aliasClient.unlinkAlias","aliasCommand","verb","listDatasetCopyJobs","offset","job","state","updatedAt","sourceDataset","withHistory","timeStarted","formatDistanceToNow","parseISO","timeTaken","formatDistance","color","getClientUrl","useCdn","base","cdnUrl","Observable","observer","progressSource","EventSource","stopped","onError","close","next","onChannelError","onMessage","event","onComplete","removeEventListener","complete","addEventListener","followProgress","jobId","currentProgress","listenUrl","subscribe","copyDatasetCommand","attach","shouldSkipHistory","existingDatasets","sourceDatasetName","targetDatasetName","skipHistory","detach","allowedModes","createDatasetCommand","visibility","canCreatePrivate","defaultAclMode","aclMode","promptForDatasetVisibility","mode","datasetGroup","datasetVisibilityCommand","edit","curr","deleteDatasetCommand","delete","noop","parseFlags","rawFlags","types","split","assetConcurrency","parseInt","raw","assets","drafts","compress","exportDatasetCommand","targetDestination","destinationPath","outputPath","getOutputPath","currentStep","onProgress","exportDataset","destination","dstPath","isAbsolute","dstStats","stat","catch","looksLikeFile","indexOf","createPath","mkdir","finalPath","str","toBoolIfSet","flag","allowAssetsInDifferentDataset","allowFailingAssets","replaceAssets","skipCrossDatasetReferences","allowSystemDocuments","missing","importDatasetCommand","fromInitCommand","getMutationOperation","target","determineTargetDataset","isUrl","inputStream","assetsBase","sourceIsFolder","getUrlStream","sourceFile","fileStats","isDirectory","createReadStream","importClient","clone","stepStart","spinInterval","percent","lengthComputable","sameStep","getPercentage","clearInterval","prevStep","prevStepStart","timeSpent","secondsDecimalDigits","setInterval","endTask","_ref","numDocs","warnings","sanityImport","printWarnings","isNonRefConflict","details","responseBody","shouldCreate","padStart","onlyBody","assetFails","bind","listAliasesHandler","listDatasetsCommand","deployCommand","undeployCommand","devCommand","devAction","getDevAction","createDocumentsCommand","watch","useJson5","json5","contentPath","content","readFile","writeDocuments","getResultMessage","docId","uuid","ext","tmpFile","os","defaultValue","getDocument","_id","_type","writeFile","editor","getEditor","registerUnlinkOnSigInt","chokidar","readAndPerformCreatesFromFile","execa","bin","stdio","sync","unlink","filePath","isEqual","writeResult","exit","documents","docs","Array","isArray","mutations","index","validateDocument","isIdentifiedSanityDocument","createIfNotExists","createOrReplace","transaction","commit","arr","isSingle","isPlainObject","getErrorMessage","isSanityDocumentish","joiner","results","res","created","skipped","defaultEditor","platform","env","VISUAL","EDITOR","shift","deleteDocumentsCommand","ids","reduce","trx","deleted","notFound","pluralize","documentsGroup","identity","inp","colorizeJson","formatters","punctuator","white","key","string","number","literal","whitespace","json","tokenize","prevToken","formatter","getDocumentsCommand","pretty","queryDocumentsCommand","project","anonymous","cliConfig","requireDataset","api","baseClient","originalDataset","originalProjectId","fetch","fallbackApiVersion","SANITY_CLI_QUERY_API_VERSION","validateDocumentsCommand","execCommand","deleteGraphQLAPICommand","deployGraphQLAPICommand","graphqlGroup","listGraphQLAPIsCommand","createHookCommand","projectInfo","projects","getById","organizationId","manageUrl","open","deleteHookCommand","hookId","promptForHook","promptForHook$1","specifiedName","hooks","hook","hookGroup","printHookAttemptCommand","attemptId","attempt","resultCode","resultBody","failureReason","inProgress","getStatus","isFailure","formatFailure","includeHelp","help","listHookLogsCommand","messages","attempts","groupedAttempts","groupBy","populated","totalMessages","printMessage","detailed","printSeparator","skip","status","failureCount","inspect","payload","colors","prefix","failure","duration","listHooksCommand","httpMethod","MIGRATIONS_DIRECTORY","MIGRATION_SCRIPT_EXTENSIONS","minimalAdvanced","_ref2","migrationName","documentTypes","t","minimalSimple","_ref3","renameField","_ref4","renameType","_ref5","stringToPTE","_ref6","TEMPLATES","template","createMigrationCommand","suffix","templatesByName","Object","fromEntries","definedTemplate","sluggedName","deburr","destDir","renderedTemplate","definitionFile","resolveMigrationScript","flatMap","location","relativePath","absolutePath","isLoadableMigrationScript","script","migrate","listMigrationCommand","_","migrations","resolveMigrations","definedMigration","migration","unregister","register","version","migrationsDir","migrationEntries","readdir","withFileTypes","entry","entryName","removeMigrationScriptExtension","candidates","candidate","endsWith","migrationGroup","maxKeyLength","children","depth","entries","_ref7","child","max","formatTree","_ref8","node","paddingLength","indent","getNodes","getLeaves","_ref9","nodes","getMessage","_ref10","isLast","nextIndent","leaves","nested","first","rest","firstPadding","repeat","elbow","subsequentPadding","firstMessage","subsequentMessages","marker","convertToTree","root","addNode","tree","pathToString","isTty","isatty","prettyFormat","_ref11","subject","indentSize","subjectEntry","badge","prettyFormatMutation","encodeItemRef","ref","_key","badgeStyle","variant","styles","info","bgWhite","black","incremental","bgGreen","maybeDestructive","bgYellow","destructive","bgRed","label","mutationImpact","patch","documentId","mutation","document","listFormatter","Intl","ListFormat","mutationHeader","mutationType","documentType","format","_ref12","lock","ifRevision","header","padding","patches","flat","formatPatchMutation","op","formattedType","amount","keys","position","referenceItem","items","startIndex","endIndex","line","MAX_MUTATION_CONCURRENCY","DEFAULT_MUTATION_CONCURRENCY","runMigrationCommand","fromExport","dry","dryRun","resolvedScripts","projectConfig","apiConfig","apiHost","dryRunHandler","confirm","run","createProgress","stop","done","completedTransactions","stopAndPersist","symbol","currentTransactions","blue","pending","exportPath","previewCommand","previewAction","getPreviewAction","getPreviewAction$1","schemaGroup","isInteractive","stdout","isTTY","TERM","startCommand","bgBlack","shouldRunDevServer","uninstallCommand","prettifyQuotaError","inviteUserCommand","selectedEmail","useProjectHostname","roles","role","appliesToUsers","email","promptForEmail","selectedRole","promptForRole","_ref13","useGlobalApi","val","sortFields","listUsersCommand","sort","order","robots","invitations","globalClient","pendingInvitations","getPendingInvitations","memberIds","members","member","users","user","projectMembers","getUserProps","isRobot","ordered","sortBy","_ref14","rows","reverse","maxWidths","row","printRow","isInvite","textRow","col","dim","displayName","invite","isAccepted","isRevoked","acceptedByUserId","usersGroup","commands","aliasDatasetCommand","backupGroup","listBackupCommand","disableBackupCommand","enableBackupCommand","listMigrationsCommand","validateSchemaCommand","cliProjectCommands","requiredCliVersionRange"],"mappings":"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"}